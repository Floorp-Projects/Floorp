<?xml version="1.0"?>

<?xml-stylesheet href="chrome://communicator/skin/help.css" type="text/css"?>
<?xml-stylesheet href="chrome://navigator/skin" type="text/css"?>
<?xml-stylesheet href="chrome://global/skin" type="text/css"?>
<?xul-overlay href="chrome://global/content/globalOverlay.xul"?>
<?xul-overlay href="chrome://communicator/content/contentAreaContextOverlay.xul"?>
<?xul-overlay href="chrome://communicator/content/utilityOverlay.xul"?>
<?xul-overlay href="chrome://communicator/content/viewZoomOverlay.xul"?>
<?xul-overlay href="chrome://navigator/content/platformNavigationBindings.xul"?>

<!DOCTYPE window [
<!ENTITY % brandDTD SYSTEM "chrome://global/locale/brand.dtd" >
%brandDTD;
<!ENTITY % helpDTD SYSTEM "chrome://help/locale/help.dtd" >
%helpDTD;
<!ENTITY % navigatorDTD SYSTEM "chrome://navigator/locale/navigator.dtd" >
%navigatorDTD;
]>


<window id="help"
        windowtype="mozilla:help"
        xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
        title="&helpWin.ttl;"
        width="640"
        height="650"
        persist="width height screenX screenY"
        onload="init();" >

  <script type="application/x-javascript" src="chrome://help/content/help.js"/>
  <script type="application/x-javascript" src="chrome://navigator/content/sessionHistoryUI.js"/>
  <script type="application/x-javascript" src="chrome://global/content/nsDragAndDrop.js"/>
  <script type="application/x-javascript" src="chrome://communicator/content/contentAreaDD.js"/>
  <script type="application/x-javascript" src="chrome://global/content/nsTransferable.js"/>
  <script type="application/x-javascript" src="chrome://communicator/content/contentAreaClick.js"/>
  <script type="application/x-javascript" src="chrome://communicator/content/bookmarks/bookmarksOverlay.js"/>
  <script type="application/x-javascript" src="chrome://communicator/content/findUtils.js"/>
  <script type="application/x-javascript" src="chrome://global/content/nsJSSupportsUtils.js"/>

  <popupset id="aTooltipSet">
    <popup id="backMenu" position="after_start" onpopupshowing="return createBackMenu(event);" oncommand="gotoHistoryIndex(event);"/>
    <popup id="forwardMenu" position="after_start" onpopupshowing="return createForwardMenu(event);" oncommand="gotoHistoryIndex(event);"/>
  </popupset>
  <popupset id="contentAreaContextSet"/>
  <broadcasterset id="helpBroadcasters">
    <broadcaster id="canGoBack"    disabled="true"/>
    <broadcaster id="canGoForward" disabled="true"/>
  </broadcasterset>
  <commandset id="globalEditMenuItems"/>
  <commandset id="selectEditMenuItems">
    <command id="cmd_undo"/>
    <command id="cmd_redo"/>
    <command id="cmd_cut"/>
    <command id="cmd_copy"/>
    <command id="cmd_paste"/>
    <command id="cmd_delete"/>
    <command id="cmd_selectAll"/>
    <command id="cmd_close" oncommand="close();"/>
    <command id="Browser:Home"    oncommand="goHome();"/>
    <command id="Browser:Back"    oncommand="goBack();"    observes="canGoBack"/>
    <command id="Browser:Forward" oncommand="goForward();" observes="canGoForward"/>
    <command id="cmd_copyLink"/>
    <command id="cmd_copyImageLocation"/>
    <command id="cmd_copyImageContents"/>
  </commandset>
  <commandset id="clipboardEditMenuItems"/>
  <commandset id="viewZoomCommands"/>
  <keyset id="keys">
    <key id="key_close"/>
    <key id="printKb" key="&printCmd.commandkey;" oncommand="print();" modifiers="accel"/>
    <keyset id="viewZoomKeys"/>
    <keyset id="navigationKeys"/>
    <key id="key_find"              key="&findOnCmd.commandkey;" oncommand="find(false);" modifiers="accel"/>
    <key id="key_findAgain"         key="&findAgainCmd.commandkey;" oncommand="find(true);" modifiers="accel"/>
    <key id="key_viewSource" key="&pageSourceCmd.commandkey;" oncommand="BrowserViewSource();" modifiers="accel"/>
    <key id="key_viewInfo"   key="&pageInfoCmd.commandkey;"   oncommand="BrowserPageInfo();"   modifiers="accel"/>
  </keyset>
  <stringbundle id="bundle_viewZoom"/>
  <stringbundle id="findBundle" src="chrome://global/locale/finddialog.properties"/>

  <vbox flex="1">

    <!-- button bar -->
    <toolbox id="help-toolbox" class="toolbox-top" deferattached="true">
      <toolbar id="helpToolbar" class="toolbar-primary" 
            	grippytooltip="aTooltip" grippytooltiptext="&toolbar.tooltip;"
              tbalign="stretch" persist="collapsed">

        <toolbarbutton id="helpBackButton" type="menu-button" class="toolbarbutton-1"
                       label="&backBtn.label;" crop="right"
                       oncommand="if (event.target==this) goBack(); else gotoHistoryIndex(event);"
                       observes="canGoBack" context="backMenu" 
                       tooltip="aTooltip" tooltiptext="&backButton.tooltip;">
          <menupopup context="" onpopupshowing="createBackMenu(event);"/>
        </toolbarbutton>
        <toolbarbutton id="helpForwardButton" type="menu-button" class="toolbarbutton-1"
                       label="&fwdBtn.label;" crop="right"
                       tooltip="aTooltip" tooltiptext="&forwardButton.tooltip;"
                       oncommand="if (event.target==this) goForward(); else gotoHistoryIndex(event);"
                       observes="canGoForward" context="forwardMenu">
          <menupopup context="" onpopupshowing="createForwardMenu(event);"/>
        </toolbarbutton>
        <toolbarbutton id="helpHomeButton" class="toolbarbutton-1"
                label="&homeBtn.label;" oncommand="goHome();"
                tooltip="aTooltip" tooltiptext="&homeBtn.tooltip;"/>

        <spacer flex="1"/>

        <toolbarbutton id="print" class="toolbarbutton-1"
                       label="&printButton.label;" oncommand="print();"
                       tooltip="aTooltip" tooltiptext="&printButton.tooltip;"/>
      </toolbar>
    </toolbox>


    <!-- the two help panes (sidebar & content) -->
    <hbox flex="1">

      <vbox id="helpsidebar-box">
       <separator class="thin"/>
        <tabbox flex="1">
          <tabs>
            <tab label="&tab1.label;"/>
            <tab label="&tab2.label;"/>
          </tabs>
          <tabpanels flex="1">
            <hbox id="help-toc">
              <tree id="help-toc-tree" ref="urn:root" flex="1*"
                    datasources="chrome://help/locale/help-toc.rdf"
                    containment="http://home.netscape.com/NC-rdf#subheadings"
                    onselect="loadURI(this.selectedItems[0].firstChild.firstChild.getAttribute('helplink'));">>
                <template>
                  <rule>
                    <conditions>
                      <content uri="?uri"/>
                      <triple subject="?uri"
                              predicate="http://home.netscape.com/NC-rdf#subheadings"
                              object="?subheadings" />
                      <member container="?subheadings" child="?subheading"/>
                    </conditions>
                    <bindings>
                      <binding subject="?subheading"
                               predicate="http://home.netscape.com/NC-rdf#name"
                               object="?name" />

                      <binding subject="?subheading"
                               predicate="http://home.netscape.com/NC-rdf#link"
                               object="?link" />
                    </bindings>

                    <action>
                      <treechildren>
                        <treeitem uri="?subheading">
                          <treerow>
                            <treecell class="treecell-indent"
                                      label="?name"
                                      helplink="?link"/>
                          </treerow>
                        </treeitem>
                      </treechildren>
                    </action>
                  </rule>
                </template>

                <treecolgroup>
                  <treecol flex="1*" />
                </treecolgroup>

                <!-- because the outermost treechildren needs "flex='1'" -->
                <treechildren flex="1*"/>

              </tree>
            </hbox>

            <hbox id="help-index">
              <!-- right now this makes the toc as wide as the content area -->
              <iframe flex="1" style="min-width: 0px; width: 0px;" 
		src="chrome://help/locale/help_index.html" />
            </hbox>

          </tabpanels>
        </tabbox>
      </vbox>

      <splitter id="helpsidebar-splitter"
                collapse="before"
                persist="state hidden"
                state="open">
        <grippy/>
      </splitter>

      <!-- this stuff lifted from navigator.xul -->
      <vbox id="appcontent" flex="3">
        <!-- this box is temporary, pending XBLified <browser> -->
        <hbox id="browser" flex="1">
          <!-- type attribute is used by frame construction to locate iframes
               intended to hold (html) content -->
          <browser context="contentAreaContextMenu" type="content-primary" id="help-content"
                   src="about:blank" flex="1"
                   ondraggesture="nsDragAndDrop.startDrag(event, contentAreaDNDObserver);"
                   onclick="return contentAreaClick(event);"/>
        </hbox>
      </vbox>
    </hbox>
  </vbox>
</window>
