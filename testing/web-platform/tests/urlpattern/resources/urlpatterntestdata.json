[
  {
    "pattern": { "pathname": "/foo/bar" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": {} }
    }
  },
  {
    "pattern": { "pathname": "/foo/bar" },
    "input": { "pathname": "/foo/ba" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar" },
    "input": { "pathname": "/foo/bar/" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar" },
    "input": "https://example.com/foo/bar",
    "expected_match": {
      "input": "https://example.com/foo/bar",
      "hostname": { "input": "example.com", "groups": { "0": "example.com" } },
      "pathname": { "input": "/foo/bar", "groups": {} },
      "protocol": { "input": "https", "groups": { "0": "https" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/bar" },
    "input": "https://example.com/foo/bar/baz",
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar" },
    "input": { "hostname": "example.com", "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "hostname": "example.com", "pathname": "/foo/bar" },
      "hostname": { "input": "example.com", "groups": { "0": "example.com" } },
      "pathname": { "input": "/foo/bar", "groups": {} }
    }
  },
  {
    "pattern": { "pathname": "/foo/bar" },
    "input": { "hostname": "example.com", "pathname": "/foo/bar/baz" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar" },
    "input": { "pathname": "/foo/bar", "baseURL": "https://example.com" },
    "expected_match": {
      "input": { "pathname": "/foo/bar", "baseURL": "https://example.com" },
      "hostname": { "input": "example.com", "groups": { "0": "example.com" } },
      "pathname": { "input": "/foo/bar", "groups": {} },
      "protocol": { "input": "https", "groups": { "0": "https" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/bar" },
    "input": { "pathname": "/foo/bar/baz", "baseURL": "https://example.com" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": { "hostname": "example.com", "pathname": "/foo/bar" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": { "protocol": "https", "hostname": "example.com",
               "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "protocol": "https", "hostname": "example.com",
                 "pathname": "/foo/bar" },
      "exactly_empty_components": [ "username", "password", "port" ],
      "hostname": { "input": "example.com", "groups": {} },
      "pathname": { "input": "/foo/bar", "groups": {} },
      "protocol": { "input": "https", "groups": {} }
    }
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": { "protocol": "https", "hostname": "example.com",
               "pathname": "/foo/bar/baz" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": { "protocol": "https", "hostname": "example.com",
               "pathname": "/foo/bar", "search": "otherquery",
               "hash": "otherhash" },
    "expected_match": {
      "input": { "protocol": "https", "hostname": "example.com",
                 "pathname": "/foo/bar", "search": "otherquery",
                 "hash": "otherhash" },
      "exactly_empty_components": [ "username", "password", "port" ],
      "hash": { "input": "otherhash", "groups": { "0": "otherhash" } },
      "hostname": { "input": "example.com", "groups": {} },
      "pathname": { "input": "/foo/bar", "groups": {} },
      "protocol": { "input": "https", "groups": {} },
      "search": { "input": "otherquery", "groups": { "0": "otherquery" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": "https://example.com/foo/bar",
    "expected_match": {
      "input": "https://example.com/foo/bar",
      "exactly_empty_components": [ "username", "password", "port" ],
      "hostname": { "input": "example.com", "groups": {} },
      "pathname": { "input": "/foo/bar", "groups": {} },
      "protocol": { "input": "https", "groups": {} }
    }
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": "https://example.com/foo/bar?otherquery#otherhash",
    "expected_match": {
      "input": "https://example.com/foo/bar?otherquery#otherhash",
      "exactly_empty_components": [ "username", "password", "port" ],
      "hash": { "input": "otherhash", "groups": { "0": "otherhash" } },
      "hostname": { "input": "example.com", "groups": {} },
      "pathname": { "input": "/foo/bar", "groups": {} },
      "protocol": { "input": "https", "groups": {} },
      "search": { "input": "otherquery", "groups": { "0": "otherquery" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": "https://example.com/foo/bar/baz",
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": "https://other.com/foo/bar",
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": "http://other.com/foo/bar",
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": { "pathname": "/foo/bar", "baseURL": "https://example.com" },
    "expected_match": {
      "input": { "pathname": "/foo/bar", "baseURL": "https://example.com" },
      "exactly_empty_components": [ "username", "password", "port" ],
      "hostname": { "input": "example.com", "groups": {} },
      "pathname": { "input": "/foo/bar", "groups": {} },
      "protocol": { "input": "https", "groups": {} }
    }
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": { "pathname": "/foo/bar/baz", "baseURL": "https://example.com" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": { "pathname": "/foo/bar", "baseURL": "https://other.com" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar",
                 "baseURL": "https://example.com?query#hash" },
    "input": { "pathname": "/foo/bar", "baseURL": "http://example.com" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/:bar" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": { "bar": "bar" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/:bar" },
    "input": { "pathname": "/foo/index.html" },
    "expected_match": {
      "input": { "pathname": "/foo/index.html" },
      "pathname": { "input": "/foo/index.html", "groups": { "bar": "index.html" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/:bar" },
    "input": { "pathname": "/foo/bar/" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/:bar" },
    "input": { "pathname": "/foo/" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/(.*)" },
    "input": { "pathname": "/foo/bar" },
    "expected_obj": {
      "pathname": "/foo/*"
    },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": { "0": "bar" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/*" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": { "0": "bar" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_obj": {
      "pathname": "/foo/*"
    },
    "expected_match": {
      "input": { "pathname": "/foo/bar/baz" },
      "pathname": { "input": "/foo/bar/baz", "groups": { "0": "bar/baz" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/*" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_match": {
      "input": { "pathname": "/foo/bar/baz" },
      "pathname": { "input": "/foo/bar/baz", "groups": { "0": "bar/baz" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)" },
    "input": { "pathname": "/foo/" },
    "expected_obj": {
      "pathname": "/foo/*"
    },
    "expected_match": {
      "input": { "pathname": "/foo/" },
      "pathname": { "input": "/foo/", "groups": { "0": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/*" },
    "input": { "pathname": "/foo/" },
    "expected_match": {
      "input": { "pathname": "/foo/" },
      "pathname": { "input": "/foo/", "groups": { "0": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)" },
    "input": { "pathname": "/foo" },
    "expected_obj": {
      "pathname": "/foo/*"
    },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/*" },
    "input": { "pathname": "/foo" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/:bar(.*)" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": { "bar": "bar" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/:bar(.*)" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_match": {
      "input": { "pathname": "/foo/bar/baz" },
      "pathname": { "input": "/foo/bar/baz", "groups": { "bar": "bar/baz" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/:bar(.*)" },
    "input": { "pathname": "/foo/" },
    "expected_match": {
      "input": { "pathname": "/foo/" },
      "pathname": { "input": "/foo/", "groups": { "bar": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/:bar(.*)" },
    "input": { "pathname": "/foo" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/:bar?" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": { "bar": "bar" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/:bar?" },
    "input": { "pathname": "/foo" },
    "expected_match": {
      "input": { "pathname": "/foo" },
      "pathname": { "input": "/foo", "groups": { "bar": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/:bar?" },
    "input": { "pathname": "/foo/" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/:bar?" },
    "input": { "pathname": "/foobar" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/:bar?" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/:bar+" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": { "bar": "bar" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/:bar+" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_match": {
      "input": { "pathname": "/foo/bar/baz" },
      "pathname": { "input": "/foo/bar/baz", "groups": { "bar": "bar/baz" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/:bar+" },
    "input": { "pathname": "/foo" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/:bar+" },
    "input": { "pathname": "/foo/" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/:bar+" },
    "input": { "pathname": "/foobar" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/:bar*" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": { "bar": "bar" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/:bar*" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_match": {
      "input": { "pathname": "/foo/bar/baz" },
      "pathname": { "input": "/foo/bar/baz", "groups": { "bar": "bar/baz" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/:bar*" },
    "input": { "pathname": "/foo" },
    "expected_match": {
      "input": { "pathname": "/foo" },
      "pathname": { "input": "/foo", "groups": { "bar": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/:bar*" },
    "input": { "pathname": "/foo/" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/:bar*" },
    "input": { "pathname": "/foobar" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/(.*)?" },
    "input": { "pathname": "/foo/bar" },
    "expected_obj": {
      "pathname": "/foo/*?"
    },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": { "0": "bar" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/*?" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": { "0": "bar" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)?" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_obj": {
      "pathname": "/foo/*?"
    },
    "expected_match": {
      "input": { "pathname": "/foo/bar/baz" },
      "pathname": { "input": "/foo/bar/baz", "groups": { "0": "bar/baz" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/*?" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_match": {
      "input": { "pathname": "/foo/bar/baz" },
      "pathname": { "input": "/foo/bar/baz", "groups": { "0": "bar/baz" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)?" },
    "input": { "pathname": "/foo" },
    "expected_obj": {
      "pathname": "/foo/*?"
    },
    "expected_match": {
      "input": { "pathname": "/foo" },
      "pathname": { "input": "/foo", "groups": { "0": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/*?" },
    "input": { "pathname": "/foo" },
    "expected_match": {
      "input": { "pathname": "/foo" },
      "pathname": { "input": "/foo", "groups": { "0": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)?" },
    "input": { "pathname": "/foo/" },
    "expected_obj": {
      "pathname": "/foo/*?"
    },
    "expected_match": {
      "input": { "pathname": "/foo/" },
      "pathname": { "input": "/foo/", "groups": { "0": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/*?" },
    "input": { "pathname": "/foo/" },
    "expected_match": {
      "input": { "pathname": "/foo/" },
      "pathname": { "input": "/foo/", "groups": { "0": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)?" },
    "input": { "pathname": "/foobar" },
    "expected_obj": {
      "pathname": "/foo/*?"
    },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/*?" },
    "input": { "pathname": "/foobar" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/(.*)?" },
    "input": { "pathname": "/fo" },
    "expected_obj": {
      "pathname": "/foo/*?"
    },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/*?" },
    "input": { "pathname": "/fo" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/(.*)+" },
    "input": { "pathname": "/foo/bar" },
    "expected_obj": {
      "pathname": "/foo/*+"
    },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": { "0": "bar" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/*+" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": { "0": "bar" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)+" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_obj": {
      "pathname": "/foo/*+"
    },
    "expected_match": {
      "input": { "pathname": "/foo/bar/baz" },
      "pathname": { "input": "/foo/bar/baz", "groups": { "0": "bar/baz" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/*+" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_match": {
      "input": { "pathname": "/foo/bar/baz" },
      "pathname": { "input": "/foo/bar/baz", "groups": { "0": "bar/baz" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)+" },
    "input": { "pathname": "/foo" },
    "expected_obj": {
      "pathname": "/foo/*+"
    },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/*+" },
    "input": { "pathname": "/foo" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/(.*)+" },
    "input": { "pathname": "/foo/" },
    "expected_obj": {
      "pathname": "/foo/*+"
    },
    "expected_match": {
      "input": { "pathname": "/foo/" },
      "pathname": { "input": "/foo/", "groups": { "0": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/*+" },
    "input": { "pathname": "/foo/" },
    "expected_match": {
      "input": { "pathname": "/foo/" },
      "pathname": { "input": "/foo/", "groups": { "0": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)+" },
    "input": { "pathname": "/foobar" },
    "expected_obj": {
      "pathname": "/foo/*+"
    },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/*+" },
    "input": { "pathname": "/foobar" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/(.*)+" },
    "input": { "pathname": "/fo" },
    "expected_obj": {
      "pathname": "/foo/*+"
    },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/*+" },
    "input": { "pathname": "/fo" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/(.*)*" },
    "input": { "pathname": "/foo/bar" },
    "expected_obj": {
      "pathname": "/foo/**"
    },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": { "0": "bar" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/**" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": { "0": "bar" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)*" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_obj": {
      "pathname": "/foo/**"
    },
    "expected_match": {
      "input": { "pathname": "/foo/bar/baz" },
      "pathname": { "input": "/foo/bar/baz", "groups": { "0": "bar/baz" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/**" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_match": {
      "input": { "pathname": "/foo/bar/baz" },
      "pathname": { "input": "/foo/bar/baz", "groups": { "0": "bar/baz" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)*" },
    "input": { "pathname": "/foo" },
    "expected_obj": {
      "pathname": "/foo/**"
    },
    "expected_match": {
      "input": { "pathname": "/foo" },
      "pathname": { "input": "/foo", "groups": { "0": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/**" },
    "input": { "pathname": "/foo" },
    "expected_match": {
      "input": { "pathname": "/foo" },
      "pathname": { "input": "/foo", "groups": { "0": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)*" },
    "input": { "pathname": "/foo/" },
    "expected_obj": {
      "pathname": "/foo/**"
    },
    "expected_match": {
      "input": { "pathname": "/foo/" },
      "pathname": { "input": "/foo/", "groups": { "0": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/**" },
    "input": { "pathname": "/foo/" },
    "expected_match": {
      "input": { "pathname": "/foo/" },
      "pathname": { "input": "/foo/", "groups": { "0": "" } }
    }
  },
  {
    "pattern": { "pathname": "/foo/(.*)*" },
    "input": { "pathname": "/foobar" },
    "expected_obj": {
      "pathname": "/foo/**"
    },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/**" },
    "input": { "pathname": "/foobar" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/(.*)*" },
    "input": { "pathname": "/fo" },
    "expected_obj": {
      "pathname": "/foo/**"
    },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/**" },
    "input": { "pathname": "/fo" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo{/bar}" },
    "input": { "pathname": "/foo/bar" },
    "expected_obj": {
      "pathname": "/foo/bar"
    },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": {} }
    }
  },
  {
    "pattern": { "pathname": "/foo{/bar}" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_obj": {
      "pathname": "/foo/bar"
    },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo{/bar}" },
    "input": { "pathname": "/foo" },
    "expected_obj": {
      "pathname": "/foo/bar"
    },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo{/bar}" },
    "input": { "pathname": "/foo/" },
    "expected_obj": {
      "pathname": "/foo/bar"
    },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo{/bar}?" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": {} }
    }
  },
  {
    "pattern": { "pathname": "/foo{/bar}?" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo{/bar}?" },
    "input": { "pathname": "/foo" },
    "expected_match": {
      "input": { "pathname": "/foo" },
      "pathname": { "input": "/foo", "groups": {} }
    }
  },
  {
    "pattern": { "pathname": "/foo{/bar}?" },
    "input": { "pathname": "/foo/" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo{/bar}+" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": {} }
    }
  },
  {
    "pattern": { "pathname": "/foo{/bar}+" },
    "input": { "pathname": "/foo/bar/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar/bar" },
      "pathname": { "input": "/foo/bar/bar", "groups": {} }
    }
  },
  {
    "pattern": { "pathname": "/foo{/bar}+" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo{/bar}+" },
    "input": { "pathname": "/foo" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo{/bar}+" },
    "input": { "pathname": "/foo/" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo{/bar}*" },
    "input": { "pathname": "/foo/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar" },
      "pathname": { "input": "/foo/bar", "groups": {} }
    }
  },
  {
    "pattern": { "pathname": "/foo{/bar}*" },
    "input": { "pathname": "/foo/bar/bar" },
    "expected_match": {
      "input": { "pathname": "/foo/bar/bar" },
      "pathname": { "input": "/foo/bar/bar", "groups": {} }
    }
  },
  {
    "pattern": { "pathname": "/foo{/bar}*" },
    "input": { "pathname": "/foo/bar/baz" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo{/bar}*" },
    "input": { "pathname": "/foo" },
    "expected_match": {
      "input": { "pathname": "/foo" },
      "pathname": { "input": "/foo", "groups": {} }
    }
  },
  {
    "pattern": { "pathname": "/foo{/bar}*" },
    "input": { "pathname": "/foo/" },
    "expected_match": null
  },
  {
    "pattern": { "protocol": "(café)" },
    "error": true
  },
  {
    "pattern": { "username": "(café)" },
    "error": true
  },
  {
    "pattern": { "password": "(café)" },
    "error": true
  },
  {
    "pattern": { "hostname": "(café)" },
    "error": true
  },
  {
    "pattern": { "pathname": "(café)" },
    "error": true
  },
  {
    "pattern": { "search": "(café)" },
    "error": true
  },
  {
    "pattern": { "hash": "(café)" },
    "error": true
  },
  {
    "pattern": { "protocol": ":café" },
    "input": { "protocol": "foo" },
    "expected_match": {
      "input": { "protocol": "foo" },
      "protocol": { "input": "foo", "groups": { "café": "foo" } }
    }
  },
  {
    "pattern": { "username": ":café" },
    "input": { "username": "foo" },
    "expected_match": {
      "input": { "username": "foo" },
      "username": { "input": "foo", "groups": { "café": "foo" } }
    }
  },
  {
    "pattern": { "password": ":café" },
    "input": { "password": "foo" },
    "expected_match": {
      "input": { "password": "foo" },
      "password": { "input": "foo", "groups": { "café": "foo" } }
    }
  },
  {
    "pattern": { "hostname": ":café" },
    "input": { "hostname": "foo" },
    "expected_match": {
      "input": { "hostname": "foo" },
      "hostname": { "input": "foo", "groups": { "café": "foo" } }
    }
  },
  {
    "pattern": { "pathname": "/:café" },
    "input": { "pathname": "/foo" },
    "expected_match": {
      "input": { "pathname": "/foo" },
      "pathname": { "input": "/foo", "groups": { "café": "foo" } }
    }
  },
  {
    "pattern": { "search": ":café" },
    "input": { "search": "foo" },
    "expected_match": {
      "input": { "search": "foo" },
      "search": { "input": "foo", "groups": { "café": "foo" } }
    }
  },
  {
    "pattern": { "hash": ":café" },
    "input": { "hash": "foo" },
    "expected_match": {
      "input": { "hash": "foo" },
      "hash": { "input": "foo", "groups": { "café": "foo" } }
    }
  },
  {
    "pattern": { "protocol": ":\u2118" },
    "input": { "protocol": "foo" },
    "expected_match": {
      "input": { "protocol": "foo" },
      "protocol": { "input": "foo", "groups": { "\u2118": "foo" } }
    }
  },
  {
    "pattern": { "username": ":\u2118" },
    "input": { "username": "foo" },
    "expected_match": {
      "input": { "username": "foo" },
      "username": { "input": "foo", "groups": { "\u2118": "foo" } }
    }
  },
  {
    "pattern": { "password": ":\u2118" },
    "input": { "password": "foo" },
    "expected_match": {
      "input": { "password": "foo" },
      "password": { "input": "foo", "groups": { "\u2118": "foo" } }
    }
  },
  {
    "pattern": { "hostname": ":\u2118" },
    "input": { "hostname": "foo" },
    "expected_match": {
      "input": { "hostname": "foo" },
      "hostname": { "input": "foo", "groups": { "\u2118": "foo" } }
    }
  },
  {
    "pattern": { "pathname": "/:\u2118" },
    "input": { "pathname": "/foo" },
    "expected_match": {
      "input": { "pathname": "/foo" },
      "pathname": { "input": "/foo", "groups": { "\u2118": "foo" } }
    }
  },
  {
    "pattern": { "search": ":\u2118" },
    "input": { "search": "foo" },
    "expected_match": {
      "input": { "search": "foo" },
      "search": { "input": "foo", "groups": { "\u2118": "foo" } }
    }
  },
  {
    "pattern": { "hash": ":\u2118" },
    "input": { "hash": "foo" },
    "expected_match": {
      "input": { "hash": "foo" },
      "hash": { "input": "foo", "groups": { "\u2118": "foo" } }
    }
  },
  {
    "pattern": { "protocol": ":\u3400" },
    "input": { "protocol": "foo" },
    "expected_match": {
      "input": { "protocol": "foo" },
      "protocol": { "input": "foo", "groups": { "\u3400": "foo" } }
    }
  },
  {
    "pattern": { "username": ":\u3400" },
    "input": { "username": "foo" },
    "expected_match": {
      "input": { "username": "foo" },
      "username": { "input": "foo", "groups": { "\u3400": "foo" } }
    }
  },
  {
    "pattern": { "password": ":\u3400" },
    "input": { "password": "foo" },
    "expected_match": {
      "input": { "password": "foo" },
      "password": { "input": "foo", "groups": { "\u3400": "foo" } }
    }
  },
  {
    "pattern": { "hostname": ":\u3400" },
    "input": { "hostname": "foo" },
    "expected_match": {
      "input": { "hostname": "foo" },
      "hostname": { "input": "foo", "groups": { "\u3400": "foo" } }
    }
  },
  {
    "pattern": { "pathname": "/:\u3400" },
    "input": { "pathname": "/foo" },
    "expected_match": {
      "input": { "pathname": "/foo" },
      "pathname": { "input": "/foo", "groups": { "\u3400": "foo" } }
    }
  },
  {
    "pattern": { "search": ":\u3400" },
    "input": { "search": "foo" },
    "expected_match": {
      "input": { "search": "foo" },
      "search": { "input": "foo", "groups": { "\u3400": "foo" } }
    }
  },
  {
    "pattern": { "hash": ":\u3400" },
    "input": { "hash": "foo" },
    "expected_match": {
      "input": { "hash": "foo" },
      "hash": { "input": "foo", "groups": { "\u3400": "foo" } }
    }
  },
  {
    "pattern": { "protocol": "(.*)" },
    "input": { "protocol" : "café" },
    "expected_obj": {
      "protocol": "*"
    },
    "expected_match": null
  },
  {
    "pattern": { "protocol": "(.*)" },
    "input": { "protocol": "cafe" },
    "expected_obj": {
      "protocol": "*"
    },
    "expected_match": {
      "input": { "protocol": "cafe" },
      "protocol": { "input": "cafe", "groups": { "0": "cafe" }}
    }
  },
  {
    "pattern": { "protocol": "foo-bar" },
    "input": { "protocol": "foo-bar" },
    "expected_match": {
      "input": { "protocol": "foo-bar" },
      "protocol": { "input": "foo-bar", "groups": {} }
    }
  },
  {
    "pattern": { "username": "caf%C3%A9" },
    "input": { "username" : "café" },
    "expected_match": {
      "input": { "username" : "café" },
      "username": { "input": "caf%C3%A9", "groups": {}}
    }
  },
  {
    "pattern": { "username": "café" },
    "input": { "username" : "café" },
    "expected_obj": {
      "username": "caf%C3%A9"
    },
    "expected_match": {
      "input": { "username" : "café" },
      "username": { "input": "caf%C3%A9", "groups": {}}
    }
  },
  {
    "pattern": { "username": "caf%c3%a9" },
    "input": { "username" : "café" },
    "expected_match": null
  },
  {
    "pattern": { "password": "caf%C3%A9" },
    "input": { "password" : "café" },
    "expected_match": {
      "input": { "password" : "café" },
      "password": { "input": "caf%C3%A9", "groups": {}}
    }
  },
  {
    "pattern": { "password": "café" },
    "input": { "password" : "café" },
    "expected_obj": {
      "password": "caf%C3%A9"
    },
    "expected_match": {
      "input": { "password" : "café" },
      "password": { "input": "caf%C3%A9", "groups": {}}
    }
  },
  {
    "pattern": { "password": "caf%c3%a9" },
    "input": { "password" : "café" },
    "expected_match": null
  },
  {
    "pattern": { "hostname": "xn--caf-dma.com" },
    "input": { "hostname" : "café.com" },
    "expected_match": {
      "input": { "hostname" : "café.com" },
      "hostname": { "input": "xn--caf-dma.com", "groups": {}}
    }
  },
  {
    "pattern": { "hostname": "café.com" },
    "input": { "hostname" : "café.com" },
    "expected_obj": {
      "hostname": "xn--caf-dma.com"
    },
    "expected_match": {
      "input": { "hostname" : "café.com" },
      "hostname": { "input": "xn--caf-dma.com", "groups": {}}
    }
  },
  {
    "pattern": { "port": "" },
    "input": { "protocol": "http", "port": "80" },
    "expected_match": {
      "input": { "protocol": "http", "port": "80" },
      "protocol": { "input": "http", "groups": { "0": "http" }},
      "port": { "input": "", "groups": {}}
    }
  },
  {
    "pattern": { "protocol": "http", "port": "80" },
    "input": { "protocol": "http", "port": "80" },
    "expected_match": {
      "input": { "protocol": "http", "port": "80" },
      "protocol": { "input": "http", "groups": {}},
      "port": { "input": "", "groups": {}}
    }
  },
  {
    "pattern": { "protocol": "http", "port": "80{20}?" },
    "input": { "protocol": "http", "port": "80" },
    "expected_match": null
  },
  {
    "pattern": { "protocol": "http", "port": "80 " },
    "input": { "protocol": "http", "port": "80" },
    "error": true
  },
  {
    "pattern": { "port": "80" },
    "input": { "protocol": "http", "port": "80" },
    "expected_match": null
  },
  {
    "pattern": { "protocol": "http{s}?", "port": "80" },
    "input": { "protocol": "http", "port": "80" },
    "expected_match": null
  },
  {
    "pattern": { "port": "80" },
    "input": { "port": "80" },
    "expected_match": {
      "input": { "port": "80" },
      "port": { "input": "80", "groups": {}}
    }
  },
  {
    "pattern": { "port": "(.*)" },
    "input": { "port": "invalid80" },
    "expected_obj": {
      "port": "*"
    },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar" },
    "input": { "pathname": "/foo/./bar" },
    "expected_match": {
      "input": { "pathname": "/foo/./bar" },
      "pathname": { "input": "/foo/bar", "groups": {}}
    }
  },
  {
    "pattern": { "pathname": "/foo/baz" },
    "input": { "pathname": "/foo/bar/../baz" },
    "expected_match": {
      "input": { "pathname": "/foo/bar/../baz" },
      "pathname": { "input": "/foo/baz", "groups": {}}
    }
  },
  {
    "pattern": { "pathname": "/caf%C3%A9" },
    "input": { "pathname": "/café" },
    "expected_match": {
      "input": { "pathname": "/café" },
      "pathname": { "input": "/caf%C3%A9", "groups": {}}
    }
  },
  {
    "pattern": { "pathname": "/café" },
    "input": { "pathname": "/café" },
    "expected_obj": {
      "pathname": "/caf%C3%A9"
    },
    "expected_match": {
      "input": { "pathname": "/café" },
      "pathname": { "input": "/caf%C3%A9", "groups": {}}
    }
  },
  {
    "pattern": { "pathname": "/caf%c3%a9" },
    "input": { "pathname": "/café" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar" },
    "input": { "pathname": "foo/bar" },
    "expected_match": null
  },
  {
    "pattern": { "pathname": "/foo/bar" },
    "input": { "pathname": "foo/bar", "baseURL": "https://example.com" },
    "expected_match": {
      "input": { "pathname": "foo/bar", "baseURL": "https://example.com" },
      "protocol": { "input": "https", "groups": { "0": "https" }},
      "hostname": { "input": "example.com", "groups": { "0": "example.com" }},
      "pathname": { "input": "/foo/bar", "groups": {}}
    }
  },
  {
    "pattern": { "pathname": "/foo/../bar" },
    "input": { "pathname": "/bar" },
    "expected_obj": {
      "pathname": "/bar"
    },
    "expected_match": {
      "input": { "pathname": "/bar" },
      "pathname": { "input": "/bar", "groups": {}}
    }
  },
  {
    "pattern": { "pathname": "./foo/bar", "baseURL": "https://example.com" },
    "input": { "pathname": "foo/bar", "baseURL": "https://example.com" },
    "expected_obj": {
      "pathname": "/foo/bar"
    },
    "expected_match": {
      "input": { "pathname": "foo/bar", "baseURL": "https://example.com" },
      "exactly_empty_components": [ "username", "password", "port" ],
      "protocol": { "input": "https", "groups": {}},
      "hostname": { "input": "example.com", "groups": {}},
      "pathname": { "input": "/foo/bar", "groups": {}}
    }
  },
  {
    "pattern": { "pathname": "foo/bar" },
    "input": "https://example.com/foo/bar",
    "expected_match": null
  },
  {
    "pattern": { "pathname": "foo/bar", "baseURL": "https://example.com" },
    "input": "https://example.com/foo/bar",
    "expected_obj": {
      "pathname": "/foo/bar"
    },
    "expected_match": {
      "input": "https://example.com/foo/bar",
      "exactly_empty_components": [ "username", "password", "port" ],
      "protocol": { "input": "https", "groups": {}},
      "hostname": { "input": "example.com", "groups": {}},
      "pathname": { "input": "/foo/bar", "groups": {}}
    }
  },
  {
    "pattern": { "pathname": ":name.html", "baseURL": "https://example.com" },
    "input": "https://example.com/foo.html",
    "expected_obj": {
      "pathname": "/:name.html"
    },
    "expected_match": {
      "input": "https://example.com/foo.html",
      "exactly_empty_components": [ "username", "password", "port" ],
      "protocol": { "input": "https", "groups": {}},
      "hostname": { "input": "example.com", "groups": {}},
      "pathname": { "input": "/foo.html", "groups": { "name": "foo" }}
    }
  },
  {
    "pattern": { "search": "q=caf%C3%A9" },
    "input": { "search": "q=café" },
    "expected_match": {
      "input": { "search": "q=café" },
      "search": { "input": "q=caf%C3%A9", "groups": {}}
    }
  },
  {
    "pattern": { "search": "q=café" },
    "input": { "search": "q=café" },
    "expected_obj": {
      "search": "q=caf%C3%A9"
    },
    "expected_match": {
      "input": { "search": "q=café" },
      "search": { "input": "q=caf%C3%A9", "groups": {}}
    }
  },
  {
    "pattern": { "search": "q=caf%c3%a9" },
    "input": { "search": "q=café" },
    "expected_match": null
  },
  {
    "pattern": { "hash": "caf%C3%A9" },
    "input": { "hash": "café" },
    "expected_match": {
      "input": { "hash": "café" },
      "hash": { "input": "caf%C3%A9", "groups": {}}
    }
  },
  {
    "pattern": { "hash": "café" },
    "input": { "hash": "café" },
    "expected_obj": {
      "hash": "caf%C3%A9"
    },
    "expected_match": {
      "input": { "hash": "café" },
      "hash": { "input": "caf%C3%A9", "groups": {}}
    }
  },
  {
    "pattern": { "hash": "caf%c3%a9" },
    "input": { "hash": "café" },
    "expected_match": null
  },
  {
    "pattern": { "protocol": "about", "pathname": "(blank|sourcedoc)" },
    "input": "about:blank",
    "expected_match": {
      "input": "about:blank",
      "protocol": { "input": "about", "groups": {}},
      "pathname": { "input": "blank", "groups": { "0": "blank" }}
    }
  },
  {
    "pattern": { "protocol": "data", "pathname": ":number([0-9]+)" },
    "input": "data:8675309",
    "expected_match": {
      "input": "data:8675309",
      "protocol": { "input": "data", "groups": {}},
      "pathname": { "input": "8675309", "groups": { "number": "8675309" }}
    }
  }
]
