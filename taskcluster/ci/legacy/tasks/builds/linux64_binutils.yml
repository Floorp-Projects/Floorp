$inherits:
  from: 'tasks/builds/firefox_docker_base.yml'
  variables:
    build_name: 'linux64-binutils'
    build_type: 'opt'
task:
  metadata:
    name: '[TC] binutils'
    description: 'binutils'

  workerType: opt-linux64

  routes:
    - 'index.buildbot.branches.{{project}}.binutils'
    - 'index.buildbot.revisions.{{head_rev}}.{{project}}.binutils'

  payload:
    env:
      MOZHARNESS_DISABLE: 'true'
      TOOLS_DISABLE: 'true'

    maxRunTime: 36000

    command: ["/bin/bash", "-c", "cd /home/worker/ && ./bin/checkout-sources.sh && ./workspace/build/src/taskcluster/scripts/misc/build-binutils-linux.sh" ]

    artifacts:
      'public/binutils.tar.xz':
        type: file
        path: '/home/worker/workspace/artifacts/binutils.tar.xz'
        expires:
          relative-datestamp: "1 year"

  extra:
    treeherderEnv:
      - staging
      - production
    treeherder:
      groupSymbol: Cc
      groupName: Compilers, submitted by taskcluster
      symbol: binutils
      machine:
        platform: linux64
    locations:
        build: null
        tests: null
