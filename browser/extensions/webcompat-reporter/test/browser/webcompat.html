<!DOCTYPE html>
<meta charset="utf-8">
<style>
 #screenshot-preview {width: 200px; height: 200px;}
</style>
<div id="url"></div>
<div id="screenshot-preview">Fail</div>
<script>
let params = new URL(location.href).searchParams;
let preview = document.getElementById("screenshot-preview");
let url = document.getElementById("url");
url.innerText = params.get("url");

window.addEventListener("message", function(event) {
  if (event.data instanceof Blob) {
    preview.innerText = "Pass";
  }

  let reader = new FileReader();
  reader.addEventListener("load", (e) => {
    preview.style.background = `url(${e.target.result})`;
    window.dispatchEvent(new CustomEvent("ScreenshotReceived", {bubbles:true}));
  });
  reader.readAsDataURL(event.data);
});
</script>