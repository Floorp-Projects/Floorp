{"version":3,"sources":["webpack:///webpack/bootstrap 7d20b9d6e1d8b115b41d","webpack:///external \"React\"","webpack:///./common/Actions.jsm","webpack:///external \"ReactIntl\"","webpack:///(webpack)/buildin/global.js","webpack:///external \"ReactRedux\"","webpack:///./content-src/asrouter/template-utils.js","webpack:///./content-src/components/TopSites/TopSitesConstants.js","webpack:///./common/Dedupe.jsm","webpack:///./common/Reducers.jsm","webpack:///./content-src/asrouter/asrouter-content.jsx","webpack:///external \"PropTypes\"","webpack:///./node_modules/fluent/src/parser.js","webpack:///./node_modules/fluent/src/types.js","webpack:///./node_modules/fluent/src/builtins.js","webpack:///./node_modules/fluent/src/resolver.js","webpack:///./node_modules/fluent/src/context.js","webpack:///./node_modules/fluent/src/cached_iterable.js","webpack:///./node_modules/fluent/src/fallback.js","webpack:///./node_modules/fluent/src/util.js","webpack:///./node_modules/fluent/src/index.js","webpack:///./content-src/lib/init-store.js","webpack:///external \"ReactDOM\"","webpack:///./content-src/components/ErrorBoundary/ErrorBoundary.jsx","webpack:///./content-src/lib/link-menu-options.js","webpack:///./content-src/components/LinkMenu/LinkMenu.jsx","webpack:///./content-src/components/ContextMenu/ContextMenu.jsx","webpack:///./content-src/lib/screenshot-utils.js","webpack:///./content-src/components/CollapsibleSection/CollapsibleSection.jsx","webpack:///./content-src/lib/section-menu-options.js","webpack:///./content-src/components/ComponentPerfTimer/ComponentPerfTimer.jsx","webpack:///./common/PerfService.jsm","webpack:///./content-src/components/TopSites/TopSite.jsx","webpack:///./content-src/activity-stream.jsx","webpack:///./content-src/lib/snippets.js","webpack:///./node_modules/fluent-react/src/localization.js","webpack:///./node_modules/fluent-react/src/provider.js","webpack:///./node_modules/fluent-react/src/with_localization.js","webpack:///./node_modules/fluent-react/src/markup.js","webpack:///./node_modules/fluent-react/vendor/omittedCloseTags.js","webpack:///./node_modules/fluent-react/vendor/voidElementTags.js","webpack:///./node_modules/fluent-react/src/localized.js","webpack:///./node_modules/fluent-react/src/index.js","webpack:///external \"Redux\"","webpack:///./content-src/asrouter/components/ImpressionsWrapper/ImpressionsWrapper.jsx","webpack:///./content-src/asrouter/components/ModalOverlay/ModalOverlay.jsx","webpack:///./content-src/asrouter/templates/OnboardingMessage/OnboardingMessage.jsx","webpack:///./content-src/asrouter/components/Button/Button.jsx","webpack:///./content-src/asrouter/components/SnippetBase/SnippetBase.jsx","webpack:///./content-src/asrouter/templates/SimpleSnippet/SimpleSnippet.jsx","webpack:///./content-src/components/Base/Base.jsx","webpack:///./content-src/components/ASRouterAdmin/ASRouterAdmin.jsx","webpack:///./content-src/components/ConfirmDialog/ConfirmDialog.jsx","webpack:///./content-src/components/ManualMigration/ManualMigration.jsx","webpack:///./common/PrerenderData.jsm","webpack:///./content-src/components/Search/Search.jsx","webpack:///./content-src/lib/constants.js","webpack:///./content-src/components/Sections/Sections.jsx","webpack:///./content-src/components/Card/types.js","webpack:///./content-src/components/Card/Card.jsx","webpack:///./content-src/components/SectionMenu/SectionMenu.jsx","webpack:///./content-src/components/Topics/Topics.jsx","webpack:///./content-src/components/TopSites/TopSites.jsx","webpack:///./content-src/components/TopSites/TopSiteFormInput.jsx","webpack:///./content-src/components/TopSites/TopSiteForm.jsx","webpack:///./content-src/components/StartupOverlay/StartupOverlay.jsx","webpack:///./content-src/lib/detect-user-session-start.js"],"names":["globalImportContext","Window","BACKGROUND_PROCESS","UI_CODE","actionTypes","type","ASRouterActions","_RouteMessage","action","options","meta","from","to","Error","forEach","o","AlsoToMain","fromTarget","skipLocal","CONTENT_MESSAGE_TYPE","MAIN_MESSAGE_TYPE","OnlyToMain","BroadcastToContent","AlsoToOneContent","target","skipMain","toTarget","OnlyToOneContent","AlsoToPreloaded","PRELOAD_MESSAGE_TYPE","UserEvent","data","TELEMETRY_USER_EVENT","ASRouterUserEvent","AS_ROUTER_TELEMETRY_USER_EVENT","UndesiredEvent","importContext","TELEMETRY_UNDESIRED_EVENT","PerfEvent","TELEMETRY_PERFORMANCE_EVENT","ImpressionStats","TELEMETRY_IMPRESSION_STATS","SetPref","name","value","SET_PREF","WebExtEvent","source","isSendToMain","isBroadcastToContent","isSendToOneContent","isSendToPreloaded","isFromMain","getPortIdOfSender","safeURI","url","protocol","URL","isAllowed","includes","console","warn","TOP_SITES_SOURCE","TOP_SITES_CONTEXT_MENU_OPTIONS","MIN_RICH_FAVICON_SIZE","MIN_CORNER_FAVICON_SIZE","Dedupe","constructor","createKey","defaultCreateKey","item","group","groups","globalKeys","Set","result","values","valueMap","Map","key","has","set","push","add","map","m","Array","TOP_SITES_DEFAULT_ROWS","TOP_SITES_MAX_SITES_PER_ROW","dedupe","site","INITIAL_STATE","App","initialized","version","Snippets","TopSites","rows","editForm","Prefs","Dialog","visible","Sections","prevState","at","INIT","Object","assign","insertPinned","links","pinned","pinnedUrls","link","newLinks","filter","isPinned","pinIndex","val","index","length","splice","hasMatch","newRows","TOP_SITES_UPDATED","pref","TOP_SITES_PREFS_UPDATED","TOP_SITES_EDIT","previewResponse","TOP_SITES_CANCEL_EDIT","PREVIEW_RESPONSE","previewUrl","preview","PREVIEW_REQUEST","PREVIEW_REQUEST_CANCEL","SCREENSHOT_UPDATED","row","screenshot","PLACES_BOOKMARK_ADDED","bookmarkGuid","bookmarkTitle","dateAdded","bookmarkDateCreated","PLACES_BOOKMARK_REMOVED","newSite","PLACES_LINK_DELETED","DIALOG_OPEN","DIALOG_CANCEL","DELETE_HISTORY_URL","newValues","PREFS_INITIAL_VALUES","PREF_CHANGED","newState","SECTION_DEREGISTER","section","id","SECTION_REGISTER","title","enabled","SECTION_UPDATE","find","card","dedupeConfigurations","dedupeConf","dedupedRows","dedupeFrom","reduce","dedupeSectionId","dedupeSection","s","SECTION_UPDATE_CARD","PLACES_SAVED_TO_POCKET","open_url","pocket_id","PLACES_LINK_BLOCKED","DELETE_FROM_POCKET","ARCHIVE_FROM_POCKET","SNIPPETS_DATA","SNIPPET_BLOCKED","blockList","concat","SNIPPETS_BLOCKLIST_CLEARED","SNIPPETS_RESET","INCOMING_MESSAGE_NAME","OUTGOING_MESSAGE_NAME","ASRouterUtils","addListener","listener","global","RPMAddMessageListener","removeListener","RPMRemoveMessageListener","sendMessage","RPMSendAsyncMessage","blockById","blockBundle","bundle","executeAction","button_action","button_action_params","unblockById","unblockBundle","getNextMessage","overrideMessage","sendTelemetry","ping","payload","ac","getEndpoint","window","location","href","params","URLSearchParams","slice","indexOf","endpoint","get","snippetId","e","shouldSendImpressionOnUpdate","nextProps","prevProps","message","generateMessages","content","cx","addMessages","ALLOWED_TAGS","b","i","u","strong","em","br","convertLinks","sendClick","keys","acc","linkTag","metric","RichText","props","text","ASRouterUISurface","React","PureComponent","onMessageFromParent","bind","sendImpression","sendUserActionTelemetry","state","extraProps","message_id","eventType","provider","event","dataset","onBlockById","clearBundle","setState","componentWillMount","document","trigger","componentWillUnmount","renderSnippets","renderOnboarding","render","template","defaultProps","ASRouterContent","containerElement","_mount","getElementById","ReactDOM","_unmount","unmountComponentAtNode","init","uninit","MAX_PLACEABLES","entryIdentifierRe","identifierRe","functionIdentifierRe","RuntimeParser","getResource","string","_source","_index","_length","entries","errors","skipWS","getEntry","SyntaxError","skipToNextEntryStart","error","ch","skipComment","skipSection","getMessage","skipInlineWS","getVariantName","getEntryIdentifier","getPattern","startsWith","attrs","lineStart","getAttributes","skipBlankLines","ptr","getIdentifier","re","lastIndex","exec","toString","start","cc","charCodeAt","getString","substring","eol","firstLineContent","getComplexPattern","buffer","placeables","blankLinesStart","blankLinesEnd","ch2","getPlaceable","variants","getVariants","exp","vars","def","selector","getSelectorExpression","literal","getLiteral","getVariantKey","args","getCallArgs","test","fun","isArray","lastIndexOf","getNumber","num","defaultIndex","cc0","cc1","parse","parser","FluentType","opts","valueOf","FluentNone","FluentNumber","parseFloat","ctx","nf","_memoizeIntlObject","Intl","NumberFormat","format","match","other","FluentDateTime","Date","dtf","DateTimeFormat","FluentSymbol","pr","PluralRules","select","arg","merge","argopts","unwrapped","opt","MAX_PLACEABLE_LENGTH","FSI","PDI","DefaultMember","env","members","RangeError","MessageReference","_terms","_messages","err","ReferenceError","VariantExpression","keyword","Type","isVariantList","node","variant","variantKey","AttributeExpression","attrName","SelectExpression","keyCanMatch","expr","Pattern","ExternalArgument","FunctionReference","CallExpression","attr","member","undefined","hasOwnProperty","TypeError","_functions","func","builtins","callee","posargs","keyargs","ptn","dirty","useIsolating","_useIsolating","elem","part","delete","join","resolve","WeakSet","locales","functions","_intls","WeakMap","messages","Symbol","iterator","hasMessage","ctor","cache","JSON","stringify","CachedIterable","iterable","asyncIterator","seen","cur","next","touchNext","done","mapContextSync","ids","getContextForId","context","remainingCount","foundContexts","fill","mapContextAsync","nonBlank","line","countIndent","indent","ftl","strings","code","lines","split","indents","common","Math","min","RegExp","replace","MERGE_STORE_ACTION","EARLY_QUEUED_ACTIONS","SAVE_SESSION_PERF_DATA","PAGE_PRERENDERED","mergeStateReducer","mainReducer","messageMiddleware","store","au","rehydrationMiddleware","_didRehydrate","isMergeStoreAction","isRehydrationRequest","NEW_TAB_STATE_REQUEST","_didRequestInitialState","queueEarlyMessageMiddleware","_receivedFromMain","_earlyActionQueue","initStore","reducers","initialState","createStore","combineReducers","applyMiddleware","msg","dispatch","ex","dump","stack","ErrorBoundaryFallback","windowObj","onClick","reload","defaultClass","className","ErrorBoundary","hasError","componentDidCatch","info","children","FallbackComponent","_OpenInPrivateWindow","icon","OPEN_PRIVATE_WINDOW","referrer","userEvent","GetPlatformString","platform","LinkMenuOptions","Separator","EmptyItem","RemoveBookmark","DELETE_BOOKMARK_BY_ID","AddBookmark","BOOKMARK_URL","OpenInNewWindow","OPEN_NEW_WINDOW","typedBonus","BlockUrl","eventSource","BLOCK_URL","impression","block","tiles","guid","pos","WebExtDismiss","string_id","WEBEXT_DISMISS","action_position","DeleteUrl","isEnabled","siteInfo","onConfirm","forceBlock","body_string_id","confirm_button_string_id","cancel_button_string_id","ShowFile","SHOW_DOWNLOAD_FILE","OpenFile","OPEN_DOWNLOAD_FILE","CopyDownloadLink","COPY_DOWNLOAD_LINK","GoToDownloadPage","OPEN_LINK","disabled","RemoveDownload","REMOVE_DOWNLOAD_FILE","PinTopSite","TOP_SITES_PIN","UnpinTopSite","TOP_SITES_UNPIN","SaveToPocket","SAVE_TO_POCKET","pocket","DeleteFromPocket","ArchiveFromPocket","EditTopSite","CheckBookmark","CheckPinTopSite","CheckSavedToPocket","CheckBookmarkOrArchive","OpenInPrivateWindow","DEFAULT_SITE_MENU_OPTIONS","_LinkMenu","getOptions","isPrivateBrowsingEnabled","propOptions","isDefault","option","label","intl","formatMessage","userEventData","shouldSendImpressionStats","first","last","onUpdate","getState","LinkMenu","connect","injectIntl","ContextMenu","hideContext","componentDidMount","setTimeout","addEventListener","removeEventListener","stopPropagation","ContextMenuItem","onKeyDown","shiftKey","ScreenshotUtils","isBlob","isLocal","image","path","createLocalImageObject","remoteImage","createObjectURL","maybeRevokeBlobObjectURL","localImage","revokeObjectURL","isRemoteImageLocal","VISIBLE","VISIBILITY_CHANGE_EVENT","getFormattedMessage","Disclaimer","onAcknowledge","disclaimerPref","disclaimer","button","DisclaimerIntl","_CollapsibleSection","onBodyMount","onHeaderClick","onTransitionEnd","enableOrDisableAnimation","onMenuButtonClick","onMenuButtonMouseEnter","onMenuButtonMouseLeave","onMenuUpdate","enableAnimation","isAnimating","menuButtonHover","showContextMenu","componentWillUpdate","collapsed","sectionBody","scrollHeight","visibilityState","maxHeight","SectionMenuOptions","CheckCollapsed","currentTarget","renderIcon","backgroundImage","preventDefault","isCollapsible","extraMenuOptions","showPrefName","privacyNoticeURL","isFirst","isLast","isWebExtension","needsDisclaimer","active","CollapsibleSection","MoveUp","SECTION_MOVE","direction","MoveDown","RemoveSection","CollapseSection","UPDATE_SECTION_PREFS","ExpandSection","ManageSection","SETTINGS_OPEN","ManageWebExtension","OPEN_WEBEXT_SETTINGS","AddTopSite","PrivacyNotice","RECORDED_SECTIONS","ComponentPerfTimer","Component","perfSvc","_sendBadStateEvent","_sendPaintedEvent","_reportMissingData","_timestampHandled","_recordedFirstRender","_maybeSendPaintedEvent","componentDidUpdate","_afterFramePaint","callback","requestAnimationFrame","_maybeSendBadStateEvent","_ensureFirstRenderTsRecorded","mark","dataReadyKey","firstRenderKey","parseInt","getMostRecentAbsMarkStartByName","ChromeUtils","import","usablePerfObj","Services","appShell","hiddenDOMWindow","performance","now","_PerfService","performanceObj","_perf","prototype","str","getEntriesByName","timeOrigin","absNow","mostRecentEntry","startTime","TopSiteLink","screenshotImage","onDragEvent","_allowDrop","dataTransfer","types","dragged","effectAllowed","setData","blur","getNextStateFromProps","imageInState","nextState","componentWillReceiveProps","defaultStyle","isDraggable","topSiteOuterClassName","isDragged","tippyTopIcon","faviconSize","letterFallback","imageClassName","imageStyle","showSmallFavicon","smallFaviconStyle","smallFaviconFallback","hasScreenshotImage","customScreenshotURL","backgroundColor","favicon","draggableProps","onDragEnd","onDragStart","onMouseDown","TopSite","onLinkClick","_getTelemetryInfo","icon_type","iconType","card_type","altKey","ctrlKey","metaKey","onActivate","isContextMenuOpen","activeIndex","hostname","TopSitePlaceholder","onEditButtonClick","_TopSiteList","DEFAULT_STATE","draggedIndex","draggedSite","draggedTitle","topSitesPreview","prevTopSites","newTopSites","dropped","_makeTopSitesPreview","TOP_SITES_INSERT","draggedFromIndex","_getTopSites","topSites","TopSitesRows","pinnedOnly","unpinned","siteToInsert","holeIndex","indexStep","shiftingStep","nextIndex","shift","topSitesUI","commonProps","maxNarrowVisibleIndex","l","topSiteIconType","slotProps","TopSiteList","gActivityStreamPrerenderedState","sendEventOrAddListener","hydrate","documentElement","lang","gActivityStreamStrings","addSnippetsSubscriber","DATABASE_NAME","DATABASE_VERSION","SNIPPETS_OBJECTSTORE_NAME","SNIPPETS_UPDATE_INTERVAL_MS","SNIPPETS_ENABLED_EVENT","SNIPPETS_DISABLED_EVENT","SnippetsMap","_db","_dispatch","_dbTransaction","db","put","clear","blockSnippetById","SNIPPETS_BLOCKLIST_UPDATED","disableOnboarding","DISABLE_ONBOARDING","showFirefoxAccounts","SHOW_FIREFOX_ACCOUNTS","getTotalBookmarksCount","Promise","TOTAL_BOOKMARKS_REQUEST","onMessage","TOTAL_BOOKMARKS_RESPONSE","getAddonsInfo","ADDONS_INFO_REQUEST","ADDONS_INFO_RESPONSE","_openDB","_restoreFromDb","modifier","reject","transaction","objectStore","onsuccess","onerror","openRequest","indexedDB","open","deleteDatabase","onupgradeneeded","objectStoreNames","contains","createObjectStore","onversionchange","versionChangeEvent","close","cursorRequest","openCursor","cursor","continue","SnippetsProvider","gSnippetsMap","_onAction","snippetsMap","_refreshSnippets","cachedVersion","appData","lastUpdate","needsUpdate","snippetsURL","response","fetch","status","_noSnippetFallback","_forceOnboardingVisibility","shouldBeVisible","onboardingEl","style","display","_showRemoteSnippets","snippetsEl","elementId","innerHTML","scriptEl","getElementsByTagName","relocatedScript","createElement","parentNode","replaceChild","dispatchEvent","Event","snippets","asrouterContent","initializing","subscribe","isASRouterEnabled","asrouterExperimentEnabled","asrouterOnboardingCohort","disableSnippets","contexts","subs","comp","unsubscribe","setMessages","relocalize","getMessageContext","formatCompound","mcx","fallback","isReactLocalization","propName","prop","l10n","getChildContext","Children","only","LocalizationProvider","childContextTypes","propTypes","PropTypes","element","isRequired","isIterable","componentName","withLocalization","Inner","WithLocalization","forceUpdate","displayName","contextTypes","component","TEMPLATE","parseMarkup","omittedCloseTags","area","base","col","embed","hr","img","input","keygen","param","track","wbr","voidElementTags","menuitem","reMarkup","toArguments","elems","propname","propval","substr","isValidElement","toLowerCase","messageValue","messageAttrs","localizedProps","cloneElement","translationNodes","childNodes","translatedChildren","childNode","nodeType","TEXT_NODE","textContent","localName","sourceChild","Localized","ImpressionsWrapper","sendImpressionOrAddListener","_onVisibilityChange","sendOnMount","body","classList","remove","button_label","onDoneButton","UISurface","onAction","ALLOWED_STYLE_TAGS","Button","tag","border","onBlockClicked","onBlock","containerClassName","DEFAULT_ICON_PATH","onButtonClick","renderTitle","renderTitleIcon","titleIcon","title_icon","renderButton","button_url","button_color","button_background_color","hasLink","button_type","hasButton","tall","richText","PrefsButton","addLocaleDataForReactIntl","locale","addLocaleData","parentLocale","_Base","sendNewTabRehydrated","isPrerendered","updateTheme","bodyClassName","isFirstrun","v","renderNotified","NEW_TAB_REHYDRATED","prefs","hash","BaseContent","openPreferences","shouldBeFixedToTop","PrerenderData","arePrefsValid","outerClassName","showSearch","migrationExpired","Base","ASRouterAdmin","findOtherBundledMessagesOfSameTemplate","bundled","handleBlock","handleUnblock","handleOverride","renderMessageItem","isCurrent","lastMessageId","isBlocked","itemClassName","renderMessages","renderProviders","providers","_ConfirmDialog","_handleCancelBtn","_handleConfirmBtn","_renderModalMessage","message_body","ConfirmDialog","_ManualMigration","onLaunchTour","onCancelTour","MIGRATION_START","MIGRATION_CANCEL","ManualMigration","_PrerenderData","initialPrefs","initialSections","_setValidation","validation","_validation","invalidatingPrefs","_invalidatingPrefs","oneOf","getPref","indexedDBPrefs","some","anyModifiedPrefs","prefName","order","_Search","onInputMount","handleEvent","detail","gContentSearchController","search","healthReportKey","IS_NEWTAB","searchSource","ContentSearchUIController","Search","documentURI","CARDS_PER_ROW_DEFAULT","CARDS_PER_ROW_COMPACT_WIDE","Section","numRows","rowsPref","maxRows","_dispatchImpressionStats","cardsPerRow","compactCards","matchMedia","matches","maxCards","cards","needsImpressionStats","impressionCardGuids","sendImpressionStatsOrAddListener","isCollapsed","wasCollapsed","emptyState","contextMenuOptions","maxCardsPerRow","maxCardsOnNarrow","shouldShowTopics","topics","realRows","shouldShowEmptyState","sectionClassName","feed","padding","read_more_endpoint","SectionIntl","_Sections","renderSections","sections","enabledSections","sectionOrder","showTopSites","expectedCount","sectionId","cardContextTypes","history","intlID","bookmark","trending","download","gImageLoading","activeCard","imageLoaded","cardImage","maybeLoadImage","imageUrl","loaderPromise","loader","Image","src","catch","then","WEBEXT_CLICK","click","_Card","hasImage","placeholder","description","Card","PlaceholderCard","DEFAULT_SECTION_MENU_OPTIONS","WEBEXT_SECTION_MENU_OPTIONS","_SectionMenu","extraOptions","SectionMenu","Topic","Topics","t","faviconRef","countTopSitesIconsTypes","countTopSitesTypes","_TopSites","onFormClose","_dispatchTopSitesStats","_getVisibleTopSites","topSitesIconsStats","topSitesPinned","topsites_icon_stats","topsites_pinned","sitesPerRow","topSitesRows","validationError","onChange","onMount","shouldFocus","focus","ev","showClearButton","onClear","typeUrl","titleId","loading","placeholderId","errorMessageId","TopSiteFormInput","customScreenshotUrl","showCustomScreenshotForm","onClearScreenshotInput","onLabelChange","onUrlChange","onCancelButtonClick","onClearUrlClick","onDoneButtonClick","onCustomScreenshotUrlChange","onPreviewButtonClick","onEnableScreenshotUrlForm","validateUrl","_updateCustomScreenshotInput","onClose","validateForm","cleanUrl","_tryParseUrl","validProtocols","urlObj","validateCustomScreenshotUrl","validate","_renderCustomScreenshotInput","requestFailed","isLoading","showAsAdd","previous","changed","previewMode","previewLink","TopSiteForm","_StartupOverlay","onInputChange","onSubmit","clickSkip","initScene","removeOverlay","onInputInvalid","emailInput","show","previousSibling","termsLink","privacyLink","terms","privacy","StartupOverlay","DetectUserSessionStart","_store","_perfService","perfService","_sendEvent","visibility_event_rcvd_ts"],"mappings":"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","file":"activity-stream.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 23);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 7d20b9d6e1d8b115b41d","module.exports = React;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"React\"\n// module id = 0\n// module chunks = 0","/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\"use strict\";\n\nthis.MAIN_MESSAGE_TYPE = \"ActivityStream:Main\";\nthis.CONTENT_MESSAGE_TYPE = \"ActivityStream:Content\";\nthis.PRELOAD_MESSAGE_TYPE = \"ActivityStream:PreloadedBrowser\";\nthis.UI_CODE = 1;\nthis.BACKGROUND_PROCESS = 2;\n\n/**\n * globalImportContext - Are we in UI code (i.e. react, a dom) or some kind of background process?\n *                       Use this in action creators if you need different logic\n *                       for ui/background processes.\n */\nconst globalImportContext = typeof Window === \"undefined\" ? BACKGROUND_PROCESS : UI_CODE;\n// Export for tests\nthis.globalImportContext = globalImportContext;\n\n// Create an object that avoids accidental differing key/value pairs:\n// {\n//   INIT: \"INIT\",\n//   UNINIT: \"UNINIT\"\n// }\nconst actionTypes = {};\nfor (const type of [\n  \"ADDONS_INFO_REQUEST\",\n  \"ADDONS_INFO_RESPONSE\",\n  \"ARCHIVE_FROM_POCKET\",\n  \"AS_ROUTER_TELEMETRY_USER_EVENT\",\n  \"BLOCK_URL\",\n  \"BOOKMARK_URL\",\n  \"COPY_DOWNLOAD_LINK\",\n  \"DELETE_BOOKMARK_BY_ID\",\n  \"DELETE_FROM_POCKET\",\n  \"DELETE_HISTORY_URL\",\n  \"DIALOG_CANCEL\",\n  \"DIALOG_OPEN\",\n  \"DISABLE_ONBOARDING\",\n  \"DOWNLOAD_CHANGED\",\n  \"INIT\",\n  \"MIGRATION_CANCEL\",\n  \"MIGRATION_COMPLETED\",\n  \"MIGRATION_START\",\n  \"NEW_TAB_INIT\",\n  \"NEW_TAB_INITIAL_STATE\",\n  \"NEW_TAB_LOAD\",\n  \"NEW_TAB_REHYDRATED\",\n  \"NEW_TAB_STATE_REQUEST\",\n  \"NEW_TAB_UNLOAD\",\n  \"OPEN_DOWNLOAD_FILE\",\n  \"OPEN_LINK\",\n  \"OPEN_NEW_WINDOW\",\n  \"OPEN_PRIVATE_WINDOW\",\n  \"OPEN_WEBEXT_SETTINGS\",\n  \"PAGE_PRERENDERED\",\n  \"PLACES_BOOKMARK_ADDED\",\n  \"PLACES_BOOKMARK_REMOVED\",\n  \"PLACES_HISTORY_CLEARED\",\n  \"PLACES_LINKS_CHANGED\",\n  \"PLACES_LINK_BLOCKED\",\n  \"PLACES_LINK_DELETED\",\n  \"PLACES_SAVED_TO_POCKET\",\n  \"PREFS_INITIAL_VALUES\",\n  \"PREF_CHANGED\",\n  \"PREVIEW_REQUEST\",\n  \"PREVIEW_REQUEST_CANCEL\",\n  \"PREVIEW_RESPONSE\",\n  \"REMOVE_DOWNLOAD_FILE\",\n  \"RICH_ICON_MISSING\",\n  \"SAVE_SESSION_PERF_DATA\",\n  \"SAVE_TO_POCKET\",\n  \"SCREENSHOT_UPDATED\",\n  \"SECTION_DEREGISTER\",\n  \"SECTION_DISABLE\",\n  \"SECTION_ENABLE\",\n  \"SECTION_MOVE\",\n  \"SECTION_OPTIONS_CHANGED\",\n  \"SECTION_REGISTER\",\n  \"SECTION_UPDATE\",\n  \"SECTION_UPDATE_CARD\",\n  \"SETTINGS_CLOSE\",\n  \"SETTINGS_OPEN\",\n  \"SET_PREF\",\n  \"SHOW_DOWNLOAD_FILE\",\n  \"SHOW_FIREFOX_ACCOUNTS\",\n  \"SKIPPED_SIGNIN\",\n  \"SNIPPETS_BLOCKLIST_CLEARED\",\n  \"SNIPPETS_BLOCKLIST_UPDATED\",\n  \"SNIPPETS_DATA\",\n  \"SNIPPETS_RESET\",\n  \"SNIPPET_BLOCKED\",\n  \"SUBMIT_EMAIL\",\n  \"SYSTEM_TICK\",\n  \"TELEMETRY_IMPRESSION_STATS\",\n  \"TELEMETRY_PERFORMANCE_EVENT\",\n  \"TELEMETRY_UNDESIRED_EVENT\",\n  \"TELEMETRY_USER_EVENT\",\n  \"TOP_SITES_CANCEL_EDIT\",\n  \"TOP_SITES_EDIT\",\n  \"TOP_SITES_INSERT\",\n  \"TOP_SITES_PIN\",\n  \"TOP_SITES_PREFS_UPDATED\",\n  \"TOP_SITES_UNPIN\",\n  \"TOP_SITES_UPDATED\",\n  \"TOTAL_BOOKMARKS_REQUEST\",\n  \"TOTAL_BOOKMARKS_RESPONSE\",\n  \"UNINIT\",\n  \"UPDATE_SECTION_PREFS\",\n  \"WEBEXT_CLICK\",\n  \"WEBEXT_DISMISS\"\n]) {\n  actionTypes[type] = type;\n}\n\n// These are acceptable actions for AS Router messages to have. They can show up\n// as call-to-action buttons in snippets, onboarding tour, etc.\nconst ASRouterActions = {};\nfor (const type of [\n  \"OPEN_PRIVATE_BROWSER_WINDOW\",\n  \"OPEN_URL\",\n  \"OPEN_ABOUT_PAGE\"\n]) {\n  ASRouterActions[type] = type;\n}\n\n// Helper function for creating routed actions between content and main\n// Not intended to be used by consumers\nfunction _RouteMessage(action, options) {\n  const meta = action.meta ? {...action.meta} : {};\n  if (!options || !options.from || !options.to) {\n    throw new Error(\"Routed Messages must have options as the second parameter, and must at least include a .from and .to property.\");\n  }\n  // For each of these fields, if they are passed as an option,\n  // add them to the action. If they are not defined, remove them.\n  [\"from\", \"to\", \"toTarget\", \"fromTarget\", \"skipMain\", \"skipLocal\"].forEach(o => {\n    if (typeof options[o] !== \"undefined\") {\n      meta[o] = options[o];\n    } else if (meta[o]) {\n      delete meta[o];\n    }\n  });\n  return {...action, meta};\n}\n\n/**\n * AlsoToMain - Creates a message that will be dispatched locally and also sent to the Main process.\n *\n * @param  {object} action Any redux action (required)\n * @param  {object} options\n * @param  {bool}   skipLocal Used by OnlyToMain to skip the main reducer\n * @param  {string} fromTarget The id of the content port from which the action originated. (optional)\n * @return {object} An action with added .meta properties\n */\nfunction AlsoToMain(action, fromTarget, skipLocal) {\n  return _RouteMessage(action, {\n    from: CONTENT_MESSAGE_TYPE,\n    to: MAIN_MESSAGE_TYPE,\n    fromTarget,\n    skipLocal\n  });\n}\n\n/**\n * OnlyToMain - Creates a message that will be sent to the Main process and skip the local reducer.\n *\n * @param  {object} action Any redux action (required)\n * @param  {object} options\n * @param  {string} fromTarget The id of the content port from which the action originated. (optional)\n * @return {object} An action with added .meta properties\n */\nfunction OnlyToMain(action, fromTarget) {\n  return AlsoToMain(action, fromTarget, true);\n}\n\n/**\n * BroadcastToContent - Creates a message that will be dispatched to main and sent to ALL content processes.\n *\n * @param  {object} action Any redux action (required)\n * @return {object} An action with added .meta properties\n */\nfunction BroadcastToContent(action) {\n  return _RouteMessage(action, {\n    from: MAIN_MESSAGE_TYPE,\n    to: CONTENT_MESSAGE_TYPE\n  });\n}\n\n/**\n * AlsoToOneContent - Creates a message that will be will be dispatched to the main store\n *                    and also sent to a particular Content process.\n *\n * @param  {object} action Any redux action (required)\n * @param  {string} target The id of a content port\n * @param  {bool} skipMain Used by OnlyToOneContent to skip the main process\n * @return {object} An action with added .meta properties\n */\nfunction AlsoToOneContent(action, target, skipMain) {\n  if (!target) {\n    throw new Error(\"You must provide a target ID as the second parameter of AlsoToOneContent. If you want to send to all content processes, use BroadcastToContent\");\n  }\n  return _RouteMessage(action, {\n    from: MAIN_MESSAGE_TYPE,\n    to: CONTENT_MESSAGE_TYPE,\n    toTarget: target,\n    skipMain\n  });\n}\n\n/**\n * OnlyToOneContent - Creates a message that will be sent to a particular Content process\n *                    and skip the main reducer.\n *\n * @param  {object} action Any redux action (required)\n * @param  {string} target The id of a content port\n * @return {object} An action with added .meta properties\n */\nfunction OnlyToOneContent(action, target) {\n  return AlsoToOneContent(action, target, true);\n}\n\n/**\n * AlsoToPreloaded - Creates a message that dispatched to the main reducer and also sent to the preloaded tab.\n *\n * @param  {object} action Any redux action (required)\n * @return {object} An action with added .meta properties\n */\nfunction AlsoToPreloaded(action) {\n  return _RouteMessage(action, {\n    from: MAIN_MESSAGE_TYPE,\n    to: PRELOAD_MESSAGE_TYPE\n  });\n}\n\n/**\n * UserEvent - A telemetry ping indicating a user action. This should only\n *                   be sent from the UI during a user session.\n *\n * @param  {object} data Fields to include in the ping (source, etc.)\n * @return {object} An AlsoToMain action\n */\nfunction UserEvent(data) {\n  return AlsoToMain({\n    type: actionTypes.TELEMETRY_USER_EVENT,\n    data\n  });\n}\n\n/**\n * ASRouterUserEvent - A telemetry ping indicating a user action from AS router. This should only\n *                     be sent from the UI during a user session.\n *\n * @param  {object} data Fields to include in the ping (source, etc.)\n * @return {object} An AlsoToMain action\n */\nfunction ASRouterUserEvent(data) {\n  return AlsoToMain({\n    type: actionTypes.AS_ROUTER_TELEMETRY_USER_EVENT,\n    data\n  });\n}\n\n/**\n * UndesiredEvent - A telemetry ping indicating an undesired state.\n *\n * @param  {object} data Fields to include in the ping (value, etc.)\n * @param  {int} importContext (For testing) Override the import context for testing.\n * @return {object} An action. For UI code, a AlsoToMain action.\n */\nfunction UndesiredEvent(data, importContext = globalImportContext) {\n  const action = {\n    type: actionTypes.TELEMETRY_UNDESIRED_EVENT,\n    data\n  };\n  return importContext === UI_CODE ? AlsoToMain(action) : action;\n}\n\n/**\n * PerfEvent - A telemetry ping indicating a performance-related event.\n *\n * @param  {object} data Fields to include in the ping (value, etc.)\n * @param  {int} importContext (For testing) Override the import context for testing.\n * @return {object} An action. For UI code, a AlsoToMain action.\n */\nfunction PerfEvent(data, importContext = globalImportContext) {\n  const action = {\n    type: actionTypes.TELEMETRY_PERFORMANCE_EVENT,\n    data\n  };\n  return importContext === UI_CODE ? AlsoToMain(action) : action;\n}\n\n/**\n * ImpressionStats - A telemetry ping indicating an impression stats.\n *\n * @param  {object} data Fields to include in the ping\n * @param  {int} importContext (For testing) Override the import context for testing.\n * #return {object} An action. For UI code, a AlsoToMain action.\n */\nfunction ImpressionStats(data, importContext = globalImportContext) {\n  const action = {\n    type: actionTypes.TELEMETRY_IMPRESSION_STATS,\n    data\n  };\n  return importContext === UI_CODE ? AlsoToMain(action) : action;\n}\n\nfunction SetPref(name, value, importContext = globalImportContext) {\n  const action = {type: actionTypes.SET_PREF, data: {name, value}};\n  return importContext === UI_CODE ? AlsoToMain(action) : action;\n}\n\nfunction WebExtEvent(type, data, importContext = globalImportContext) {\n  if (!data || !data.source) {\n    throw new Error(\"WebExtEvent actions should include a property \\\"source\\\", the id of the webextension that should receive the event.\");\n  }\n  const action = {type, data};\n  return importContext === UI_CODE ? AlsoToMain(action) : action;\n}\n\nthis.actionTypes = actionTypes;\nthis.ASRouterActions = ASRouterActions;\n\nthis.actionCreators = {\n  BroadcastToContent,\n  UserEvent,\n  ASRouterUserEvent,\n  UndesiredEvent,\n  PerfEvent,\n  ImpressionStats,\n  AlsoToOneContent,\n  OnlyToOneContent,\n  AlsoToMain,\n  OnlyToMain,\n  AlsoToPreloaded,\n  SetPref,\n  WebExtEvent\n};\n\n// These are helpers to test for certain kinds of actions\nthis.actionUtils = {\n  isSendToMain(action) {\n    if (!action.meta) {\n      return false;\n    }\n    return action.meta.to === MAIN_MESSAGE_TYPE && action.meta.from === CONTENT_MESSAGE_TYPE;\n  },\n  isBroadcastToContent(action) {\n    if (!action.meta) {\n      return false;\n    }\n    if (action.meta.to === CONTENT_MESSAGE_TYPE && !action.meta.toTarget) {\n      return true;\n    }\n    return false;\n  },\n  isSendToOneContent(action) {\n    if (!action.meta) {\n      return false;\n    }\n    if (action.meta.to === CONTENT_MESSAGE_TYPE && action.meta.toTarget) {\n      return true;\n    }\n    return false;\n  },\n  isSendToPreloaded(action) {\n    if (!action.meta) {\n      return false;\n    }\n    return action.meta.to === PRELOAD_MESSAGE_TYPE &&\n      action.meta.from === MAIN_MESSAGE_TYPE;\n  },\n  isFromMain(action) {\n    if (!action.meta) {\n      return false;\n    }\n    return action.meta.from === MAIN_MESSAGE_TYPE &&\n      action.meta.to === CONTENT_MESSAGE_TYPE;\n  },\n  getPortIdOfSender(action) {\n    return (action.meta && action.meta.fromTarget) || null;\n  },\n  _RouteMessage\n};\n\nconst EXPORTED_SYMBOLS = [\n  \"actionTypes\",\n  \"actionCreators\",\n  \"actionUtils\",\n  \"ASRouterActions\",\n  \"globalImportContext\",\n  \"UI_CODE\",\n  \"BACKGROUND_PROCESS\",\n  \"MAIN_MESSAGE_TYPE\",\n  \"CONTENT_MESSAGE_TYPE\",\n  \"PRELOAD_MESSAGE_TYPE\"\n];\n\n\n\n// WEBPACK FOOTER //\n// ./common/Actions.jsm","module.exports = ReactIntl;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ReactIntl\"\n// module id = 2\n// module chunks = 0","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 3\n// module chunks = 0","module.exports = ReactRedux;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ReactRedux\"\n// module id = 4\n// module chunks = 0","export function safeURI(url) {\n  if (!url) {\n    return \"\";\n  }\n  const {protocol} = new URL(url);\n  const isAllowed = [\n    \"http:\",\n    \"https:\",\n    \"data:\",\n    \"resource:\",\n    \"chrome:\"\n  ].includes(protocol);\n  if (!isAllowed) {\n    console.warn(`The protocol ${protocol} is not allowed for template URLs.`); // eslint-disable-line no-console\n  }\n  return isAllowed ? url : \"\";\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/asrouter/template-utils.js","export const TOP_SITES_SOURCE = \"TOP_SITES\";\nexport const TOP_SITES_CONTEXT_MENU_OPTIONS = [\"CheckPinTopSite\", \"EditTopSite\", \"Separator\",\n  \"OpenInNewWindow\", \"OpenInPrivateWindow\", \"Separator\", \"BlockUrl\", \"DeleteUrl\"];\n// minimum size necessary to show a rich icon instead of a screenshot\nexport const MIN_RICH_FAVICON_SIZE = 96;\n// minimum size necessary to show any icon in the top left corner with a screenshot\nexport const MIN_CORNER_FAVICON_SIZE = 16;\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/TopSites/TopSitesConstants.js","this.Dedupe = class Dedupe {\n  constructor(createKey) {\n    this.createKey = createKey || this.defaultCreateKey;\n  }\n\n  defaultCreateKey(item) {\n    return item;\n  }\n\n  /**\n   * Dedupe any number of grouped elements favoring those from earlier groups.\n   *\n   * @param {Array} groups Contains an arbitrary number of arrays of elements.\n   * @returns {Array} A matching array of each provided group deduped.\n   */\n  group(...groups) {\n    const globalKeys = new Set();\n    const result = [];\n    for (const values of groups) {\n      const valueMap = new Map();\n      for (const value of values) {\n        const key = this.createKey(value);\n        if (!globalKeys.has(key) && !valueMap.has(key)) {\n          valueMap.set(key, value);\n        }\n      }\n      result.push(valueMap);\n      valueMap.forEach((value, key) => globalKeys.add(key));\n    }\n    return result.map(m => Array.from(m.values()));\n  }\n};\n\nconst EXPORTED_SYMBOLS = [\"Dedupe\"];\n\n\n\n// WEBPACK FOOTER //\n// ./common/Dedupe.jsm","/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\"use strict\";\n\nconst {actionTypes: at} = ChromeUtils.import(\"resource://activity-stream/common/Actions.jsm\", {});\nconst {Dedupe} = ChromeUtils.import(\"resource://activity-stream/common/Dedupe.jsm\", {});\n\nconst TOP_SITES_DEFAULT_ROWS = 1;\nconst TOP_SITES_MAX_SITES_PER_ROW = 8;\n\nconst dedupe = new Dedupe(site => site && site.url);\n\nconst INITIAL_STATE = {\n  App: {\n    // Have we received real data from the app yet?\n    initialized: false,\n    // The version of the system-addon\n    version: null\n  },\n  Snippets: {initialized: false},\n  TopSites: {\n    // Have we received real data from history yet?\n    initialized: false,\n    // The history (and possibly default) links\n    rows: [],\n    // Used in content only to dispatch action to TopSiteForm.\n    editForm: null\n  },\n  Prefs: {\n    initialized: false,\n    values: {}\n  },\n  Dialog: {\n    visible: false,\n    data: {}\n  },\n  Sections: []\n};\n\nfunction App(prevState = INITIAL_STATE.App, action) {\n  switch (action.type) {\n    case at.INIT:\n      return Object.assign({}, prevState, action.data || {}, {initialized: true});\n    default:\n      return prevState;\n  }\n}\n\n/**\n * insertPinned - Inserts pinned links in their specified slots\n *\n * @param {array} a list of links\n * @param {array} a list of pinned links\n * @return {array} resulting list of links with pinned links inserted\n */\nfunction insertPinned(links, pinned) {\n  // Remove any pinned links\n  const pinnedUrls = pinned.map(link => link && link.url);\n  let newLinks = links.filter(link => (link ? !pinnedUrls.includes(link.url) : false));\n  newLinks = newLinks.map(link => {\n    if (link && link.isPinned) {\n      delete link.isPinned;\n      delete link.pinIndex;\n    }\n    return link;\n  });\n\n  // Then insert them in their specified location\n  pinned.forEach((val, index) => {\n    if (!val) { return; }\n    let link = Object.assign({}, val, {isPinned: true, pinIndex: index});\n    if (index > newLinks.length) {\n      newLinks[index] = link;\n    } else {\n      newLinks.splice(index, 0, link);\n    }\n  });\n\n  return newLinks;\n}\n\nfunction TopSites(prevState = INITIAL_STATE.TopSites, action) {\n  let hasMatch;\n  let newRows;\n  switch (action.type) {\n    case at.TOP_SITES_UPDATED:\n      if (!action.data || !action.data.links) {\n        return prevState;\n      }\n      return Object.assign({}, prevState, {initialized: true, rows: action.data.links}, action.data.pref ? {pref: action.data.pref} : {});\n    case at.TOP_SITES_PREFS_UPDATED:\n      return Object.assign({}, prevState, {pref: action.data.pref});\n    case at.TOP_SITES_EDIT:\n      return Object.assign({}, prevState, {\n        editForm: {\n          index: action.data.index,\n          previewResponse: null\n        }\n      });\n    case at.TOP_SITES_CANCEL_EDIT:\n      return Object.assign({}, prevState, {editForm: null});\n    case at.PREVIEW_RESPONSE:\n      if (!prevState.editForm || action.data.url !== prevState.editForm.previewUrl) {\n        return prevState;\n      }\n      return Object.assign({}, prevState, {\n        editForm: {\n          index: prevState.editForm.index,\n          previewResponse: action.data.preview,\n          previewUrl: action.data.url\n        }\n      });\n    case at.PREVIEW_REQUEST:\n      if (!prevState.editForm) {\n        return prevState;\n      }\n      return Object.assign({}, prevState, {\n        editForm: {\n          index: prevState.editForm.index,\n          previewResponse: null,\n          previewUrl: action.data.url\n        }\n      });\n    case at.PREVIEW_REQUEST_CANCEL:\n      if (!prevState.editForm) {\n        return prevState;\n      }\n      return Object.assign({}, prevState, {\n        editForm: {\n          index: prevState.editForm.index,\n          previewResponse: null\n        }\n      });\n    case at.SCREENSHOT_UPDATED:\n      newRows = prevState.rows.map(row => {\n        if (row && row.url === action.data.url) {\n          hasMatch = true;\n          return Object.assign({}, row, {screenshot: action.data.screenshot});\n        }\n        return row;\n      });\n      return hasMatch ? Object.assign({}, prevState, {rows: newRows}) : prevState;\n    case at.PLACES_BOOKMARK_ADDED:\n      if (!action.data) {\n        return prevState;\n      }\n      newRows = prevState.rows.map(site => {\n        if (site && site.url === action.data.url) {\n          const {bookmarkGuid, bookmarkTitle, dateAdded} = action.data;\n          return Object.assign({}, site, {bookmarkGuid, bookmarkTitle, bookmarkDateCreated: dateAdded});\n        }\n        return site;\n      });\n      return Object.assign({}, prevState, {rows: newRows});\n    case at.PLACES_BOOKMARK_REMOVED:\n      if (!action.data) {\n        return prevState;\n      }\n      newRows = prevState.rows.map(site => {\n        if (site && site.url === action.data.url) {\n          const newSite = Object.assign({}, site);\n          delete newSite.bookmarkGuid;\n          delete newSite.bookmarkTitle;\n          delete newSite.bookmarkDateCreated;\n          return newSite;\n        }\n        return site;\n      });\n      return Object.assign({}, prevState, {rows: newRows});\n    case at.PLACES_LINK_DELETED:\n      if (!action.data) {\n        return prevState;\n      }\n      newRows = prevState.rows.filter(site => action.data.url !== site.url);\n      return Object.assign({}, prevState, {rows: newRows});\n    default:\n      return prevState;\n  }\n}\n\nfunction Dialog(prevState = INITIAL_STATE.Dialog, action) {\n  switch (action.type) {\n    case at.DIALOG_OPEN:\n      return Object.assign({}, prevState, {visible: true, data: action.data});\n    case at.DIALOG_CANCEL:\n      return Object.assign({}, prevState, {visible: false});\n    case at.DELETE_HISTORY_URL:\n      return Object.assign({}, INITIAL_STATE.Dialog);\n    default:\n      return prevState;\n  }\n}\n\nfunction Prefs(prevState = INITIAL_STATE.Prefs, action) {\n  let newValues;\n  switch (action.type) {\n    case at.PREFS_INITIAL_VALUES:\n      return Object.assign({}, prevState, {initialized: true, values: action.data});\n    case at.PREF_CHANGED:\n      newValues = Object.assign({}, prevState.values);\n      newValues[action.data.name] = action.data.value;\n      return Object.assign({}, prevState, {values: newValues});\n    default:\n      return prevState;\n  }\n}\n\nfunction Sections(prevState = INITIAL_STATE.Sections, action) {\n  let hasMatch;\n  let newState;\n  switch (action.type) {\n    case at.SECTION_DEREGISTER:\n      return prevState.filter(section => section.id !== action.data);\n    case at.SECTION_REGISTER:\n      // If section exists in prevState, update it\n      newState = prevState.map(section => {\n        if (section && section.id === action.data.id) {\n          hasMatch = true;\n          return Object.assign({}, section, action.data);\n        }\n        return section;\n      });\n      // Otherwise, append it\n      if (!hasMatch) {\n        const initialized = !!(action.data.rows && action.data.rows.length > 0);\n        const section = Object.assign({title: \"\", rows: [], enabled: false}, action.data, {initialized});\n        newState.push(section);\n      }\n      return newState;\n    case at.SECTION_UPDATE:\n      newState = prevState.map(section => {\n        if (section && section.id === action.data.id) {\n          // If the action is updating rows, we should consider initialized to be true.\n          // This can be overridden if initialized is defined in the action.data\n          const initialized = action.data.rows ? {initialized: true} : {};\n\n          // Make sure pinned cards stay at their current position when rows are updated.\n          // Disabling a section (SECTION_UPDATE with empty rows) does not retain pinned cards.\n          if (action.data.rows && action.data.rows.length > 0 && section.rows.find(card => card.pinned)) {\n            const rows = Array.from(action.data.rows);\n            section.rows.forEach((card, index) => {\n              if (card.pinned) {\n                rows.splice(index, 0, card);\n              }\n            });\n            return Object.assign({}, section, initialized, Object.assign({}, action.data, {rows}));\n          }\n\n          return Object.assign({}, section, initialized, action.data);\n        }\n        return section;\n      });\n\n      if (!action.data.dedupeConfigurations) {\n        return newState;\n      }\n\n      action.data.dedupeConfigurations.forEach(dedupeConf => {\n        newState = newState.map(section => {\n          if (section.id === dedupeConf.id) {\n            const dedupedRows = dedupeConf.dedupeFrom.reduce((rows, dedupeSectionId) => {\n              const dedupeSection = newState.find(s => s.id === dedupeSectionId);\n              const [, newRows] = dedupe.group(dedupeSection.rows, rows);\n              return newRows;\n            }, section.rows);\n\n            return Object.assign({}, section, {rows: dedupedRows});\n          }\n\n          return section;\n        });\n      });\n\n      return newState;\n    case at.SECTION_UPDATE_CARD:\n      return prevState.map(section => {\n        if (section && section.id === action.data.id && section.rows) {\n          const newRows = section.rows.map(card => {\n            if (card.url === action.data.url) {\n              return Object.assign({}, card, action.data.options);\n            }\n            return card;\n          });\n          return Object.assign({}, section, {rows: newRows});\n        }\n        return section;\n      });\n    case at.PLACES_BOOKMARK_ADDED:\n      if (!action.data) {\n        return prevState;\n      }\n      return prevState.map(section => Object.assign({}, section, {\n        rows: section.rows.map(item => {\n          // find the item within the rows that is attempted to be bookmarked\n          if (item.url === action.data.url) {\n            const {bookmarkGuid, bookmarkTitle, dateAdded} = action.data;\n            return Object.assign({}, item, {\n              bookmarkGuid,\n              bookmarkTitle,\n              bookmarkDateCreated: dateAdded,\n              type: \"bookmark\"\n            });\n          }\n          return item;\n        })\n      }));\n    case at.PLACES_SAVED_TO_POCKET:\n      if (!action.data) {\n        return prevState;\n      }\n      return prevState.map(section => Object.assign({}, section, {\n        rows: section.rows.map(item => {\n          if (item.url === action.data.url) {\n            return Object.assign({}, item, {\n              open_url: action.data.open_url,\n              pocket_id: action.data.pocket_id,\n              title: action.data.title,\n              type: \"pocket\"\n            });\n          }\n          return item;\n        })\n      }));\n    case at.PLACES_BOOKMARK_REMOVED:\n      if (!action.data) {\n        return prevState;\n      }\n      return prevState.map(section => Object.assign({}, section, {\n        rows: section.rows.map(item => {\n          // find the bookmark within the rows that is attempted to be removed\n          if (item.url === action.data.url) {\n            const newSite = Object.assign({}, item);\n            delete newSite.bookmarkGuid;\n            delete newSite.bookmarkTitle;\n            delete newSite.bookmarkDateCreated;\n            if (!newSite.type || newSite.type === \"bookmark\") {\n              newSite.type = \"history\";\n            }\n            return newSite;\n          }\n          return item;\n        })\n      }));\n    case at.PLACES_LINK_DELETED:\n    case at.PLACES_LINK_BLOCKED:\n      if (!action.data) {\n        return prevState;\n      }\n      return prevState.map(section =>\n        Object.assign({}, section, {rows: section.rows.filter(site => site.url !== action.data.url)}));\n    case at.DELETE_FROM_POCKET:\n    case at.ARCHIVE_FROM_POCKET:\n      return prevState.map(section =>\n        Object.assign({}, section, {rows: section.rows.filter(site => site.pocket_id !== action.data.pocket_id)}));\n    default:\n      return prevState;\n  }\n}\n\nfunction Snippets(prevState = INITIAL_STATE.Snippets, action) {\n  switch (action.type) {\n    case at.SNIPPETS_DATA:\n      return Object.assign({}, prevState, {initialized: true}, action.data);\n    case at.SNIPPET_BLOCKED:\n      return Object.assign({}, prevState, {blockList: prevState.blockList.concat(action.data)});\n    case at.SNIPPETS_BLOCKLIST_CLEARED:\n      return Object.assign({}, prevState, {blockList: []});\n    case at.SNIPPETS_RESET:\n      return INITIAL_STATE.Snippets;\n    default:\n      return prevState;\n  }\n}\n\nthis.INITIAL_STATE = INITIAL_STATE;\nthis.TOP_SITES_DEFAULT_ROWS = TOP_SITES_DEFAULT_ROWS;\nthis.TOP_SITES_MAX_SITES_PER_ROW = TOP_SITES_MAX_SITES_PER_ROW;\n\nthis.reducers = {TopSites, App, Snippets, Prefs, Dialog, Sections};\n\nconst EXPORTED_SYMBOLS = [\"reducers\", \"INITIAL_STATE\", \"insertPinned\", \"TOP_SITES_DEFAULT_ROWS\", \"TOP_SITES_MAX_SITES_PER_ROW\"];\n\n\n\n// WEBPACK FOOTER //\n// ./common/Reducers.jsm","import {actionCreators as ac, ASRouterActions as ra} from \"common/Actions.jsm\";\nimport {LocalizationProvider, Localized} from \"fluent-react\";\nimport {OUTGOING_MESSAGE_NAME as AS_GENERAL_OUTGOING_MESSAGE_NAME} from \"content-src/lib/init-store\";\nimport {ImpressionsWrapper} from \"./components/ImpressionsWrapper/ImpressionsWrapper\";\nimport {MessageContext} from \"fluent\";\nimport {OnboardingMessage} from \"./templates/OnboardingMessage/OnboardingMessage\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport {safeURI} from \"./template-utils\";\nimport {SimpleSnippet} from \"./templates/SimpleSnippet/SimpleSnippet\";\n\nconst INCOMING_MESSAGE_NAME = \"ASRouter:parent-to-child\";\nconst OUTGOING_MESSAGE_NAME = \"ASRouter:child-to-parent\";\n\nexport const ASRouterUtils = {\n  addListener(listener) {\n    global.RPMAddMessageListener(INCOMING_MESSAGE_NAME, listener);\n  },\n  removeListener(listener) {\n    global.RPMRemoveMessageListener(INCOMING_MESSAGE_NAME, listener);\n  },\n  sendMessage(action) {\n    global.RPMSendAsyncMessage(OUTGOING_MESSAGE_NAME, action);\n  },\n  blockById(id) {\n    ASRouterUtils.sendMessage({type: \"BLOCK_MESSAGE_BY_ID\", data: {id}});\n  },\n  blockBundle(bundle) {\n    ASRouterUtils.sendMessage({type: \"BLOCK_BUNDLE\", data: {bundle}});\n  },\n  executeAction({button_action, button_action_params}) {\n    if (button_action in ra) {\n      ASRouterUtils.sendMessage({type: button_action, data: {button_action_params}});\n    }\n  },\n  unblockById(id) {\n    ASRouterUtils.sendMessage({type: \"UNBLOCK_MESSAGE_BY_ID\", data: {id}});\n  },\n  unblockBundle(bundle) {\n    ASRouterUtils.sendMessage({type: \"UNBLOCK_BUNDLE\", data: {bundle}});\n  },\n  getNextMessage() {\n    ASRouterUtils.sendMessage({type: \"GET_NEXT_MESSAGE\"});\n  },\n  overrideMessage(id) {\n    ASRouterUtils.sendMessage({type: \"OVERRIDE_MESSAGE\", data: {id}});\n  },\n  sendTelemetry(ping) {\n    const payload = ac.ASRouterUserEvent(ping);\n    global.RPMSendAsyncMessage(AS_GENERAL_OUTGOING_MESSAGE_NAME, payload);\n  },\n  getEndpoint() {\n    if (window.location.href.includes(\"endpoint\")) {\n      const params = new URLSearchParams(window.location.href.slice(window.location.href.indexOf(\"endpoint\")));\n      try {\n        const endpoint = new URL(params.get(\"endpoint\"));\n        return {\n          url: endpoint.href,\n          snippetId: params.get(\"snippetId\")\n        };\n      } catch (e) {}\n    }\n\n    return null;\n  }\n};\n\n// Note: nextProps/prevProps refer to props passed to <ImpressionsWrapper />, not <ASRouterUISurface />\nfunction shouldSendImpressionOnUpdate(nextProps, prevProps) {\n  return (nextProps.message.id && (!prevProps.message || prevProps.message.id !== nextProps.message.id));\n}\n\nfunction generateMessages(content) {\n  const cx = new MessageContext(\"en-US\");\n  cx.addMessages(`RichTextSnippet = ${content}`);\n  return [cx];\n}\n\n// Elements allowed in snippet content\nconst ALLOWED_TAGS = {\n  b: <b />,\n  i: <i />,\n  u: <u />,\n  strong: <strong />,\n  em: <em />,\n  br: <br />\n};\n\n/**\n * Transform an object (tag name: {url}) into (tag name: anchor) where the url\n * is used as href, in order to render links inside a Fluent.Localized component.\n */\nexport function convertLinks(links, sendClick) {\n  if (links) {\n    return Object.keys(links).reduce((acc, linkTag) => {\n      acc[linkTag] = <a href={safeURI(links[linkTag].url)} data-metric={links[linkTag].metric} onClick={sendClick} />;\n      return acc;\n    }, {});\n  }\n\n  return null;\n}\n\n/**\n * Message wrapper used to sanitize markup and render HTML.\n */\nfunction RichText(props) {\n  return (\n    <Localized id=\"RichTextSnippet\" {...ALLOWED_TAGS} {...convertLinks(props.links, props.sendClick)}>\n      <span>{props.text}</span>\n    </Localized>\n  );\n}\n\nexport class ASRouterUISurface extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.onMessageFromParent = this.onMessageFromParent.bind(this);\n    this.sendClick = this.sendClick.bind(this);\n    this.sendImpression = this.sendImpression.bind(this);\n    this.sendUserActionTelemetry = this.sendUserActionTelemetry.bind(this);\n    this.state = {message: {}, bundle: {}};\n  }\n\n  sendUserActionTelemetry(extraProps = {}) {\n    const {message, bundle} = this.state;\n    if (!message && !extraProps.message_id) {\n      throw new Error(`You must provide a message_id for bundled messages`);\n    }\n    const eventType = `${message.provider || bundle.provider}_user_event`;\n    ASRouterUtils.sendTelemetry({\n      message_id: message.id || extraProps.message_id,\n      source: extraProps.id,\n      action: eventType,\n      ...extraProps\n    });\n  }\n\n  sendImpression(extraProps) {\n    this.sendUserActionTelemetry({event: \"IMPRESSION\", ...extraProps});\n  }\n\n  // If link has a `metric` data attribute send it as part of the `value`\n  // telemetry field which can have arbitrary values.\n  // Used for router messages with links as part of the content.\n  sendClick(event) {\n    const metric = {\n      value: event.target.dataset.metric,\n      // Used for the `source` of the event. Needed to differentiate\n      // from other snippet or onboarding events that may occur.\n      id: \"NEWTAB_FOOTER_BAR_CONTENT\"\n    };\n    this.sendUserActionTelemetry({event: \"CLICK_BUTTON\", ...metric});\n  }\n\n  onBlockById(id) {\n    return () => ASRouterUtils.blockById(id);\n  }\n\n  clearBundle(bundle) {\n    return () => ASRouterUtils.blockBundle(bundle);\n  }\n\n  onMessageFromParent({data: action}) {\n    switch (action.type) {\n      case \"SET_MESSAGE\":\n        this.setState({message: action.data});\n        break;\n      case \"SET_BUNDLED_MESSAGES\":\n        this.setState({bundle: action.data});\n        break;\n      case \"CLEAR_MESSAGE\":\n        if (action.data.id === this.state.message.id) {\n          this.setState({message: {}});\n        }\n        break;\n      case \"CLEAR_BUNDLE\":\n        if (this.state.bundle.bundle) {\n          this.setState({bundle: {}});\n        }\n        break;\n      case \"CLEAR_ALL\":\n        this.setState({message: {}, bundle: {}});\n    }\n  }\n\n  componentWillMount() {\n    const endpoint = ASRouterUtils.getEndpoint();\n    ASRouterUtils.addListener(this.onMessageFromParent);\n\n    // If we are loading about:welcome we want to trigger the onboarding messages\n    if (this.props.document.location.href === \"about:welcome\") {\n      ASRouterUtils.sendMessage({type: \"TRIGGER\", data: {trigger: \"firstRun\"}});\n    } else {\n      ASRouterUtils.sendMessage({type: \"CONNECT_UI_REQUEST\", data: {endpoint}});\n    }\n  }\n\n  componentWillUnmount() {\n    ASRouterUtils.removeListener(this.onMessageFromParent);\n  }\n\n  renderSnippets() {\n    return (\n      <ImpressionsWrapper\n        id=\"NEWTAB_FOOTER_BAR\"\n        message={this.state.message}\n        sendImpression={this.sendImpression}\n        shouldSendImpressionOnUpdate={shouldSendImpressionOnUpdate}\n        // This helps with testing\n        document={this.props.document}>\n          <LocalizationProvider messages={generateMessages(this.state.message.content.text)}>\n            <SimpleSnippet\n              {...this.state.message}\n              richText={<RichText text={this.state.message.content.text}\n                                  links={this.state.message.content.links}\n                                  sendClick={this.sendClick} />}\n              UISurface=\"NEWTAB_FOOTER_BAR\"\n              getNextMessage={ASRouterUtils.getNextMessage}\n              onBlock={this.onBlockById(this.state.message.id)}\n              sendUserActionTelemetry={this.sendUserActionTelemetry} />\n          </LocalizationProvider>\n      </ImpressionsWrapper>);\n  }\n\n  renderOnboarding() {\n    return (\n      <OnboardingMessage\n        {...this.state.bundle}\n        UISurface=\"NEWTAB_OVERLAY\"\n        onAction={ASRouterUtils.executeAction}\n        onDoneButton={this.clearBundle(this.state.bundle.bundle)}\n        getNextMessage={ASRouterUtils.getNextMessage}\n        sendUserActionTelemetry={this.sendUserActionTelemetry} />);\n  }\n\n  render() {\n    const {message, bundle} = this.state;\n    if (!message.id && !bundle.template) { return null; }\n    if (bundle.template === \"onboarding\") { return this.renderOnboarding(); }\n    return this.renderSnippets();\n  }\n}\n\nASRouterUISurface.defaultProps = {document: global.document};\n\nexport class ASRouterContent {\n  constructor() {\n    this.initialized = false;\n    this.containerElement = null;\n  }\n\n  _mount() {\n    this.containerElement = global.document.getElementById(\"snippets-container\");\n    ReactDOM.render(<ASRouterUISurface />, this.containerElement);\n  }\n\n  _unmount() {\n    ReactDOM.unmountComponentAtNode(this.containerElement);\n  }\n\n  init() {\n    this._mount();\n    this.initialized = true;\n  }\n\n  uninit() {\n    if (this.initialized) {\n      this._unmount();\n      this.initialized = false;\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/asrouter/asrouter-content.jsx","module.exports = PropTypes;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"PropTypes\"\n// module id = 9\n// module chunks = 0","/*  eslint no-magic-numbers: [0]  */\n\nconst MAX_PLACEABLES = 100;\n\nconst entryIdentifierRe = /-?[a-zA-Z][a-zA-Z0-9_-]*/y;\nconst identifierRe = /[a-zA-Z][a-zA-Z0-9_-]*/y;\nconst functionIdentifierRe = /^[A-Z][A-Z_?-]*$/;\n\n/**\n * The `Parser` class is responsible for parsing FTL resources.\n *\n * It's only public method is `getResource(source)` which takes an FTL string\n * and returns a two element Array with an Object of entries generated from the\n * source as the first element and an array of SyntaxError objects as the\n * second.\n *\n * This parser is optimized for runtime performance.\n *\n * There is an equivalent of this parser in syntax/parser which is\n * generating full AST which is useful for FTL tools.\n */\nclass RuntimeParser {\n  /**\n   * Parse FTL code into entries formattable by the MessageContext.\n   *\n   * Given a string of FTL syntax, return a map of entries that can be passed\n   * to MessageContext.format and a list of errors encountered during parsing.\n   *\n   * @param {String} string\n   * @returns {Array<Object, Array>}\n   */\n  getResource(string) {\n    this._source = string;\n    this._index = 0;\n    this._length = string.length;\n    this.entries = {};\n\n    const errors = [];\n\n    this.skipWS();\n    while (this._index < this._length) {\n      try {\n        this.getEntry();\n      } catch (e) {\n        if (e instanceof SyntaxError) {\n          errors.push(e);\n\n          this.skipToNextEntryStart();\n        } else {\n          throw e;\n        }\n      }\n      this.skipWS();\n    }\n\n    return [this.entries, errors];\n  }\n\n  /**\n   * Parse the source string from the current index as an FTL entry\n   * and add it to object's entries property.\n   *\n   * @private\n   */\n  getEntry() {\n    // The index here should either be at the beginning of the file\n    // or right after new line.\n    if (this._index !== 0 &&\n        this._source[this._index - 1] !== \"\\n\") {\n      throw this.error(`Expected an entry to start\n        at the beginning of the file or on a new line.`);\n    }\n\n    const ch = this._source[this._index];\n\n    // We don't care about comments or sections at runtime\n    if (ch === \"/\" ||\n      (ch === \"#\" &&\n        [\" \", \"#\", \"\\n\"].includes(this._source[this._index + 1]))) {\n      this.skipComment();\n      return;\n    }\n\n    if (ch === \"[\") {\n      this.skipSection();\n      return;\n    }\n\n    this.getMessage();\n  }\n\n  /**\n   * Skip the section entry from the current index.\n   *\n   * @private\n   */\n  skipSection() {\n    this._index += 1;\n    if (this._source[this._index] !== \"[\") {\n      throw this.error('Expected \"[[\" to open a section');\n    }\n\n    this._index += 1;\n\n    this.skipInlineWS();\n    this.getVariantName();\n    this.skipInlineWS();\n\n    if (this._source[this._index] !== \"]\" ||\n        this._source[this._index + 1] !== \"]\") {\n      throw this.error('Expected \"]]\" to close a section');\n    }\n\n    this._index += 2;\n  }\n\n  /**\n   * Parse the source string from the current index as an FTL message\n   * and add it to the entries property on the Parser.\n   *\n   * @private\n   */\n  getMessage() {\n    const id = this.getEntryIdentifier();\n\n    this.skipInlineWS();\n\n    if (this._source[this._index] === \"=\") {\n      this._index++;\n    }\n\n    this.skipInlineWS();\n\n    const val = this.getPattern();\n\n    if (id.startsWith(\"-\") && val === null) {\n      throw this.error(\"Expected term to have a value\");\n    }\n\n    let attrs = null;\n\n    if (this._source[this._index] === \" \") {\n      const lineStart = this._index;\n      this.skipInlineWS();\n\n      if (this._source[this._index] === \".\") {\n        this._index = lineStart;\n        attrs = this.getAttributes();\n      }\n    }\n\n    if (attrs === null && typeof val === \"string\") {\n      this.entries[id] = val;\n    } else {\n      if (val === null && attrs === null) {\n        throw this.error(\"Expected message to have a value or attributes\");\n      }\n\n      this.entries[id] = {};\n\n      if (val !== null) {\n        this.entries[id].val = val;\n      }\n\n      if (attrs !== null) {\n        this.entries[id].attrs = attrs;\n      }\n    }\n  }\n\n  /**\n   * Skip whitespace.\n   *\n   * @private\n   */\n  skipWS() {\n    let ch = this._source[this._index];\n    while (ch === \" \" || ch === \"\\n\" || ch === \"\\t\" || ch === \"\\r\") {\n      ch = this._source[++this._index];\n    }\n  }\n\n  /**\n   * Skip inline whitespace (space and \\t).\n   *\n   * @private\n   */\n  skipInlineWS() {\n    let ch = this._source[this._index];\n    while (ch === \" \" || ch === \"\\t\") {\n      ch = this._source[++this._index];\n    }\n  }\n\n  /**\n   * Skip blank lines.\n   *\n   * @private\n   */\n  skipBlankLines() {\n    while (true) {\n      const ptr = this._index;\n\n      this.skipInlineWS();\n\n      if (this._source[this._index] === \"\\n\") {\n        this._index += 1;\n      } else {\n        this._index = ptr;\n        break;\n      }\n    }\n  }\n\n  /**\n   * Get identifier using the provided regex.\n   *\n   * By default this will get identifiers of public messages, attributes and\n   * external arguments (without the $).\n   *\n   * @returns {String}\n   * @private\n   */\n  getIdentifier(re = identifierRe) {\n    re.lastIndex = this._index;\n    const result = re.exec(this._source);\n\n    if (result === null) {\n      this._index += 1;\n      throw this.error(`Expected an identifier [${re.toString()}]`);\n    }\n\n    this._index = re.lastIndex;\n    return result[0];\n  }\n\n  /**\n   * Get identifier of a Message or a Term (staring with a dash).\n   *\n   * @returns {String}\n   * @private\n   */\n  getEntryIdentifier() {\n    return this.getIdentifier(entryIdentifierRe);\n  }\n\n  /**\n   * Get Variant name.\n   *\n   * @returns {Object}\n   * @private\n   */\n  getVariantName() {\n    let name = \"\";\n\n    const start = this._index;\n    let cc = this._source.charCodeAt(this._index);\n\n    if ((cc >= 97 && cc <= 122) || // a-z\n        (cc >= 65 && cc <= 90) || // A-Z\n        cc === 95 || cc === 32) { // _ <space>\n      cc = this._source.charCodeAt(++this._index);\n    } else {\n      throw this.error(\"Expected a keyword (starting with [a-zA-Z_])\");\n    }\n\n    while ((cc >= 97 && cc <= 122) || // a-z\n           (cc >= 65 && cc <= 90) || // A-Z\n           (cc >= 48 && cc <= 57) || // 0-9\n           cc === 95 || cc === 45 || cc === 32) { // _- <space>\n      cc = this._source.charCodeAt(++this._index);\n    }\n\n    // If we encountered the end of name, we want to test if the last\n    // collected character is a space.\n    // If it is, we will backtrack to the last non-space character because\n    // the keyword cannot end with a space character.\n    while (this._source.charCodeAt(this._index - 1) === 32) {\n      this._index--;\n    }\n\n    name += this._source.slice(start, this._index);\n\n    return { type: \"varname\", name };\n  }\n\n  /**\n   * Get simple string argument enclosed in `\"`.\n   *\n   * @returns {String}\n   * @private\n   */\n  getString() {\n    const start = this._index + 1;\n\n    while (++this._index < this._length) {\n      const ch = this._source[this._index];\n\n      if (ch === '\"') {\n        break;\n      }\n\n      if (ch === \"\\n\") {\n        throw this.error(\"Unterminated string expression\");\n      }\n    }\n\n    return this._source.substring(start, this._index++);\n  }\n\n  /**\n   * Parses a Message pattern.\n   * Message Pattern may be a simple string or an array of strings\n   * and placeable expressions.\n   *\n   * @returns {String|Array}\n   * @private\n   */\n  getPattern() {\n    // We're going to first try to see if the pattern is simple.\n    // If it is we can just look for the end of the line and read the string.\n    //\n    // Then, if either the line contains a placeable opening `{` or the\n    // next line starts an indentation, we switch to complex pattern.\n    const start = this._index;\n    let eol = this._source.indexOf(\"\\n\", this._index);\n\n    if (eol === -1) {\n      eol = this._length;\n    }\n\n    const firstLineContent = start !== eol ?\n      this._source.slice(start, eol) : null;\n\n    if (firstLineContent && firstLineContent.includes(\"{\")) {\n      return this.getComplexPattern();\n    }\n\n    this._index = eol + 1;\n\n    this.skipBlankLines();\n\n    if (this._source[this._index] !== \" \") {\n      // No indentation means we're done with this message. Callers should check\n      // if the return value here is null. It may be OK for messages, but not OK\n      // for terms, attributes and variants.\n      return firstLineContent;\n    }\n\n    const lineStart = this._index;\n\n    this.skipInlineWS();\n\n    if (this._source[this._index] === \".\") {\n      // The pattern is followed by an attribute. Rewind _index to the first\n      // column of the current line as expected by getAttributes.\n      this._index = lineStart;\n      return firstLineContent;\n    }\n\n    if (firstLineContent) {\n      // It's a multiline pattern which started on the same line as the\n      // identifier. Reparse the whole pattern to make sure we get all of it.\n      this._index = start;\n    }\n\n    return this.getComplexPattern();\n  }\n\n  /**\n   * Parses a complex Message pattern.\n   * This function is called by getPattern when the message is multiline,\n   * or contains escape chars or placeables.\n   * It does full parsing of complex patterns.\n   *\n   * @returns {Array}\n   * @private\n   */\n  /* eslint-disable complexity */\n  getComplexPattern() {\n    let buffer = \"\";\n    const content = [];\n    let placeables = 0;\n\n    let ch = this._source[this._index];\n\n    while (this._index < this._length) {\n      // This block handles multi-line strings combining strings separated\n      // by new line.\n      if (ch === \"\\n\") {\n        this._index++;\n\n        // We want to capture the start and end pointers\n        // around blank lines and add them to the buffer\n        // but only if the blank lines are in the middle\n        // of the string.\n        const blankLinesStart = this._index;\n        this.skipBlankLines();\n        const blankLinesEnd = this._index;\n\n\n        if (this._source[this._index] !== \" \") {\n          break;\n        }\n        this.skipInlineWS();\n\n        if (this._source[this._index] === \"}\" ||\n            this._source[this._index] === \"[\" ||\n            this._source[this._index] === \"*\" ||\n            this._source[this._index] === \".\") {\n          this._index = blankLinesEnd;\n          break;\n        }\n\n        buffer += this._source.substring(blankLinesStart, blankLinesEnd);\n\n        if (buffer.length || content.length) {\n          buffer += \"\\n\";\n        }\n        ch = this._source[this._index];\n        continue;\n      } else if (ch === \"\\\\\") {\n        const ch2 = this._source[this._index + 1];\n        if (ch2 === '\"' || ch2 === \"{\" || ch2 === \"\\\\\") {\n          ch = ch2;\n          this._index++;\n        }\n      } else if (ch === \"{\") {\n        // Push the buffer to content array right before placeable\n        if (buffer.length) {\n          content.push(buffer);\n        }\n        if (placeables > MAX_PLACEABLES - 1) {\n          throw this.error(\n            `Too many placeables, maximum allowed is ${MAX_PLACEABLES}`);\n        }\n        buffer = \"\";\n        content.push(this.getPlaceable());\n\n        this._index++;\n\n        ch = this._source[this._index];\n        placeables++;\n        continue;\n      }\n\n      if (ch) {\n        buffer += ch;\n      }\n      this._index++;\n      ch = this._source[this._index];\n    }\n\n    if (content.length === 0) {\n      return buffer.length ? buffer : null;\n    }\n\n    if (buffer.length) {\n      content.push(buffer);\n    }\n\n    return content;\n  }\n  /* eslint-enable complexity */\n\n  /**\n   * Parses a single placeable in a Message pattern and returns its\n   * expression.\n   *\n   * @returns {Object}\n   * @private\n   */\n  getPlaceable() {\n    const start = ++this._index;\n\n    this.skipWS();\n\n    if (this._source[this._index] === \"*\" ||\n       (this._source[this._index] === \"[\" &&\n        this._source[this._index + 1] !== \"]\")) {\n      const variants = this.getVariants();\n\n      return {\n        type: \"sel\",\n        exp: null,\n        vars: variants[0],\n        def: variants[1]\n      };\n    }\n\n    // Rewind the index and only support in-line white-space now.\n    this._index = start;\n    this.skipInlineWS();\n\n    const selector = this.getSelectorExpression();\n\n    this.skipWS();\n\n    const ch = this._source[this._index];\n\n    if (ch === \"}\") {\n      if (selector.type === \"attr\" && selector.id.name.startsWith(\"-\")) {\n        throw this.error(\n          \"Attributes of private messages cannot be interpolated.\"\n        );\n      }\n\n      return selector;\n    }\n\n    if (ch !== \"-\" || this._source[this._index + 1] !== \">\") {\n      throw this.error('Expected \"}\" or \"->\"');\n    }\n\n    if (selector.type === \"ref\") {\n      throw this.error(\"Message references cannot be used as selectors.\");\n    }\n\n    if (selector.type === \"var\") {\n      throw this.error(\"Variants cannot be used as selectors.\");\n    }\n\n    if (selector.type === \"attr\" && !selector.id.name.startsWith(\"-\")) {\n      throw this.error(\n        \"Attributes of public messages cannot be used as selectors.\"\n      );\n    }\n\n\n    this._index += 2; // ->\n\n    this.skipInlineWS();\n\n    if (this._source[this._index] !== \"\\n\") {\n      throw this.error(\"Variants should be listed in a new line\");\n    }\n\n    this.skipWS();\n\n    const variants = this.getVariants();\n\n    if (variants[0].length === 0) {\n      throw this.error(\"Expected members for the select expression\");\n    }\n\n    return {\n      type: \"sel\",\n      exp: selector,\n      vars: variants[0],\n      def: variants[1]\n    };\n  }\n\n  /**\n   * Parses a selector expression.\n   *\n   * @returns {Object}\n   * @private\n   */\n  getSelectorExpression() {\n    const literal = this.getLiteral();\n\n    if (literal.type !== \"ref\") {\n      return literal;\n    }\n\n    if (this._source[this._index] === \".\") {\n      this._index++;\n\n      const name = this.getIdentifier();\n      this._index++;\n      return {\n        type: \"attr\",\n        id: literal,\n        name\n      };\n    }\n\n    if (this._source[this._index] === \"[\") {\n      this._index++;\n\n      const key = this.getVariantKey();\n      this._index++;\n      return {\n        type: \"var\",\n        id: literal,\n        key\n      };\n    }\n\n    if (this._source[this._index] === \"(\") {\n      this._index++;\n      const args = this.getCallArgs();\n\n      if (!functionIdentifierRe.test(literal.name)) {\n        throw this.error(\"Function names must be all upper-case\");\n      }\n\n      this._index++;\n\n      literal.type = \"fun\";\n\n      return {\n        type: \"call\",\n        fun: literal,\n        args\n      };\n    }\n\n    return literal;\n  }\n\n  /**\n   * Parses call arguments for a CallExpression.\n   *\n   * @returns {Array}\n   * @private\n   */\n  getCallArgs() {\n    const args = [];\n\n    while (this._index < this._length) {\n      this.skipInlineWS();\n\n      if (this._source[this._index] === \")\") {\n        return args;\n      }\n\n      const exp = this.getSelectorExpression();\n\n      // MessageReference in this place may be an entity reference, like:\n      // `call(foo)`, or, if it's followed by `:` it will be a key-value pair.\n      if (exp.type !== \"ref\") {\n        args.push(exp);\n      } else {\n        this.skipInlineWS();\n\n        if (this._source[this._index] === \":\") {\n          this._index++;\n          this.skipInlineWS();\n\n          const val = this.getSelectorExpression();\n\n          // If the expression returned as a value of the argument\n          // is not a quote delimited string or number, throw.\n          //\n          // We don't have to check here if the pattern is quote delimited\n          // because that's the only type of string allowed in expressions.\n          if (typeof val === \"string\" ||\n              Array.isArray(val) ||\n              val.type === \"num\") {\n            args.push({\n              type: \"narg\",\n              name: exp.name,\n              val\n            });\n          } else {\n            this._index = this._source.lastIndexOf(\":\", this._index) + 1;\n            throw this.error(\n              \"Expected string in quotes, number.\");\n          }\n\n        } else {\n          args.push(exp);\n        }\n      }\n\n      this.skipInlineWS();\n\n      if (this._source[this._index] === \")\") {\n        break;\n      } else if (this._source[this._index] === \",\") {\n        this._index++;\n      } else {\n        throw this.error('Expected \",\" or \")\"');\n      }\n    }\n\n    return args;\n  }\n\n  /**\n   * Parses an FTL Number.\n   *\n   * @returns {Object}\n   * @private\n   */\n  getNumber() {\n    let num = \"\";\n    let cc = this._source.charCodeAt(this._index);\n\n    // The number literal may start with negative sign `-`.\n    if (cc === 45) {\n      num += \"-\";\n      cc = this._source.charCodeAt(++this._index);\n    }\n\n    // next, we expect at least one digit\n    if (cc < 48 || cc > 57) {\n      throw this.error(`Unknown literal \"${num}\"`);\n    }\n\n    // followed by potentially more digits\n    while (cc >= 48 && cc <= 57) {\n      num += this._source[this._index++];\n      cc = this._source.charCodeAt(this._index);\n    }\n\n    // followed by an optional decimal separator `.`\n    if (cc === 46) {\n      num += this._source[this._index++];\n      cc = this._source.charCodeAt(this._index);\n\n      // followed by at least one digit\n      if (cc < 48 || cc > 57) {\n        throw this.error(`Unknown literal \"${num}\"`);\n      }\n\n      // and optionally more digits\n      while (cc >= 48 && cc <= 57) {\n        num += this._source[this._index++];\n        cc = this._source.charCodeAt(this._index);\n      }\n    }\n\n    return {\n      type: \"num\",\n      val: num\n    };\n  }\n\n  /**\n   * Parses a list of Message attributes.\n   *\n   * @returns {Object}\n   * @private\n   */\n  getAttributes() {\n    const attrs = {};\n\n    while (this._index < this._length) {\n      if (this._source[this._index] !== \" \") {\n        break;\n      }\n      this.skipInlineWS();\n\n      if (this._source[this._index] !== \".\") {\n        break;\n      }\n      this._index++;\n\n      const key = this.getIdentifier();\n\n      this.skipInlineWS();\n\n      if (this._source[this._index] !== \"=\") {\n        throw this.error('Expected \"=\"');\n      }\n      this._index++;\n\n      this.skipInlineWS();\n\n      const val = this.getPattern();\n\n      if (val === null) {\n        throw this.error(\"Expected attribute to have a value\");\n      }\n\n      if (typeof val === \"string\") {\n        attrs[key] = val;\n      } else {\n        attrs[key] = {\n          val\n        };\n      }\n\n      this.skipBlankLines();\n    }\n\n    return attrs;\n  }\n\n  /**\n   * Parses a list of Selector variants.\n   *\n   * @returns {Array}\n   * @private\n   */\n  getVariants() {\n    const variants = [];\n    let index = 0;\n    let defaultIndex;\n\n    while (this._index < this._length) {\n      const ch = this._source[this._index];\n\n      if ((ch !== \"[\" || this._source[this._index + 1] === \"[\") &&\n          ch !== \"*\") {\n        break;\n      }\n      if (ch === \"*\") {\n        this._index++;\n        defaultIndex = index;\n      }\n\n      if (this._source[this._index] !== \"[\") {\n        throw this.error('Expected \"[\"');\n      }\n\n      this._index++;\n\n      const key = this.getVariantKey();\n\n      this.skipInlineWS();\n\n      const val = this.getPattern();\n\n      if (val === null) {\n        throw this.error(\"Expected variant to have a value\");\n      }\n\n      variants[index++] = {key, val};\n\n      this.skipWS();\n    }\n\n    return [variants, defaultIndex];\n  }\n\n  /**\n   * Parses a Variant key.\n   *\n   * @returns {String}\n   * @private\n   */\n  getVariantKey() {\n    // VariantKey may be a Keyword or Number\n\n    const cc = this._source.charCodeAt(this._index);\n    let literal;\n\n    if ((cc >= 48 && cc <= 57) || cc === 45) {\n      literal = this.getNumber();\n    } else {\n      literal = this.getVariantName();\n    }\n\n    if (this._source[this._index] !== \"]\") {\n      throw this.error('Expected \"]\"');\n    }\n\n    this._index++;\n    return literal;\n  }\n\n  /**\n   * Parses an FTL literal.\n   *\n   * @returns {Object}\n   * @private\n   */\n  getLiteral() {\n    const cc0 = this._source.charCodeAt(this._index);\n\n    if (cc0 === 36) { // $\n      this._index++;\n      return {\n        type: \"ext\",\n        name: this.getIdentifier()\n      };\n    }\n\n    const cc1 = cc0 === 45 // -\n      // Peek at the next character after the dash.\n      ? this._source.charCodeAt(this._index + 1)\n      // Or keep using the character at the current index.\n      : cc0;\n\n    if ((cc1 >= 97 && cc1 <= 122) || // a-z\n        (cc1 >= 65 && cc1 <= 90)) { // A-Z\n      return {\n        type: \"ref\",\n        name: this.getEntryIdentifier()\n      };\n    }\n\n    if ((cc1 >= 48 && cc1 <= 57)) { // 0-9\n      return this.getNumber();\n    }\n\n    if (cc0 === 34) { // \"\n      return this.getString();\n    }\n\n    throw this.error(\"Expected literal\");\n  }\n\n  /**\n   * Skips an FTL comment.\n   *\n   * @private\n   */\n  skipComment() {\n    // At runtime, we don't care about comments so we just have\n    // to parse them properly and skip their content.\n    let eol = this._source.indexOf(\"\\n\", this._index);\n\n    while (eol !== -1 &&\n      ((this._source[eol + 1] === \"/\" && this._source[eol + 2] === \"/\") ||\n       (this._source[eol + 1] === \"#\" &&\n         [\" \", \"#\"].includes(this._source[eol + 2])))) {\n      this._index = eol + 3;\n\n      eol = this._source.indexOf(\"\\n\", this._index);\n\n      if (eol === -1) {\n        break;\n      }\n    }\n\n    if (eol === -1) {\n      this._index = this._length;\n    } else {\n      this._index = eol + 1;\n    }\n  }\n\n  /**\n   * Creates a new SyntaxError object with a given message.\n   *\n   * @param {String} message\n   * @returns {Object}\n   * @private\n   */\n  error(message) {\n    return new SyntaxError(message);\n  }\n\n  /**\n   * Skips to the beginning of a next entry after the current position.\n   * This is used to mark the boundary of junk entry in case of error,\n   * and recover from the returned position.\n   *\n   * @private\n   */\n  skipToNextEntryStart() {\n    let start = this._index;\n\n    while (true) {\n      if (start === 0 || this._source[start - 1] === \"\\n\") {\n        const cc = this._source.charCodeAt(start);\n\n        if ((cc >= 97 && cc <= 122) || // a-z\n            (cc >= 65 && cc <= 90) || // A-Z\n             cc === 47 || cc === 91) { // /[\n          this._index = start;\n          return;\n        }\n      }\n\n      start = this._source.indexOf(\"\\n\", start);\n\n      if (start === -1) {\n        this._index = this._length;\n        return;\n      }\n      start++;\n    }\n  }\n}\n\n/**\n * Parses an FTL string using RuntimeParser and returns the generated\n * object with entries and a list of errors.\n *\n * @param {String} string\n * @returns {Array<Object, Array>}\n */\nexport default function parse(string) {\n  const parser = new RuntimeParser();\n  return parser.getResource(string);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent/src/parser.js","/* global Intl */\n\n/**\n * The `FluentType` class is the base of Fluent's type system.\n *\n * Fluent types wrap JavaScript values and store additional configuration for\n * them, which can then be used in the `toString` method together with a proper\n * `Intl` formatter.\n */\nexport class FluentType {\n\n  /**\n   * Create an `FluentType` instance.\n   *\n   * @param   {Any}    value - JavaScript value to wrap.\n   * @param   {Object} opts  - Configuration.\n   * @returns {FluentType}\n   */\n  constructor(value, opts) {\n    this.value = value;\n    this.opts = opts;\n  }\n\n  /**\n   * Unwrap the raw value stored by this `FluentType`.\n   *\n   * @returns {Any}\n   */\n  valueOf() {\n    return this.value;\n  }\n\n  /**\n   * Format this instance of `FluentType` to a string.\n   *\n   * Formatted values are suitable for use outside of the `MessageContext`.\n   * This method can use `Intl` formatters memoized by the `MessageContext`\n   * instance passed as an argument.\n   *\n   * @param   {MessageContext} [ctx]\n   * @returns {string}\n   */\n  toString() {\n    throw new Error(\"Subclasses of FluentType must implement toString.\");\n  }\n}\n\nexport class FluentNone extends FluentType {\n  toString() {\n    return this.value || \"???\";\n  }\n}\n\nexport class FluentNumber extends FluentType {\n  constructor(value, opts) {\n    super(parseFloat(value), opts);\n  }\n\n  toString(ctx) {\n    try {\n      const nf = ctx._memoizeIntlObject(\n        Intl.NumberFormat, this.opts\n      );\n      return nf.format(this.value);\n    } catch (e) {\n      // XXX Report the error.\n      return this.value;\n    }\n  }\n\n  /**\n   * Compare the object with another instance of a FluentType.\n   *\n   * @param   {MessageContext} ctx\n   * @param   {FluentType}     other\n   * @returns {bool}\n   */\n  match(ctx, other) {\n    if (other instanceof FluentNumber) {\n      return this.value === other.value;\n    }\n    return false;\n  }\n}\n\nexport class FluentDateTime extends FluentType {\n  constructor(value, opts) {\n    super(new Date(value), opts);\n  }\n\n  toString(ctx) {\n    try {\n      const dtf = ctx._memoizeIntlObject(\n        Intl.DateTimeFormat, this.opts\n      );\n      return dtf.format(this.value);\n    } catch (e) {\n      // XXX Report the error.\n      return this.value;\n    }\n  }\n}\n\nexport class FluentSymbol extends FluentType {\n  toString() {\n    return this.value;\n  }\n\n  /**\n   * Compare the object with another instance of a FluentType.\n   *\n   * @param   {MessageContext} ctx\n   * @param   {FluentType}     other\n   * @returns {bool}\n   */\n  match(ctx, other) {\n    if (other instanceof FluentSymbol) {\n      return this.value === other.value;\n    } else if (typeof other === \"string\") {\n      return this.value === other;\n    } else if (other instanceof FluentNumber) {\n      const pr = ctx._memoizeIntlObject(\n        Intl.PluralRules, other.opts\n      );\n      return this.value === pr.select(other.value);\n    }\n    return false;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent/src/types.js","/**\n * @overview\n *\n * The FTL resolver ships with a number of functions built-in.\n *\n * Each function take two arguments:\n *   - args - an array of positional args\n *   - opts - an object of key-value args\n *\n * Arguments to functions are guaranteed to already be instances of\n * `FluentType`.  Functions must return `FluentType` objects as well.\n */\n\nimport { FluentNumber, FluentDateTime } from \"./types\";\n\nexport default {\n  \"NUMBER\": ([arg], opts) =>\n    new FluentNumber(arg.valueOf(), merge(arg.opts, opts)),\n  \"DATETIME\": ([arg], opts) =>\n    new FluentDateTime(arg.valueOf(), merge(arg.opts, opts)),\n};\n\nfunction merge(argopts, opts) {\n  return Object.assign({}, argopts, values(opts));\n}\n\nfunction values(opts) {\n  const unwrapped = {};\n  for (const [name, opt] of Object.entries(opts)) {\n    unwrapped[name] = opt.valueOf();\n  }\n  return unwrapped;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent/src/builtins.js","/**\n * @overview\n *\n * The role of the Fluent resolver is to format a translation object to an\n * instance of `FluentType` or an array of instances.\n *\n * Translations can contain references to other messages or external arguments,\n * conditional logic in form of select expressions, traits which describe their\n * grammatical features, and can use Fluent builtins which make use of the\n * `Intl` formatters to format numbers, dates, lists and more into the\n * context's language.  See the documentation of the Fluent syntax for more\n * information.\n *\n * In case of errors the resolver will try to salvage as much of the\n * translation as possible.  In rare situations where the resolver didn't know\n * how to recover from an error it will return an instance of `FluentNone`.\n *\n * `MessageReference`, `VariantExpression`, `AttributeExpression` and\n * `SelectExpression` resolve to raw Runtime Entries objects and the result of\n * the resolution needs to be passed into `Type` to get their real value.\n * This is useful for composing expressions.  Consider:\n *\n *     brand-name[nominative]\n *\n * which is a `VariantExpression` with properties `id: MessageReference` and\n * `key: Keyword`.  If `MessageReference` was resolved eagerly, it would\n * instantly resolve to the value of the `brand-name` message.  Instead, we\n * want to get the message object and look for its `nominative` variant.\n *\n * All other expressions (except for `FunctionReference` which is only used in\n * `CallExpression`) resolve to an instance of `FluentType`.  The caller should\n * use the `toString` method to convert the instance to a native value.\n *\n *\n * All functions in this file pass around a special object called `env`.\n * This object stores a set of elements used by all resolve functions:\n *\n *  * {MessageContext} ctx\n *      context for which the given resolution is happening\n *  * {Object} args\n *      list of developer provided arguments that can be used\n *  * {Array} errors\n *      list of errors collected while resolving\n *  * {WeakSet} dirty\n *      Set of patterns already encountered during this resolution.\n *      This is used to prevent cyclic resolutions.\n */\n\n\nimport { FluentType, FluentNone, FluentNumber, FluentDateTime, FluentSymbol }\n  from \"./types\";\nimport builtins from \"./builtins\";\n\n// Prevent expansion of too long placeables.\nconst MAX_PLACEABLE_LENGTH = 2500;\n\n// Unicode bidi isolation characters.\nconst FSI = \"\\u2068\";\nconst PDI = \"\\u2069\";\n\n\n/**\n * Helper for choosing the default value from a set of members.\n *\n * Used in SelectExpressions and Type.\n *\n * @param   {Object} env\n *    Resolver environment object.\n * @param   {Object} members\n *    Hash map of variants from which the default value is to be selected.\n * @param   {Number} def\n *    The index of the default variant.\n * @returns {FluentType}\n * @private\n */\nfunction DefaultMember(env, members, def) {\n  if (members[def]) {\n    return members[def];\n  }\n\n  const { errors } = env;\n  errors.push(new RangeError(\"No default\"));\n  return new FluentNone();\n}\n\n\n/**\n * Resolve a reference to another message.\n *\n * @param   {Object} env\n *    Resolver environment object.\n * @param   {Object} id\n *    The identifier of the message to be resolved.\n * @param   {String} id.name\n *    The name of the identifier.\n * @returns {FluentType}\n * @private\n */\nfunction MessageReference(env, {name}) {\n  const { ctx, errors } = env;\n  const message = name.startsWith(\"-\")\n    ? ctx._terms.get(name)\n    : ctx._messages.get(name);\n\n  if (!message) {\n    const err = name.startsWith(\"-\")\n      ? new ReferenceError(`Unknown term: ${name}`)\n      : new ReferenceError(`Unknown message: ${name}`);\n    errors.push(err);\n    return new FluentNone(name);\n  }\n\n  return message;\n}\n\n/**\n * Resolve a variant expression to the variant object.\n *\n * @param   {Object} env\n *    Resolver environment object.\n * @param   {Object} expr\n *    An expression to be resolved.\n * @param   {Object} expr.id\n *    An Identifier of a message for which the variant is resolved.\n * @param   {Object} expr.id.name\n *    Name a message for which the variant is resolved.\n * @param   {Object} expr.key\n *    Variant key to be resolved.\n * @returns {FluentType}\n * @private\n */\nfunction VariantExpression(env, {id, key}) {\n  const message = MessageReference(env, id);\n  if (message instanceof FluentNone) {\n    return message;\n  }\n\n  const { ctx, errors } = env;\n  const keyword = Type(env, key);\n\n  function isVariantList(node) {\n    return Array.isArray(node) &&\n      node[0].type === \"sel\" &&\n      node[0].exp === null;\n  }\n\n  if (isVariantList(message.val)) {\n    // Match the specified key against keys of each variant, in order.\n    for (const variant of message.val[0].vars) {\n      const variantKey = Type(env, variant.key);\n      if (keyword.match(ctx, variantKey)) {\n        return variant;\n      }\n    }\n  }\n\n  errors.push(new ReferenceError(`Unknown variant: ${keyword.toString(ctx)}`));\n  return Type(env, message);\n}\n\n\n/**\n * Resolve an attribute expression to the attribute object.\n *\n * @param   {Object} env\n *    Resolver environment object.\n * @param   {Object} expr\n *    An expression to be resolved.\n * @param   {String} expr.id\n *    An ID of a message for which the attribute is resolved.\n * @param   {String} expr.name\n *    Name of the attribute to be resolved.\n * @returns {FluentType}\n * @private\n */\nfunction AttributeExpression(env, {id, name}) {\n  const message = MessageReference(env, id);\n  if (message instanceof FluentNone) {\n    return message;\n  }\n\n  if (message.attrs) {\n    // Match the specified name against keys of each attribute.\n    for (const attrName in message.attrs) {\n      if (name === attrName) {\n        return message.attrs[name];\n      }\n    }\n  }\n\n  const { errors } = env;\n  errors.push(new ReferenceError(`Unknown attribute: ${name}`));\n  return Type(env, message);\n}\n\n/**\n * Resolve a select expression to the member object.\n *\n * @param   {Object} env\n *    Resolver environment object.\n * @param   {Object} expr\n *    An expression to be resolved.\n * @param   {String} expr.exp\n *    Selector expression\n * @param   {Array} expr.vars\n *    List of variants for the select expression.\n * @param   {Number} expr.def\n *    Index of the default variant.\n * @returns {FluentType}\n * @private\n */\nfunction SelectExpression(env, {exp, vars, def}) {\n  if (exp === null) {\n    return DefaultMember(env, vars, def);\n  }\n\n  const selector = Type(env, exp);\n  if (selector instanceof FluentNone) {\n    return DefaultMember(env, vars, def);\n  }\n\n  // Match the selector against keys of each variant, in order.\n  for (const variant of vars) {\n    const key = Type(env, variant.key);\n    const keyCanMatch =\n      key instanceof FluentNumber || key instanceof FluentSymbol;\n\n    if (!keyCanMatch) {\n      continue;\n    }\n\n    const { ctx } = env;\n\n    if (key.match(ctx, selector)) {\n      return variant;\n    }\n  }\n\n  return DefaultMember(env, vars, def);\n}\n\n\n/**\n * Resolve expression to a Fluent type.\n *\n * JavaScript strings are a special case.  Since they natively have the\n * `toString` method they can be used as if they were a Fluent type without\n * paying the cost of creating a instance of one.\n *\n * @param   {Object} env\n *    Resolver environment object.\n * @param   {Object} expr\n *    An expression object to be resolved into a Fluent type.\n * @returns {FluentType}\n * @private\n */\nfunction Type(env, expr) {\n  // A fast-path for strings which are the most common case, and for\n  // `FluentNone` which doesn't require any additional logic.\n  if (typeof expr === \"string\" || expr instanceof FluentNone) {\n    return expr;\n  }\n\n  // The Runtime AST (Entries) encodes patterns (complex strings with\n  // placeables) as Arrays.\n  if (Array.isArray(expr)) {\n    return Pattern(env, expr);\n  }\n\n\n  switch (expr.type) {\n    case \"varname\":\n      return new FluentSymbol(expr.name);\n    case \"num\":\n      return new FluentNumber(expr.val);\n    case \"ext\":\n      return ExternalArgument(env, expr);\n    case \"fun\":\n      return FunctionReference(env, expr);\n    case \"call\":\n      return CallExpression(env, expr);\n    case \"ref\": {\n      const message = MessageReference(env, expr);\n      return Type(env, message);\n    }\n    case \"attr\": {\n      const attr = AttributeExpression(env, expr);\n      return Type(env, attr);\n    }\n    case \"var\": {\n      const variant = VariantExpression(env, expr);\n      return Type(env, variant);\n    }\n    case \"sel\": {\n      const member = SelectExpression(env, expr);\n      return Type(env, member);\n    }\n    case undefined: {\n      // If it's a node with a value, resolve the value.\n      if (expr.val !== null && expr.val !== undefined) {\n        return Type(env, expr.val);\n      }\n\n      const { errors } = env;\n      errors.push(new RangeError(\"No value\"));\n      return new FluentNone();\n    }\n    default:\n      return new FluentNone();\n  }\n}\n\n/**\n * Resolve a reference to an external argument.\n *\n * @param   {Object} env\n *    Resolver environment object.\n * @param   {Object} expr\n *    An expression to be resolved.\n * @param   {String} expr.name\n *    Name of an argument to be returned.\n * @returns {FluentType}\n * @private\n */\nfunction ExternalArgument(env, {name}) {\n  const { args, errors } = env;\n\n  if (!args || !args.hasOwnProperty(name)) {\n    errors.push(new ReferenceError(`Unknown external: ${name}`));\n    return new FluentNone(name);\n  }\n\n  const arg = args[name];\n\n  // Return early if the argument already is an instance of FluentType.\n  if (arg instanceof FluentType) {\n    return arg;\n  }\n\n  // Convert the argument to a Fluent type.\n  switch (typeof arg) {\n    case \"string\":\n      return arg;\n    case \"number\":\n      return new FluentNumber(arg);\n    case \"object\":\n      if (arg instanceof Date) {\n        return new FluentDateTime(arg);\n      }\n    default:\n      errors.push(\n        new TypeError(`Unsupported external type: ${name}, ${typeof arg}`)\n      );\n      return new FluentNone(name);\n  }\n}\n\n/**\n * Resolve a reference to a function.\n *\n * @param   {Object}  env\n *    Resolver environment object.\n * @param   {Object} expr\n *    An expression to be resolved.\n * @param   {String} expr.name\n *    Name of the function to be returned.\n * @returns {Function}\n * @private\n */\nfunction FunctionReference(env, {name}) {\n  // Some functions are built-in.  Others may be provided by the runtime via\n  // the `MessageContext` constructor.\n  const { ctx: { _functions }, errors } = env;\n  const func = _functions[name] || builtins[name];\n\n  if (!func) {\n    errors.push(new ReferenceError(`Unknown function: ${name}()`));\n    return new FluentNone(`${name}()`);\n  }\n\n  if (typeof func !== \"function\") {\n    errors.push(new TypeError(`Function ${name}() is not callable`));\n    return new FluentNone(`${name}()`);\n  }\n\n  return func;\n}\n\n/**\n * Resolve a call to a Function with positional and key-value arguments.\n *\n * @param   {Object} env\n *    Resolver environment object.\n * @param   {Object} expr\n *    An expression to be resolved.\n * @param   {Object} expr.fun\n *    FTL Function object.\n * @param   {Array} expr.args\n *    FTL Function argument list.\n * @returns {FluentType}\n * @private\n */\nfunction CallExpression(env, {fun, args}) {\n  const callee = FunctionReference(env, fun);\n\n  if (callee instanceof FluentNone) {\n    return callee;\n  }\n\n  const posargs = [];\n  const keyargs = {};\n\n  for (const arg of args) {\n    if (arg.type === \"narg\") {\n      keyargs[arg.name] = Type(env, arg.val);\n    } else {\n      posargs.push(Type(env, arg));\n    }\n  }\n\n  try {\n    return callee(posargs, keyargs);\n  } catch (e) {\n    // XXX Report errors.\n    return new FluentNone();\n  }\n}\n\n/**\n * Resolve a pattern (a complex string with placeables).\n *\n * @param   {Object} env\n *    Resolver environment object.\n * @param   {Array} ptn\n *    Array of pattern elements.\n * @returns {Array}\n * @private\n */\nfunction Pattern(env, ptn) {\n  const { ctx, dirty, errors } = env;\n\n  if (dirty.has(ptn)) {\n    errors.push(new RangeError(\"Cyclic reference\"));\n    return new FluentNone();\n  }\n\n  // Tag the pattern as dirty for the purpose of the current resolution.\n  dirty.add(ptn);\n  const result = [];\n\n  // Wrap interpolations with Directional Isolate Formatting characters\n  // only when the pattern has more than one element.\n  const useIsolating = ctx._useIsolating && ptn.length > 1;\n\n  for (const elem of ptn) {\n    if (typeof elem === \"string\") {\n      result.push(elem);\n      continue;\n    }\n\n    const part = Type(env, elem).toString(ctx);\n\n    if (useIsolating) {\n      result.push(FSI);\n    }\n\n    if (part.length > MAX_PLACEABLE_LENGTH) {\n      errors.push(\n        new RangeError(\n          \"Too many characters in placeable \" +\n          `(${part.length}, max allowed is ${MAX_PLACEABLE_LENGTH})`\n        )\n      );\n      result.push(part.slice(MAX_PLACEABLE_LENGTH));\n    } else {\n      result.push(part);\n    }\n\n    if (useIsolating) {\n      result.push(PDI);\n    }\n  }\n\n  dirty.delete(ptn);\n  return result.join(\"\");\n}\n\n/**\n * Format a translation into a string.\n *\n * @param   {MessageContext} ctx\n *    A MessageContext instance which will be used to resolve the\n *    contextual information of the message.\n * @param   {Object}         args\n *    List of arguments provided by the developer which can be accessed\n *    from the message.\n * @param   {Object}         message\n *    An object with the Message to be resolved.\n * @param   {Array}          errors\n *    An error array that any encountered errors will be appended to.\n * @returns {FluentType}\n */\nexport default function resolve(ctx, args, message, errors = []) {\n  const env = {\n    ctx, args, errors, dirty: new WeakSet()\n  };\n  return Type(env, message).toString(ctx);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent/src/resolver.js","import resolve from \"./resolver\";\nimport parse from \"./parser\";\n\n/**\n * Message contexts are single-language stores of translations.  They are\n * responsible for parsing translation resources in the Fluent syntax and can\n * format translation units (entities) to strings.\n *\n * Always use `MessageContext.format` to retrieve translation units from\n * a context.  Translations can contain references to other entities or\n * external arguments, conditional logic in form of select expressions, traits\n * which describe their grammatical features, and can use Fluent builtins which\n * make use of the `Intl` formatters to format numbers, dates, lists and more\n * into the context's language.  See the documentation of the Fluent syntax for\n * more information.\n */\nexport class MessageContext {\n\n  /**\n   * Create an instance of `MessageContext`.\n   *\n   * The `locales` argument is used to instantiate `Intl` formatters used by\n   * translations.  The `options` object can be used to configure the context.\n   *\n   * Examples:\n   *\n   *     const ctx = new MessageContext(locales);\n   *\n   *     const ctx = new MessageContext(locales, { useIsolating: false });\n   *\n   *     const ctx = new MessageContext(locales, {\n   *       useIsolating: true,\n   *       functions: {\n   *         NODE_ENV: () => process.env.NODE_ENV\n   *       }\n   *     });\n   *\n   * Available options:\n   *\n   *   - `functions` - an object of additional functions available to\n   *                   translations as builtins.\n   *\n   *   - `useIsolating` - boolean specifying whether to use Unicode isolation\n   *                    marks (FSI, PDI) for bidi interpolations.\n   *\n   * @param   {string|Array<string>} locales - Locale or locales of the context\n   * @param   {Object} [options]\n   * @returns {MessageContext}\n   */\n  constructor(locales, { functions = {}, useIsolating = true } = {}) {\n    this.locales = Array.isArray(locales) ? locales : [locales];\n\n    this._terms = new Map();\n    this._messages = new Map();\n    this._functions = functions;\n    this._useIsolating = useIsolating;\n    this._intls = new WeakMap();\n  }\n\n  /*\n   * Return an iterator over public `[id, message]` pairs.\n   *\n   * @returns {Iterator}\n   */\n  get messages() {\n    return this._messages[Symbol.iterator]();\n  }\n\n  /*\n   * Check if a message is present in the context.\n   *\n   * @param {string} id - The identifier of the message to check.\n   * @returns {bool}\n   */\n  hasMessage(id) {\n    return this._messages.has(id);\n  }\n\n  /*\n   * Return the internal representation of a message.\n   *\n   * The internal representation should only be used as an argument to\n   * `MessageContext.format`.\n   *\n   * @param {string} id - The identifier of the message to check.\n   * @returns {Any}\n   */\n  getMessage(id) {\n    return this._messages.get(id);\n  }\n\n  /**\n   * Add a translation resource to the context.\n   *\n   * The translation resource must use the Fluent syntax.  It will be parsed by\n   * the context and each translation unit (message) will be available in the\n   * context by its identifier.\n   *\n   *     ctx.addMessages('foo = Foo');\n   *     ctx.getMessage('foo');\n   *\n   *     // Returns a raw representation of the 'foo' message.\n   *\n   * Parsed entities should be formatted with the `format` method in case they\n   * contain logic (references, select expressions etc.).\n   *\n   * @param   {string} source - Text resource with translations.\n   * @returns {Array<Error>}\n   */\n  addMessages(source) {\n    const [entries, errors] = parse(source);\n    for (const id in entries) {\n      if (id.startsWith(\"-\")) {\n        // Identifiers starting with a dash (-) define terms. Terms are private\n        // and cannot be retrieved from MessageContext.\n        if (this._terms.has(id)) {\n          errors.push(`Attempt to override an existing term: \"${id}\"`);\n          continue;\n        }\n        this._terms.set(id, entries[id]);\n      } else {\n        if (this._messages.has(id)) {\n          errors.push(`Attempt to override an existing message: \"${id}\"`);\n          continue;\n        }\n        this._messages.set(id, entries[id]);\n      }\n    }\n\n    return errors;\n  }\n\n  /**\n   * Format a message to a string or null.\n   *\n   * Format a raw `message` from the context into a string (or a null if it has\n   * a null value).  `args` will be used to resolve references to external\n   * arguments inside of the translation.\n   *\n   * In case of errors `format` will try to salvage as much of the translation\n   * as possible and will still return a string.  For performance reasons, the\n   * encountered errors are not returned but instead are appended to the\n   * `errors` array passed as the third argument.\n   *\n   *     const errors = [];\n   *     ctx.addMessages('hello = Hello, { $name }!');\n   *     const hello = ctx.getMessage('hello');\n   *     ctx.format(hello, { name: 'Jane' }, errors);\n   *\n   *     // Returns 'Hello, Jane!' and `errors` is empty.\n   *\n   *     ctx.format(hello, undefined, errors);\n   *\n   *     // Returns 'Hello, name!' and `errors` is now:\n   *\n   *     [<ReferenceError: Unknown external: name>]\n   *\n   * @param   {Object | string}    message\n   * @param   {Object | undefined} args\n   * @param   {Array}              errors\n   * @returns {?string}\n   */\n  format(message, args, errors) {\n    // optimize entities which are simple strings with no attributes\n    if (typeof message === \"string\") {\n      return message;\n    }\n\n    // optimize simple-string entities with attributes\n    if (typeof message.val === \"string\") {\n      return message.val;\n    }\n\n    // optimize entities with null values\n    if (message.val === undefined) {\n      return null;\n    }\n\n    return resolve(this, args, message, errors);\n  }\n\n  _memoizeIntlObject(ctor, opts) {\n    const cache = this._intls.get(ctor) || {};\n    const id = JSON.stringify(opts);\n\n    if (!cache[id]) {\n      cache[id] = new ctor(this.locales, opts);\n      this._intls.set(ctor, cache);\n    }\n\n    return cache[id];\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent/src/context.js","/*\n * CachedIterable caches the elements yielded by an iterable.\n *\n * It can be used to iterate over an iterable many times without depleting the\n * iterable.\n */\nexport default class CachedIterable {\n  /**\n   * Create an `CachedIterable` instance.\n   *\n   * @param {Iterable} iterable\n   * @returns {CachedIterable}\n   */\n  constructor(iterable) {\n    if (Symbol.asyncIterator in Object(iterable)) {\n      this.iterator = iterable[Symbol.asyncIterator]();\n    } else if (Symbol.iterator in Object(iterable)) {\n      this.iterator = iterable[Symbol.iterator]();\n    } else {\n      throw new TypeError(\"Argument must implement the iteration protocol.\");\n    }\n\n    this.seen = [];\n  }\n\n  [Symbol.iterator]() {\n    const { seen, iterator } = this;\n    let cur = 0;\n\n    return {\n      next() {\n        if (seen.length <= cur) {\n          seen.push(iterator.next());\n        }\n        return seen[cur++];\n      }\n    };\n  }\n\n  [Symbol.asyncIterator]() {\n    const { seen, iterator } = this;\n    let cur = 0;\n\n    return {\n      async next() {\n        if (seen.length <= cur) {\n          seen.push(await iterator.next());\n        }\n        return seen[cur++];\n      }\n    };\n  }\n\n  /**\n   * This method allows user to consume the next element from the iterator\n   * into the cache.\n   */\n  touchNext() {\n    const { seen, iterator } = this;\n    if (seen.length === 0 || seen[seen.length - 1].done === false) {\n      seen.push(iterator.next());\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent/src/cached_iterable.js","/*\n * @overview\n *\n * Functions for managing ordered sequences of MessageContexts.\n *\n * An ordered iterable of MessageContext instances can represent the current\n * negotiated fallback chain of languages.  This iterable can be used to find\n * the best existing translation for a given identifier.\n *\n * The mapContext* methods can be used to find the first MessageContext in the\n * given iterable which contains the translation with the given identifier.  If\n * the iterable is ordered according to the result of a language negotiation\n * the returned MessageContext contains the best available translation.\n *\n * A simple function which formats translations based on the identifier might\n * be implemented as follows:\n *\n *     formatString(id, args) {\n *         const ctx = mapContextSync(contexts, id);\n *\n *         if (ctx === null) {\n *             return id;\n *         }\n *\n *         const msg = ctx.getMessage(id);\n *         return ctx.format(msg, args);\n *     }\n *\n * In order to pass an iterator to mapContext*, wrap it in CachedIterable.\n * This allows multiple calls to mapContext* without advancing and eventually\n * depleting the iterator.\n *\n *     function *generateMessages() {\n *         // Some lazy logic for yielding MessageContexts.\n *         yield *[ctx1, ctx2];\n *     }\n *\n *     const contexts = new CachedIterable(generateMessages());\n *     const ctx = mapContextSync(contexts, id);\n *\n */\n\n/*\n * Synchronously map an identifier or an array of identifiers to the best\n * `MessageContext` instance(s).\n *\n * @param {Iterable} iterable\n * @param {string|Array<string>} ids\n * @returns {MessageContext|Array<MessageContext>}\n */\nexport function mapContextSync(iterable, ids) {\n  if (!Array.isArray(ids)) {\n    return getContextForId(iterable, ids);\n  }\n\n  return ids.map(\n    id => getContextForId(iterable, id)\n  );\n}\n\n/*\n * Find the best `MessageContext` with the translation for `id`.\n */\nfunction getContextForId(iterable, id) {\n  for (const context of iterable) {\n    if (context.hasMessage(id)) {\n      return context;\n    }\n  }\n\n  return null;\n}\n\n/*\n * Asynchronously map an identifier or an array of identifiers to the best\n * `MessageContext` instance(s).\n *\n * @param {AsyncIterable} iterable\n * @param {string|Array<string>} ids\n * @returns {Promise<MessageContext|Array<MessageContext>>}\n */\nexport async function mapContextAsync(iterable, ids) {\n  if (!Array.isArray(ids)) {\n    for await (const context of iterable) {\n      if (context.hasMessage(ids)) {\n        return context;\n      }\n    }\n  }\n\n  let remainingCount = ids.length;\n  const foundContexts = new Array(remainingCount).fill(null);\n\n  for await (const context of iterable) {\n    // XXX Switch to const [index, id] of id.entries() when we move to Babel 7.\n    // See https://github.com/babel/babel/issues/5880.\n    for (let index = 0; index < ids.length; index++) {\n      const id = ids[index];\n      if (!foundContexts[index] && context.hasMessage(id)) {\n        foundContexts[index] = context;\n        remainingCount--;\n      }\n\n      // Return early when all ids have been mapped to contexts.\n      if (remainingCount === 0) {\n        return foundContexts;\n      }\n    }\n  }\n\n  return foundContexts;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent/src/fallback.js","function nonBlank(line) {\n  return !/^\\s*$/.test(line);\n}\n\nfunction countIndent(line) {\n  const [indent] = line.match(/^\\s*/);\n  return indent.length;\n}\n\n/**\n * Template literal tag for dedenting FTL code.\n *\n * Strip the common indent of non-blank lines. Remove blank lines.\n *\n * @param {Array<string>} strings\n */\nexport function ftl(strings) {\n  const [code] = strings;\n  const lines = code.split(\"\\n\").filter(nonBlank);\n  const indents = lines.map(countIndent);\n  const common = Math.min(...indents);\n  const indent = new RegExp(`^\\\\s{${common}}`);\n\n  return lines.map(\n    line => line.replace(indent, \"\")\n  ).join(\"\\n\");\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent/src/util.js","/*\n * @module fluent\n * @overview\n *\n * `fluent` is a JavaScript implementation of Project Fluent, a localization\n * framework designed to unleash the expressive power of the natural language.\n *\n */\n\nexport { default as _parse } from \"./parser\";\n\nexport { MessageContext } from \"./context\";\nexport {\n  FluentType as MessageArgument,\n  FluentNumber as MessageNumberArgument,\n  FluentDateTime as MessageDateTimeArgument,\n} from \"./types\";\n\nexport { default as CachedIterable } from \"./cached_iterable\";\nexport { mapContextSync, mapContextAsync } from \"./fallback\";\n\nexport { ftl } from \"./util\";\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent/src/index.js","/* eslint-env mozilla/frame-script */\n\nimport {actionCreators as ac, actionTypes as at, actionUtils as au} from \"common/Actions.jsm\";\nimport {applyMiddleware, combineReducers, createStore} from \"redux\";\n\nexport const MERGE_STORE_ACTION = \"NEW_TAB_INITIAL_STATE\";\nexport const OUTGOING_MESSAGE_NAME = \"ActivityStream:ContentToMain\";\nexport const INCOMING_MESSAGE_NAME = \"ActivityStream:MainToContent\";\nexport const EARLY_QUEUED_ACTIONS = [at.SAVE_SESSION_PERF_DATA, at.PAGE_PRERENDERED];\n\n/**\n * A higher-order function which returns a reducer that, on MERGE_STORE action,\n * will return the action.data object merged into the previous state.\n *\n * For all other actions, it merely calls mainReducer.\n *\n * Because we want this to merge the entire state object, it's written as a\n * higher order function which takes the main reducer (itself often a call to\n * combineReducers) as a parameter.\n *\n * @param  {function} mainReducer reducer to call if action != MERGE_STORE_ACTION\n * @return {function}             a reducer that, on MERGE_STORE_ACTION action,\n *                                will return the action.data object merged\n *                                into the previous state, and the result\n *                                of calling mainReducer otherwise.\n */\nfunction mergeStateReducer(mainReducer) {\n  return (prevState, action) => {\n    if (action.type === MERGE_STORE_ACTION) {\n      return {...prevState, ...action.data};\n    }\n\n    return mainReducer(prevState, action);\n  };\n}\n\n/**\n * messageMiddleware - Middleware that looks for SentToMain type actions, and sends them if necessary\n */\nconst messageMiddleware = store => next => action => {\n  const skipLocal = action.meta && action.meta.skipLocal;\n  if (au.isSendToMain(action)) {\n    RPMSendAsyncMessage(OUTGOING_MESSAGE_NAME, action);\n  }\n  if (!skipLocal) {\n    next(action);\n  }\n};\n\nexport const rehydrationMiddleware = store => next => action => {\n  if (store._didRehydrate) {\n    return next(action);\n  }\n\n  const isMergeStoreAction = action.type === MERGE_STORE_ACTION;\n  const isRehydrationRequest = action.type === at.NEW_TAB_STATE_REQUEST;\n\n  if (isRehydrationRequest) {\n    store._didRequestInitialState = true;\n    return next(action);\n  }\n\n  if (isMergeStoreAction) {\n    store._didRehydrate = true;\n    return next(action);\n  }\n\n  // If init happened after our request was made, we need to re-request\n  if (store._didRequestInitialState && action.type === at.INIT) {\n    return next(ac.AlsoToMain({type: at.NEW_TAB_STATE_REQUEST}));\n  }\n\n  if (au.isBroadcastToContent(action) || au.isSendToOneContent(action) || au.isSendToPreloaded(action)) {\n    // Note that actions received before didRehydrate will not be dispatched\n    // because this could negatively affect preloading and the the state\n    // will be replaced by rehydration anyway.\n    return null;\n  }\n\n  return next(action);\n};\n\n/**\n * This middleware queues up all the EARLY_QUEUED_ACTIONS until it receives\n * the first action from main. This is useful for those actions for main which\n * require higher reliability, i.e. the action will not be lost in the case\n * that it gets sent before the main is ready to receive it. Conversely, any\n * actions allowed early are accepted to be ignorable or re-sendable.\n */\nexport const queueEarlyMessageMiddleware = store => next => action => {\n  if (store._receivedFromMain) {\n    next(action);\n  } else if (au.isFromMain(action)) {\n    next(action);\n    store._receivedFromMain = true;\n    // Sending out all the early actions as main is ready now\n    if (store._earlyActionQueue) {\n      store._earlyActionQueue.forEach(next);\n      store._earlyActionQueue = [];\n    }\n  } else if (EARLY_QUEUED_ACTIONS.includes(action.type)) {\n    store._earlyActionQueue = store._earlyActionQueue || [];\n    store._earlyActionQueue.push(action);\n  } else {\n    // Let any other type of action go through\n    next(action);\n  }\n};\n\n/**\n * initStore - Create a store and listen for incoming actions\n *\n * @param  {object} reducers An object containing Redux reducers\n * @param  {object} intialState (optional) The initial state of the store, if desired\n * @return {object}          A redux store\n */\nexport function initStore(reducers, initialState) {\n  const store = createStore(\n    mergeStateReducer(combineReducers(reducers)),\n    initialState,\n    global.RPMAddMessageListener && applyMiddleware(rehydrationMiddleware, queueEarlyMessageMiddleware, messageMiddleware)\n  );\n\n  store._didRehydrate = false;\n  store._didRequestInitialState = false;\n\n  if (global.RPMAddMessageListener) {\n    global.RPMAddMessageListener(INCOMING_MESSAGE_NAME, msg => {\n      try {\n        store.dispatch(msg.data);\n      } catch (ex) {\n        console.error(\"Content msg:\", msg, \"Dispatch error: \", ex); // eslint-disable-line no-console\n        dump(`Content msg: ${JSON.stringify(msg)}\\nDispatch error: ${ex}\\n${ex.stack}`);\n      }\n    });\n  }\n\n  return store;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/lib/init-store.js","module.exports = ReactDOM;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ReactDOM\"\n// module id = 12\n// module chunks = 0","import {FormattedMessage} from \"react-intl\";\nimport React from \"react\";\n\nexport class ErrorBoundaryFallback extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.windowObj = this.props.windowObj || window;\n    this.onClick = this.onClick.bind(this);\n  }\n\n  /**\n   * Since we only get here if part of the page has crashed, do a\n   * forced reload to give us the best chance at recovering.\n   */\n  onClick() {\n    this.windowObj.location.reload(true);\n  }\n\n  render() {\n    const defaultClass = \"as-error-fallback\";\n    let className;\n    if (\"className\" in this.props) {\n      className = `${this.props.className} ${defaultClass}`;\n    } else {\n      className = defaultClass;\n    }\n\n    // href=\"#\" to force normal link styling stuff (eg cursor on hover)\n    return (\n      <div className={className}>\n        <div>\n          <FormattedMessage\n            defaultMessage=\"Oops, something went wrong loading this content.\"\n            id=\"error_fallback_default_info\" />\n        </div>\n        <span>\n          <a href=\"#\" className=\"reload-button\" onClick={this.onClick}>\n            <FormattedMessage\n              defaultMessage=\"Refresh page to try again.\"\n              id=\"error_fallback_default_refresh_suggestion\" />\n          </a>\n        </span>\n      </div>\n    );\n  }\n}\nErrorBoundaryFallback.defaultProps = {className: \"as-error-fallback\"};\n\nexport class ErrorBoundary extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {hasError: false};\n  }\n\n  componentDidCatch(error, info) {\n    this.setState({hasError: true});\n  }\n\n  render() {\n    if (!this.state.hasError) {\n      return (this.props.children);\n    }\n\n    return <this.props.FallbackComponent className={this.props.className} />;\n  }\n}\n\nErrorBoundary.defaultProps = {FallbackComponent: ErrorBoundaryFallback};\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/ErrorBoundary/ErrorBoundary.jsx","import {actionCreators as ac, actionTypes as at} from \"common/Actions.jsm\";\n\nconst _OpenInPrivateWindow = site => ({\n  id: \"menu_action_open_private_window\",\n  icon: \"new-window-private\",\n  action: ac.OnlyToMain({\n    type: at.OPEN_PRIVATE_WINDOW,\n    data: {url: site.url, referrer: site.referrer}\n  }),\n  userEvent: \"OPEN_PRIVATE_WINDOW\"\n});\n\nexport const GetPlatformString = platform => {\n  switch (platform) {\n    case \"win\":\n      return \"menu_action_show_file_windows\";\n    case \"macosx\":\n      return \"menu_action_show_file_mac_os\";\n    case \"linux\":\n      return \"menu_action_show_file_linux\";\n    default:\n      return \"menu_action_show_file_default\";\n  }\n};\n\n/**\n * List of functions that return items that can be included as menu options in a\n * LinkMenu. All functions take the site as the first parameter, and optionally\n * the index of the site.\n */\nexport const LinkMenuOptions = {\n  Separator: () => ({type: \"separator\"}),\n  EmptyItem: () => ({type: \"empty\"}),\n  RemoveBookmark: site => ({\n    id: \"menu_action_remove_bookmark\",\n    icon: \"bookmark-added\",\n    action: ac.AlsoToMain({\n      type: at.DELETE_BOOKMARK_BY_ID,\n      data: site.bookmarkGuid\n    }),\n    userEvent: \"BOOKMARK_DELETE\"\n  }),\n  AddBookmark: site => ({\n    id: \"menu_action_bookmark\",\n    icon: \"bookmark-hollow\",\n    action: ac.AlsoToMain({\n      type: at.BOOKMARK_URL,\n      data: {url: site.url, title: site.title, type: site.type}\n    }),\n    userEvent: \"BOOKMARK_ADD\"\n  }),\n  OpenInNewWindow: site => ({\n    id: \"menu_action_open_new_window\",\n    icon: \"new-window\",\n    action: ac.AlsoToMain({\n      type: at.OPEN_NEW_WINDOW,\n      data: {\n        referrer: site.referrer,\n        typedBonus: site.typedBonus,\n        url: site.url\n      }\n    }),\n    userEvent: \"OPEN_NEW_WINDOW\"\n  }),\n  BlockUrl: (site, index, eventSource) => ({\n    id: \"menu_action_dismiss\",\n    icon: \"dismiss\",\n    action: ac.AlsoToMain({\n      type: at.BLOCK_URL,\n      data: {url: site.url, pocket_id: site.pocket_id}\n    }),\n    impression: ac.ImpressionStats({\n      source: eventSource,\n      block: 0,\n      tiles: [{id: site.guid, pos: index}]\n    }),\n    userEvent: \"BLOCK\"\n  }),\n\n  // This is an option for web extentions which will result in remove items from\n  // memory and notify the web extenion, rather than using the built-in block list.\n  WebExtDismiss: (site, index, eventSource) => ({\n    id: \"menu_action_webext_dismiss\",\n    string_id: \"menu_action_dismiss\",\n    icon: \"dismiss\",\n    action: ac.WebExtEvent(at.WEBEXT_DISMISS, {\n      source: eventSource,\n      url: site.url,\n      action_position: index\n    })\n  }),\n  DeleteUrl: (site, index, eventSource, isEnabled, siteInfo) => ({\n    id: \"menu_action_delete\",\n    icon: \"delete\",\n    action: {\n      type: at.DIALOG_OPEN,\n      data: {\n        onConfirm: [\n          ac.AlsoToMain({type: at.DELETE_HISTORY_URL, data: {url: site.url, pocket_id: site.pocket_id, forceBlock: site.bookmarkGuid}}),\n          ac.UserEvent(Object.assign({event: \"DELETE\", source: eventSource, action_position: index}, siteInfo))\n        ],\n        eventSource,\n        body_string_id: [\"confirm_history_delete_p1\", \"confirm_history_delete_notice_p2\"],\n        confirm_button_string_id: \"menu_action_delete\",\n        cancel_button_string_id: \"topsites_form_cancel_button\",\n        icon: \"modal-delete\"\n      }\n    },\n    userEvent: \"DIALOG_OPEN\"\n  }),\n  ShowFile: (site, index, eventSource, isEnabled, siteInfo, platform) => ({\n    id: GetPlatformString(platform),\n    icon: \"search\",\n    action: ac.OnlyToMain({\n      type: at.SHOW_DOWNLOAD_FILE,\n      data: {url: site.url}\n    })\n  }),\n  OpenFile: site => ({\n    id: \"menu_action_open_file\",\n    icon: \"open-file\",\n    action: ac.OnlyToMain({\n      type: at.OPEN_DOWNLOAD_FILE,\n      data: {url: site.url}\n    })\n  }),\n  CopyDownloadLink: site => ({\n    id: \"menu_action_copy_download_link\",\n    icon: \"copy\",\n    action: ac.OnlyToMain({\n      type: at.COPY_DOWNLOAD_LINK,\n      data: {url: site.url}\n    })\n  }),\n  GoToDownloadPage: site => ({\n    id: \"menu_action_go_to_download_page\",\n    icon: \"download\",\n    action: ac.OnlyToMain({\n      type: at.OPEN_LINK,\n      data: {url: site.referrer}\n    }),\n    disabled: !site.referrer\n  }),\n  RemoveDownload: site => ({\n    id: \"menu_action_remove_download\",\n    icon: \"delete\",\n    action: ac.OnlyToMain({\n      type: at.REMOVE_DOWNLOAD_FILE,\n      data: {url: site.url}\n    })\n  }),\n  PinTopSite: (site, index) => ({\n    id: \"menu_action_pin\",\n    icon: \"pin\",\n    action: ac.AlsoToMain({\n      type: at.TOP_SITES_PIN,\n      data: {site: {url: site.url}, index}\n    }),\n    userEvent: \"PIN\"\n  }),\n  UnpinTopSite: site => ({\n    id: \"menu_action_unpin\",\n    icon: \"unpin\",\n    action: ac.AlsoToMain({\n      type: at.TOP_SITES_UNPIN,\n      data: {site: {url: site.url}}\n    }),\n    userEvent: \"UNPIN\"\n  }),\n  SaveToPocket: (site, index, eventSource) => ({\n    id: \"menu_action_save_to_pocket\",\n    icon: \"pocket\",\n    action: ac.AlsoToMain({\n      type: at.SAVE_TO_POCKET,\n      data: {site: {url: site.url, title: site.title}}\n    }),\n    impression: ac.ImpressionStats({\n      source: eventSource,\n      pocket: 0,\n      tiles: [{id: site.guid, pos: index}]\n    }),\n    userEvent: \"SAVE_TO_POCKET\"\n  }),\n  DeleteFromPocket: site => ({\n    id: \"menu_action_delete_pocket\",\n    icon: \"delete\",\n    action: ac.AlsoToMain({\n      type: at.DELETE_FROM_POCKET,\n      data: {pocket_id: site.pocket_id}\n    }),\n    userEvent: \"DELETE_FROM_POCKET\"\n  }),\n  ArchiveFromPocket: site => ({\n    id: \"menu_action_archive_pocket\",\n    icon: \"check\",\n    action: ac.AlsoToMain({\n      type: at.ARCHIVE_FROM_POCKET,\n      data: {pocket_id: site.pocket_id}\n    }),\n    userEvent: \"ARCHIVE_FROM_POCKET\"\n  }),\n  EditTopSite: (site, index) => ({\n    id: \"edit_topsites_button_text\",\n    icon: \"edit\",\n    action: {\n      type: at.TOP_SITES_EDIT,\n      data: {index}\n    }\n  }),\n  CheckBookmark: site => (site.bookmarkGuid ? LinkMenuOptions.RemoveBookmark(site) : LinkMenuOptions.AddBookmark(site)),\n  CheckPinTopSite: (site, index) => (site.isPinned ? LinkMenuOptions.UnpinTopSite(site) : LinkMenuOptions.PinTopSite(site, index)),\n  CheckSavedToPocket: (site, index) => (site.pocket_id ? LinkMenuOptions.DeleteFromPocket(site) : LinkMenuOptions.SaveToPocket(site, index)),\n  CheckBookmarkOrArchive: site => (site.pocket_id ? LinkMenuOptions.ArchiveFromPocket(site) : LinkMenuOptions.CheckBookmark(site)),\n  OpenInPrivateWindow: (site, index, eventSource, isEnabled) => (isEnabled ? _OpenInPrivateWindow(site) : LinkMenuOptions.EmptyItem())\n};\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/lib/link-menu-options.js","import {actionCreators as ac} from \"common/Actions.jsm\";\nimport {connect} from \"react-redux\";\nimport {ContextMenu} from \"content-src/components/ContextMenu/ContextMenu\";\nimport {injectIntl} from \"react-intl\";\nimport {LinkMenuOptions} from \"content-src/lib/link-menu-options\";\nimport React from \"react\";\n\nconst DEFAULT_SITE_MENU_OPTIONS = [\"CheckPinTopSite\", \"EditTopSite\", \"Separator\", \"OpenInNewWindow\", \"OpenInPrivateWindow\", \"Separator\", \"BlockUrl\"];\n\nexport class _LinkMenu extends React.PureComponent {\n  getOptions() {\n    const {props} = this;\n    const {site, index, source, isPrivateBrowsingEnabled, siteInfo, platform} = props;\n\n    // Handle special case of default site\n    const propOptions = !site.isDefault ? props.options : DEFAULT_SITE_MENU_OPTIONS;\n\n    const options = propOptions.map(o => LinkMenuOptions[o](site, index, source, isPrivateBrowsingEnabled, siteInfo, platform)).map(option => {\n      const {action, impression, id, string_id, type, userEvent} = option;\n      if (!type && id) {\n        option.label = props.intl.formatMessage({id: string_id || id});\n        option.onClick = () => {\n          props.dispatch(action);\n          if (userEvent) {\n            const userEventData = Object.assign({\n              event: userEvent,\n              source,\n              action_position: index\n            }, siteInfo);\n            props.dispatch(ac.UserEvent(userEventData));\n          }\n          if (impression && props.shouldSendImpressionStats) {\n            props.dispatch(impression);\n          }\n        };\n      }\n      return option;\n    });\n\n    // This is for accessibility to support making each item tabbable.\n    // We want to know which item is the first and which item\n    // is the last, so we can close the context menu accordingly.\n    options[0].first = true;\n    options[options.length - 1].last = true;\n    return options;\n  }\n\n  render() {\n    return (<ContextMenu\n      onUpdate={this.props.onUpdate}\n      options={this.getOptions()} />);\n  }\n}\n\nconst getState = state => ({isPrivateBrowsingEnabled: state.Prefs.values.isPrivateBrowsingEnabled, platform: state.Prefs.values.platform});\nexport const LinkMenu = connect(getState)(injectIntl(_LinkMenu));\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/LinkMenu/LinkMenu.jsx","import React from \"react\";\n\nexport class ContextMenu extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.hideContext = this.hideContext.bind(this);\n    this.onClick = this.onClick.bind(this);\n  }\n\n  hideContext() {\n    this.props.onUpdate(false);\n  }\n\n  componentDidMount() {\n    setTimeout(() => {\n      global.addEventListener(\"click\", this.hideContext);\n    }, 0);\n  }\n\n  componentWillUnmount() {\n    global.removeEventListener(\"click\", this.hideContext);\n  }\n\n  onClick(event) {\n    // Eat all clicks on the context menu so they don't bubble up to window.\n    // This prevents the context menu from closing when clicking disabled items\n    // or the separators.\n    event.stopPropagation();\n  }\n\n  render() {\n    return (<span className=\"context-menu\" onClick={this.onClick}>\n      <ul role=\"menu\" className=\"context-menu-list\">\n        {this.props.options.map((option, i) => (option.type === \"separator\" ?\n          (<li key={i} className=\"separator\" />) :\n          (option.type !== \"empty\" && <ContextMenuItem key={i} option={option} hideContext={this.hideContext} />)\n        ))}\n      </ul>\n    </span>);\n  }\n}\n\nexport class ContextMenuItem extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.onClick = this.onClick.bind(this);\n    this.onKeyDown = this.onKeyDown.bind(this);\n  }\n\n  onClick() {\n    this.props.hideContext();\n    this.props.option.onClick();\n  }\n\n  onKeyDown(event) {\n    const {option} = this.props;\n    switch (event.key) {\n      case \"Tab\":\n        // tab goes down in context menu, shift + tab goes up in context menu\n        // if we're on the last item, one more tab will close the context menu\n        // similarly, if we're on the first item, one more shift + tab will close it\n        if ((event.shiftKey && option.first) || (!event.shiftKey && option.last)) {\n          this.props.hideContext();\n        }\n        break;\n      case \"Enter\":\n        this.props.hideContext();\n        option.onClick();\n        break;\n    }\n  }\n\n  render() {\n    const {option} = this.props;\n    return (\n      <li role=\"menuitem\" className=\"context-menu-item\">\n        <a onClick={this.onClick} onKeyDown={this.onKeyDown} tabIndex=\"0\" className={option.disabled ? \"disabled\" : \"\"}>\n          {option.icon && <span className={`icon icon-spacer icon-${option.icon}`} />}\n          {option.label}\n        </a>\n      </li>);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/ContextMenu/ContextMenu.jsx","/**\n * List of helper functions for screenshot-based images.\n *\n * There are two kinds of images:\n * 1. Remote Image: This is the image from the main process and it refers to\n *    the image in the React props. This can either be an object with the `data`\n *    and `path` properties, if it is a blob, or a string, if it is a normal image.\n * 2. Local Image: This is the image object in the content process and it refers\n *    to the image *object* in the React component's state. All local image\n *    objects have the `url` property, and an additional property `path`, if they\n *    are blobs.\n */\nexport const ScreenshotUtils = {\n  isBlob(isLocal, image) {\n    return !!(image && image.path && ((!isLocal && image.data) || (isLocal && image.url)));\n  },\n\n  // This should always be called with a remote image and not a local image.\n  createLocalImageObject(remoteImage) {\n    if (!remoteImage) {\n      return null;\n    }\n    if (this.isBlob(false, remoteImage)) {\n      return {url: global.URL.createObjectURL(remoteImage.data), path: remoteImage.path};\n    }\n    return {url: remoteImage};\n  },\n\n  // Revokes the object URL of the image if the local image is a blob.\n  // This should always be called with a local image and not a remote image.\n  maybeRevokeBlobObjectURL(localImage) {\n    if (this.isBlob(true, localImage)) {\n      global.URL.revokeObjectURL(localImage.url);\n    }\n  },\n\n  // Checks if remoteImage and localImage are the same.\n  isRemoteImageLocal(localImage, remoteImage) {\n    // Both remoteImage and localImage are present.\n    if (remoteImage && localImage) {\n      return this.isBlob(false, remoteImage) ?\n             localImage.path === remoteImage.path :\n             localImage.url === remoteImage;\n    }\n\n    // This will only handle the remaining three possible outcomes.\n    // (i.e. everything except when both image and localImage are present)\n    return !remoteImage && !localImage;\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/lib/screenshot-utils.js","import {FormattedMessage, injectIntl} from \"react-intl\";\nimport {actionCreators as ac} from \"common/Actions.jsm\";\nimport {ErrorBoundary} from \"content-src/components/ErrorBoundary/ErrorBoundary\";\nimport React from \"react\";\nimport {SectionMenu} from \"content-src/components/SectionMenu/SectionMenu\";\nimport {SectionMenuOptions} from \"content-src/lib/section-menu-options\";\n\nconst VISIBLE = \"visible\";\nconst VISIBILITY_CHANGE_EVENT = \"visibilitychange\";\n\nfunction getFormattedMessage(message) {\n  return typeof message === \"string\" ? <span>{message}</span> : <FormattedMessage {...message} />;\n}\n\nexport class Disclaimer extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.onAcknowledge = this.onAcknowledge.bind(this);\n  }\n\n  onAcknowledge() {\n    this.props.dispatch(ac.SetPref(this.props.disclaimerPref, false));\n    this.props.dispatch(ac.UserEvent({event: \"DISCLAIMER_ACKED\", source: this.props.eventSource}));\n  }\n\n  render() {\n    const {disclaimer} = this.props;\n    return (\n      <div className=\"section-disclaimer\">\n          <div className=\"section-disclaimer-text\">\n            {getFormattedMessage(disclaimer.text)}\n            {disclaimer.link &&\n              <a href={disclaimer.link.href} target=\"_blank\" rel=\"noopener noreferrer\">\n                {getFormattedMessage(disclaimer.link.title || disclaimer.link)}\n              </a>\n            }\n          </div>\n\n          <button onClick={this.onAcknowledge}>\n            {getFormattedMessage(disclaimer.button)}\n          </button>\n      </div>\n    );\n  }\n}\n\nexport const DisclaimerIntl = injectIntl(Disclaimer);\n\nexport class _CollapsibleSection extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.onBodyMount = this.onBodyMount.bind(this);\n    this.onHeaderClick = this.onHeaderClick.bind(this);\n    this.onTransitionEnd = this.onTransitionEnd.bind(this);\n    this.enableOrDisableAnimation = this.enableOrDisableAnimation.bind(this);\n    this.onMenuButtonClick = this.onMenuButtonClick.bind(this);\n    this.onMenuButtonMouseEnter = this.onMenuButtonMouseEnter.bind(this);\n    this.onMenuButtonMouseLeave = this.onMenuButtonMouseLeave.bind(this);\n    this.onMenuUpdate = this.onMenuUpdate.bind(this);\n    this.state = {enableAnimation: true, isAnimating: false, menuButtonHover: false, showContextMenu: false};\n  }\n\n  componentWillMount() {\n    this.props.document.addEventListener(VISIBILITY_CHANGE_EVENT, this.enableOrDisableAnimation);\n  }\n\n  componentWillUpdate(nextProps) {\n    // Check if we're about to go from expanded to collapsed\n    if (!this.props.collapsed && nextProps.collapsed) {\n      // This next line forces a layout flush of the section body, which has a\n      // max-height style set, so that the upcoming collapse animation can\n      // animate from that height to the collapsed height. Without this, the\n      // update is coalesced and there's no animation from no-max-height to 0.\n      this.sectionBody.scrollHeight; // eslint-disable-line no-unused-expressions\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.document.removeEventListener(VISIBILITY_CHANGE_EVENT, this.enableOrDisableAnimation);\n  }\n\n  enableOrDisableAnimation() {\n    // Only animate the collapse/expand for visible tabs.\n    const visible = this.props.document.visibilityState === VISIBLE;\n    if (this.state.enableAnimation !== visible) {\n      this.setState({enableAnimation: visible});\n    }\n  }\n\n  onBodyMount(node) {\n    this.sectionBody = node;\n  }\n\n  onHeaderClick() {\n    // If this.sectionBody is unset, it means that we're in some sort of error\n    // state, probably displaying the error fallback, so we won't be able to\n    // compute the height, and we don't want to persist the preference.\n    // If props.collapsed is undefined handler shouldn't do anything.\n    if (!this.sectionBody || this.props.collapsed === undefined) {\n      return;\n    }\n\n    // Get the current height of the body so max-height transitions can work\n    this.setState({\n      isAnimating: true,\n      maxHeight: `${this.sectionBody.scrollHeight}px`\n    });\n    const {action, userEvent} = SectionMenuOptions.CheckCollapsed(this.props);\n    this.props.dispatch(action);\n    this.props.dispatch(ac.UserEvent({\n      event: userEvent,\n      source: this.props.source\n    }));\n  }\n\n  onTransitionEnd(event) {\n    // Only update the animating state for our own transition (not a child's)\n    if (event.target === event.currentTarget) {\n      this.setState({isAnimating: false});\n    }\n  }\n\n  renderIcon() {\n    const {icon} = this.props;\n    if (icon && icon.startsWith(\"moz-extension://\")) {\n      return <span className=\"icon icon-small-spacer\" style={{backgroundImage: `url('${icon}')`}} />;\n    }\n    return <span className={`icon icon-small-spacer icon-${icon || \"webextension\"}`} />;\n  }\n\n  onMenuButtonClick(event) {\n    event.preventDefault();\n    this.setState({showContextMenu: true});\n  }\n\n  onMenuButtonMouseEnter() {\n    this.setState({menuButtonHover: true});\n  }\n\n  onMenuButtonMouseLeave() {\n    this.setState({menuButtonHover: false});\n  }\n\n  onMenuUpdate(showContextMenu) {\n    this.setState({showContextMenu});\n  }\n\n  render() {\n    const isCollapsible = this.props.collapsed !== undefined;\n    const {enableAnimation, isAnimating, maxHeight, menuButtonHover, showContextMenu} = this.state;\n    const {id, eventSource, collapsed, disclaimer, title, extraMenuOptions, showPrefName, privacyNoticeURL, dispatch, isFirst, isLast, isWebExtension} = this.props;\n    const disclaimerPref = `section.${id}.showDisclaimer`;\n    const needsDisclaimer = disclaimer && this.props.Prefs.values[disclaimerPref];\n    const active = menuButtonHover || showContextMenu;\n    return (\n      <section\n        className={`collapsible-section ${this.props.className}${enableAnimation ? \" animation-enabled\" : \"\"}${collapsed ? \" collapsed\" : \"\"}${active ? \" active\" : \"\"}`}\n        // Note: data-section-id is used for web extension api tests in mozilla central\n        data-section-id={id}>\n        <div className=\"section-top-bar\">\n          <h3 className=\"section-title\">\n            <span className=\"click-target\" onClick={this.onHeaderClick}>\n              {this.renderIcon()}\n              {getFormattedMessage(title)}\n              {isCollapsible && <span className={`collapsible-arrow icon ${collapsed ? \"icon-arrowhead-forward-small\" : \"icon-arrowhead-down-small\"}`} />}\n            </span>\n          </h3>\n          <div>\n            <button\n              className=\"context-menu-button icon\"\n              onClick={this.onMenuButtonClick}\n              onMouseEnter={this.onMenuButtonMouseEnter}\n              onMouseLeave={this.onMenuButtonMouseLeave}>\n              <span className=\"sr-only\">\n                <FormattedMessage id=\"section_context_menu_button_sr\" />\n              </span>\n            </button>\n            {showContextMenu &&\n              <SectionMenu\n                id={id}\n                extraOptions={extraMenuOptions}\n                eventSource={eventSource}\n                showPrefName={showPrefName}\n                privacyNoticeURL={privacyNoticeURL}\n                collapsed={collapsed}\n                onUpdate={this.onMenuUpdate}\n                isFirst={isFirst}\n                isLast={isLast}\n                dispatch={dispatch}\n                isWebExtension={isWebExtension} />\n            }\n          </div>\n        </div>\n        <ErrorBoundary className=\"section-body-fallback\">\n          <div\n            className={`section-body${isAnimating ? \" animating\" : \"\"}`}\n            onTransitionEnd={this.onTransitionEnd}\n            ref={this.onBodyMount}\n            style={isAnimating && !collapsed ? {maxHeight} : null}>\n            {needsDisclaimer && <DisclaimerIntl disclaimerPref={disclaimerPref} disclaimer={disclaimer} eventSource={eventSource} dispatch={this.props.dispatch} />}\n            {this.props.children}\n          </div>\n        </ErrorBoundary>\n      </section>\n    );\n  }\n}\n\n_CollapsibleSection.defaultProps = {\n  document: global.document || {\n    addEventListener: () => {},\n    removeEventListener: () => {},\n    visibilityState: \"hidden\"\n  },\n  Prefs: {values: {}}\n};\n\nexport const CollapsibleSection = injectIntl(_CollapsibleSection);\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/CollapsibleSection/CollapsibleSection.jsx","import {actionCreators as ac, actionTypes as at} from \"common/Actions.jsm\";\n\n/**\n * List of functions that return items that can be included as menu options in a\n * SectionMenu. All functions take the section as the only parameter.\n */\nexport const SectionMenuOptions = {\n  Separator: () => ({type: \"separator\"}),\n  MoveUp: section => ({\n    id: \"section_menu_action_move_up\",\n    icon: \"arrowhead-up\",\n    action: ac.OnlyToMain({\n      type: at.SECTION_MOVE,\n      data: {id: section.id, direction: -1}\n    }),\n    userEvent: \"MENU_MOVE_UP\",\n    disabled: !!section.isFirst\n  }),\n  MoveDown: section => ({\n    id: \"section_menu_action_move_down\",\n    icon: \"arrowhead-down\",\n    action: ac.OnlyToMain({\n      type: at.SECTION_MOVE,\n      data: {id: section.id, direction: +1}\n    }),\n    userEvent: \"MENU_MOVE_DOWN\",\n    disabled: !!section.isLast\n  }),\n  RemoveSection: section => ({\n    id: \"section_menu_action_remove_section\",\n    icon: \"dismiss\",\n    action: ac.SetPref(section.showPrefName, false),\n    userEvent: \"MENU_REMOVE\"\n  }),\n  CollapseSection: section => ({\n    id: \"section_menu_action_collapse_section\",\n    icon: \"minimize\",\n    action: ac.OnlyToMain({type: at.UPDATE_SECTION_PREFS, data: {id: section.id, value: {collapsed: true}}}),\n    userEvent: \"MENU_COLLAPSE\"\n  }),\n  ExpandSection: section => ({\n    id: \"section_menu_action_expand_section\",\n    icon: \"maximize\",\n    action: ac.OnlyToMain({type: at.UPDATE_SECTION_PREFS, data: {id: section.id, value: {collapsed: false}}}),\n    userEvent: \"MENU_EXPAND\"\n  }),\n  ManageSection: section => ({\n    id: \"section_menu_action_manage_section\",\n    icon: \"settings\",\n    action: ac.OnlyToMain({type: at.SETTINGS_OPEN}),\n    userEvent: \"MENU_MANAGE\"\n  }),\n  ManageWebExtension: section => ({\n    id: \"section_menu_action_manage_webext\",\n    icon: \"settings\",\n    action: ac.OnlyToMain({type: at.OPEN_WEBEXT_SETTINGS, data: section.id})\n  }),\n  AddTopSite: section => ({\n    id: \"section_menu_action_add_topsite\",\n    icon: \"add\",\n    action: {type: at.TOP_SITES_EDIT, data: {index: -1}},\n    userEvent: \"MENU_ADD_TOPSITE\"\n  }),\n  PrivacyNotice: section => ({\n    id: \"section_menu_action_privacy_notice\",\n    icon: \"info\",\n    action: ac.OnlyToMain({\n      type: at.OPEN_LINK,\n      data: {url: section.privacyNoticeURL}\n    }),\n    userEvent: \"MENU_PRIVACY_NOTICE\"\n  }),\n  CheckCollapsed: section => (section.collapsed ? SectionMenuOptions.ExpandSection(section) : SectionMenuOptions.CollapseSection(section))\n};\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/lib/section-menu-options.js","import {actionCreators as ac, actionTypes as at} from \"common/Actions.jsm\";\nimport {perfService as perfSvc} from \"common/PerfService.jsm\";\nimport React from \"react\";\n\n// Currently record only a fixed set of sections. This will prevent data\n// from custom sections from showing up or from topstories.\nconst RECORDED_SECTIONS = [\"highlights\", \"topsites\"];\n\nexport class ComponentPerfTimer extends React.Component {\n  constructor(props) {\n    super(props);\n    // Just for test dependency injection:\n    this.perfSvc = this.props.perfSvc || perfSvc;\n\n    this._sendBadStateEvent = this._sendBadStateEvent.bind(this);\n    this._sendPaintedEvent = this._sendPaintedEvent.bind(this);\n    this._reportMissingData = false;\n    this._timestampHandled = false;\n    this._recordedFirstRender = false;\n  }\n\n  componentDidMount() {\n    if (!RECORDED_SECTIONS.includes(this.props.id)) {\n      return;\n    }\n\n    this._maybeSendPaintedEvent();\n  }\n\n  componentDidUpdate() {\n    if (!RECORDED_SECTIONS.includes(this.props.id)) {\n      return;\n    }\n\n    this._maybeSendPaintedEvent();\n  }\n\n  /**\n   * Call the given callback after the upcoming frame paints.\n   *\n   * @note Both setTimeout and requestAnimationFrame are throttled when the page\n   * is hidden, so this callback may get called up to a second or so after the\n   * requestAnimationFrame \"paint\" for hidden tabs.\n   *\n   * Newtabs hidden while loading will presumably be fairly rare (other than\n   * preloaded tabs, which we will be filtering out on the server side), so such\n   * cases should get lost in the noise.\n   *\n   * If we decide that it's important to find out when something that's hidden\n   * has \"painted\", however, another option is to post a message to this window.\n   * That should happen even faster than setTimeout, and, at least as of this\n   * writing, it's not throttled in hidden windows in Firefox.\n   *\n   * @param {Function} callback\n   *\n   * @returns void\n   */\n  _afterFramePaint(callback) {\n    requestAnimationFrame(() => setTimeout(callback, 0));\n  }\n\n  _maybeSendBadStateEvent() {\n    // Follow up bugs:\n    // https://github.com/mozilla/activity-stream/issues/3691\n    if (!this.props.initialized) {\n      // Remember to report back when data is available.\n      this._reportMissingData = true;\n    } else if (this._reportMissingData) {\n      this._reportMissingData = false;\n      // Report how long it took for component to become initialized.\n      this._sendBadStateEvent();\n    }\n  }\n\n  _maybeSendPaintedEvent() {\n    // If we've already handled a timestamp, don't do it again.\n    if (this._timestampHandled || !this.props.initialized) {\n      return;\n    }\n\n    // And if we haven't, we're doing so now, so remember that. Even if\n    // something goes wrong in the callback, we can't try again, as we'd be\n    // sending back the wrong data, and we have to do it here, so that other\n    // calls to this method while waiting for the next frame won't also try to\n    // handle it.\n    this._timestampHandled = true;\n    this._afterFramePaint(this._sendPaintedEvent);\n  }\n\n  /**\n   * Triggered by call to render. Only first call goes through due to\n   * `_recordedFirstRender`.\n   */\n  _ensureFirstRenderTsRecorded() {\n    // Used as t0 for recording how long component took to initialize.\n    if (!this._recordedFirstRender) {\n      this._recordedFirstRender = true;\n      // topsites_first_render_ts, highlights_first_render_ts.\n      const key = `${this.props.id}_first_render_ts`;\n      this.perfSvc.mark(key);\n    }\n  }\n\n  /**\n   * Creates `TELEMETRY_UNDESIRED_EVENT` with timestamp in ms\n   * of how much longer the data took to be ready for display than it would\n   * have been the ideal case.\n   * https://github.com/mozilla/ping-centre/issues/98\n   */\n  _sendBadStateEvent() {\n    // highlights_data_ready_ts, topsites_data_ready_ts.\n    const dataReadyKey = `${this.props.id}_data_ready_ts`;\n    this.perfSvc.mark(dataReadyKey);\n\n    try {\n      const firstRenderKey = `${this.props.id}_first_render_ts`;\n      // value has to be Int32.\n      const value = parseInt(this.perfSvc.getMostRecentAbsMarkStartByName(dataReadyKey) -\n                             this.perfSvc.getMostRecentAbsMarkStartByName(firstRenderKey), 10);\n      this.props.dispatch(ac.OnlyToMain({\n        type: at.SAVE_SESSION_PERF_DATA,\n        // highlights_data_late_by_ms, topsites_data_late_by_ms.\n        data: {[`${this.props.id}_data_late_by_ms`]: value}\n      }));\n    } catch (ex) {\n      // If this failed, it's likely because the `privacy.resistFingerprinting`\n      // pref is true.\n    }\n  }\n\n  _sendPaintedEvent() {\n    // Record first_painted event but only send if topsites.\n    if (this.props.id !== \"topsites\") {\n      return;\n    }\n\n    // topsites_first_painted_ts.\n    const key = `${this.props.id}_first_painted_ts`;\n    this.perfSvc.mark(key);\n\n    try {\n      const data = {};\n      data[key] = this.perfSvc.getMostRecentAbsMarkStartByName(key);\n\n      this.props.dispatch(ac.OnlyToMain({\n        type: at.SAVE_SESSION_PERF_DATA,\n        data\n      }));\n    } catch (ex) {\n      // If this failed, it's likely because the `privacy.resistFingerprinting`\n      // pref is true.  We should at least not blow up, and should continue\n      // to set this._timestampHandled to avoid going through this again.\n    }\n  }\n\n  render() {\n    if (RECORDED_SECTIONS.includes(this.props.id)) {\n      this._ensureFirstRenderTsRecorded();\n      this._maybeSendBadStateEvent();\n    }\n    return this.props.children;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/ComponentPerfTimer/ComponentPerfTimer.jsx","/* globals Services */\n\"use strict\";\n\n/* istanbul ignore if */\nif (typeof ChromeUtils !== \"undefined\") {\n  ChromeUtils.import(\"resource://gre/modules/Services.jsm\");\n}\n\nlet usablePerfObj;\n\n/* istanbul ignore if */\n/* istanbul ignore else */\nif (typeof Services !== \"undefined\") {\n  // Borrow the high-resolution timer from the hidden window....\n  usablePerfObj = Services.appShell.hiddenDOMWindow.performance;\n} else if (typeof performance !== \"undefined\") {\n  // we must be running in content space\n  // eslint-disable-next-line no-undef\n  usablePerfObj = performance;\n} else {\n  // This is a dummy object so this file doesn't crash in the node prerendering\n  // task.\n  usablePerfObj = {\n    now() {},\n    mark() {}\n  };\n}\n\nfunction _PerfService(options) {\n  // For testing, so that we can use a fake Window.performance object with\n  // known state.\n  if (options && options.performanceObj) {\n    this._perf = options.performanceObj;\n  } else {\n    this._perf = usablePerfObj;\n  }\n}\n\n_PerfService.prototype = {\n  /**\n   * Calls the underlying mark() method on the appropriate Window.performance\n   * object to add a mark with the given name to the appropriate performance\n   * timeline.\n   *\n   * @param  {String} name  the name to give the current mark\n   * @return {void}\n   */\n  mark: function mark(str) {\n    this._perf.mark(str);\n  },\n\n  /**\n   * Calls the underlying getEntriesByName on the appropriate Window.performance\n   * object.\n   *\n   * @param  {String} name\n   * @param  {String} type eg \"mark\"\n   * @return {Array}       Performance* objects\n   */\n  getEntriesByName: function getEntriesByName(name, type) {\n    return this._perf.getEntriesByName(name, type);\n  },\n\n  /**\n   * The timeOrigin property from the appropriate performance object.\n   * Used to ensure that timestamps from the add-on code and the content code\n   * are comparable.\n   *\n   * @note If this is called from a context without a window\n   * (eg a JSM in chrome), it will return the timeOrigin of the XUL hidden\n   * window, which appears to be the first created window (and thus\n   * timeOrigin) in the browser.  Note also, however, there is also a private\n   * hidden window, presumably for private browsing, which appears to be\n   * created dynamically later.  Exactly how/when that shows up needs to be\n   * investigated.\n   *\n   * @return {Number} A double of milliseconds with a precision of 0.5us.\n   */\n  get timeOrigin() {\n    return this._perf.timeOrigin;\n  },\n\n  /**\n   * Returns the \"absolute\" version of performance.now(), i.e. one that\n   * should ([bug 1401406](https://bugzilla.mozilla.org/show_bug.cgi?id=1401406)\n   * be comparable across both chrome and content.\n   *\n   * @return {Number}\n   */\n  absNow: function absNow() {\n    return this.timeOrigin + this._perf.now();\n  },\n\n  /**\n   * This returns the absolute startTime from the most recent performance.mark()\n   * with the given name.\n   *\n   * @param  {String} name  the name to lookup the start time for\n   *\n   * @return {Number}       the returned start time, as a DOMHighResTimeStamp\n   *\n   * @throws {Error}        \"No Marks with the name ...\" if none are available\n   *\n   * @note Always surround calls to this by try/catch.  Otherwise your code\n   * may fail when the `privacy.resistFingerprinting` pref is true.  When\n   * this pref is set, all attempts to get marks will likely fail, which will\n   * cause this method to throw.\n   *\n   * See [bug 1369303](https://bugzilla.mozilla.org/show_bug.cgi?id=1369303)\n   * for more info.\n   */\n  getMostRecentAbsMarkStartByName(name) {\n    let entries = this.getEntriesByName(name, \"mark\");\n\n    if (!entries.length) {\n      throw new Error(`No marks with the name ${name}`);\n    }\n\n    let mostRecentEntry = entries[entries.length - 1];\n    return this._perf.timeOrigin + mostRecentEntry.startTime;\n  }\n};\n\nthis.perfService = new _PerfService();\nconst EXPORTED_SYMBOLS = [\"_PerfService\", \"perfService\"];\n\n\n\n// WEBPACK FOOTER //\n// ./common/PerfService.jsm","import {actionCreators as ac, actionTypes as at} from \"common/Actions.jsm\";\nimport {FormattedMessage, injectIntl} from \"react-intl\";\nimport {\n  MIN_CORNER_FAVICON_SIZE,\n  MIN_RICH_FAVICON_SIZE,\n  TOP_SITES_CONTEXT_MENU_OPTIONS,\n  TOP_SITES_SOURCE\n} from \"./TopSitesConstants\";\nimport {LinkMenu} from \"content-src/components/LinkMenu/LinkMenu\";\nimport React from \"react\";\nimport {ScreenshotUtils} from \"content-src/lib/screenshot-utils\";\nimport {TOP_SITES_MAX_SITES_PER_ROW} from \"common/Reducers.jsm\";\n\nexport class TopSiteLink extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {screenshotImage: null};\n    this.onDragEvent = this.onDragEvent.bind(this);\n  }\n\n  /*\n   * Helper to determine whether the drop zone should allow a drop. We only allow\n   * dropping top sites for now.\n   */\n  _allowDrop(e) {\n    return e.dataTransfer.types.includes(\"text/topsite-index\");\n  }\n\n  onDragEvent(event) {\n    switch (event.type) {\n      case \"click\":\n        // Stop any link clicks if we started any dragging\n        if (this.dragged) {\n          event.preventDefault();\n        }\n        break;\n      case \"dragstart\":\n        this.dragged = true;\n        event.dataTransfer.effectAllowed = \"move\";\n        event.dataTransfer.setData(\"text/topsite-index\", this.props.index);\n        event.target.blur();\n        this.props.onDragEvent(event, this.props.index, this.props.link, this.props.title);\n        break;\n      case \"dragend\":\n        this.props.onDragEvent(event);\n        break;\n      case \"dragenter\":\n      case \"dragover\":\n      case \"drop\":\n        if (this._allowDrop(event)) {\n          event.preventDefault();\n          this.props.onDragEvent(event, this.props.index);\n        }\n        break;\n      case \"mousedown\":\n        // Reset at the first mouse event of a potential drag\n        this.dragged = false;\n        break;\n    }\n  }\n\n  /**\n   * Helper to obtain the next state based on nextProps and prevState.\n   *\n   * NOTE: Rename this method to getDerivedStateFromProps when we update React\n   *       to >= 16.3. We will need to update tests as well. We cannot rename this\n   *       method to getDerivedStateFromProps now because there is a mismatch in\n   *       the React version that we are using for both testing and production.\n   *       (i.e. react-test-render => \"16.3.2\", react => \"16.2.0\").\n   *\n   * See https://github.com/airbnb/enzyme/blob/master/packages/enzyme-adapter-react-16/package.json#L43.\n   */\n  static getNextStateFromProps(nextProps, prevState) {\n    const {screenshot} = nextProps.link;\n    const imageInState = ScreenshotUtils.isRemoteImageLocal(prevState.screenshotImage, screenshot);\n    if (imageInState) {\n      return null;\n    }\n\n    // Since image was updated, attempt to revoke old image blob URL, if it exists.\n    ScreenshotUtils.maybeRevokeBlobObjectURL(prevState.screenshotImage);\n\n    return {screenshotImage: ScreenshotUtils.createLocalImageObject(screenshot)};\n  }\n\n  // NOTE: Remove this function when we update React to >= 16.3 since React will\n  //       call getDerivedStateFromProps automatically. We will also need to\n  //       rename getNextStateFromProps to getDerivedStateFromProps.\n  componentWillMount() {\n    const nextState = TopSiteLink.getNextStateFromProps(this.props, this.state);\n    if (nextState) {\n      this.setState(nextState);\n    }\n  }\n\n  // NOTE: Remove this function when we update React to >= 16.3 since React will\n  //       call getDerivedStateFromProps automatically. We will also need to\n  //       rename getNextStateFromProps to getDerivedStateFromProps.\n  componentWillReceiveProps(nextProps) {\n    const nextState = TopSiteLink.getNextStateFromProps(nextProps, this.state);\n    if (nextState) {\n      this.setState(nextState);\n    }\n  }\n\n  componentWillUnmount() {\n    ScreenshotUtils.maybeRevokeBlobObjectURL(this.state.screenshotImage);\n  }\n\n  render() {\n    const {children, className, defaultStyle, isDraggable, link, onClick, title} = this.props;\n    const topSiteOuterClassName = `top-site-outer${className ? ` ${className}` : \"\"}${link.isDragged ? \" dragged\" : \"\"}`;\n    const {tippyTopIcon, faviconSize} = link;\n    const [letterFallback] = title;\n    let imageClassName;\n    let imageStyle;\n    let showSmallFavicon = false;\n    let smallFaviconStyle;\n    let smallFaviconFallback;\n    let hasScreenshotImage = this.state.screenshotImage && this.state.screenshotImage.url;\n    if (defaultStyle) { // force no styles (letter fallback) even if the link has imagery\n      smallFaviconFallback = false;\n    } else if (link.customScreenshotURL) {\n      // assume high quality custom screenshot and use rich icon styles and class names\n      imageClassName = \"top-site-icon rich-icon\";\n      imageStyle = {\n        backgroundColor: link.backgroundColor,\n        backgroundImage: hasScreenshotImage ? `url(${this.state.screenshotImage.url})` : \"none\"\n      };\n    } else if (tippyTopIcon || faviconSize >= MIN_RICH_FAVICON_SIZE) {\n      // styles and class names for top sites with rich icons\n      imageClassName = \"top-site-icon rich-icon\";\n      imageStyle = {\n        backgroundColor: link.backgroundColor,\n        backgroundImage: `url(${tippyTopIcon || link.favicon})`\n      };\n    } else {\n      // styles and class names for top sites with screenshot + small icon in top left corner\n      imageClassName = `screenshot${hasScreenshotImage ? \" active\" : \"\"}`;\n      imageStyle = {backgroundImage: hasScreenshotImage ? `url(${this.state.screenshotImage.url})` : \"none\"};\n\n      // only show a favicon in top left if it's greater than 16x16\n      if (faviconSize >= MIN_CORNER_FAVICON_SIZE) {\n        showSmallFavicon = true;\n        smallFaviconStyle = {backgroundImage:  `url(${link.favicon})`};\n      } else if (hasScreenshotImage) {\n        // Don't show a small favicon if there is no screenshot, because that\n        // would result in two fallback icons\n        showSmallFavicon = true;\n        smallFaviconFallback = true;\n      }\n    }\n    let draggableProps = {};\n    if (isDraggable) {\n      draggableProps = {\n        onClick: this.onDragEvent,\n        onDragEnd: this.onDragEvent,\n        onDragStart: this.onDragEvent,\n        onMouseDown: this.onDragEvent\n      };\n    }\n    return (<li className={topSiteOuterClassName} onDrop={this.onDragEvent} onDragOver={this.onDragEvent} onDragEnter={this.onDragEvent} onDragLeave={this.onDragEvent} {...draggableProps}>\n      <div className=\"top-site-inner\">\n         <a href={link.url} onClick={onClick}>\n            <div className=\"tile\" aria-hidden={true} data-fallback={letterFallback}>\n              <div className={imageClassName} style={imageStyle} />\n              {showSmallFavicon && <div\n                className=\"top-site-icon default-icon\"\n                data-fallback={smallFaviconFallback && letterFallback}\n                style={smallFaviconStyle} />}\n           </div>\n           <div className={`title ${link.isPinned ? \"pinned\" : \"\"}`}>\n             {link.isPinned && <div className=\"icon icon-pin-small\" />}\n              <span dir=\"auto\">{title}</span>\n           </div>\n         </a>\n         {children}\n      </div>\n    </li>);\n  }\n}\nTopSiteLink.defaultProps = {\n  title: \"\",\n  link: {},\n  isDraggable: true\n};\n\nexport class TopSite extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {showContextMenu: false};\n    this.onLinkClick = this.onLinkClick.bind(this);\n    this.onMenuButtonClick = this.onMenuButtonClick.bind(this);\n    this.onMenuUpdate = this.onMenuUpdate.bind(this);\n  }\n\n  /**\n   * Report to telemetry additional information about the item.\n   */\n  _getTelemetryInfo() {\n    const value = {icon_type: this.props.link.iconType};\n    // Filter out \"not_pinned\" type for being the default\n    if (this.props.link.isPinned) {\n      value.card_type = \"pinned\";\n    }\n    return {value};\n  }\n\n  userEvent(event) {\n    this.props.dispatch(ac.UserEvent(Object.assign({\n      event,\n      source: TOP_SITES_SOURCE,\n      action_position: this.props.index\n    }, this._getTelemetryInfo())));\n  }\n\n  onLinkClick(event) {\n    this.userEvent(\"CLICK\");\n\n    // Specially handle a top site link click for \"typed\" frecency bonus as\n    // specified as a property on the link.\n    event.preventDefault();\n    const {altKey, button, ctrlKey, metaKey, shiftKey} = event;\n    this.props.dispatch(ac.OnlyToMain({\n      type: at.OPEN_LINK,\n      data: Object.assign(this.props.link, {event: {altKey, button, ctrlKey, metaKey, shiftKey}})\n    }));\n  }\n\n  onMenuButtonClick(event) {\n    event.preventDefault();\n    this.props.onActivate(this.props.index);\n    this.setState({showContextMenu: true});\n  }\n\n  onMenuUpdate(showContextMenu) {\n    this.setState({showContextMenu});\n  }\n\n  render() {\n    const {props} = this;\n    const {link} = props;\n    const isContextMenuOpen = this.state.showContextMenu && props.activeIndex === props.index;\n    const title = link.label || link.hostname;\n    return (<TopSiteLink {...props} onClick={this.onLinkClick} onDragEvent={this.props.onDragEvent} className={`${props.className || \"\"}${isContextMenuOpen ? \" active\" : \"\"}`} title={title}>\n        <div>\n          <button className=\"context-menu-button icon\" onClick={this.onMenuButtonClick}>\n            <span className=\"sr-only\">\n              <FormattedMessage id=\"context_menu_button_sr\" values={{title}} />\n            </span>\n          </button>\n          {isContextMenuOpen &&\n            <LinkMenu\n              dispatch={props.dispatch}\n              index={props.index}\n              onUpdate={this.onMenuUpdate}\n              options={TOP_SITES_CONTEXT_MENU_OPTIONS}\n              site={link}\n              siteInfo={this._getTelemetryInfo()}\n              source={TOP_SITES_SOURCE} />\n          }\n        </div>\n    </TopSiteLink>);\n  }\n}\nTopSite.defaultProps = {\n  link: {},\n  onActivate() {}\n};\n\nexport class TopSitePlaceholder extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.onEditButtonClick = this.onEditButtonClick.bind(this);\n  }\n\n  onEditButtonClick() {\n    this.props.dispatch(\n      {type: at.TOP_SITES_EDIT, data: {index: this.props.index}});\n  }\n\n  render() {\n    return (<TopSiteLink {...this.props} className={`placeholder ${this.props.className || \"\"}`} isDraggable={false}>\n      <button className=\"context-menu-button edit-button icon\"\n       title={this.props.intl.formatMessage({id: \"edit_topsites_edit_button\"})}\n       onClick={this.onEditButtonClick} />\n    </TopSiteLink>);\n  }\n}\n\nexport class _TopSiteList extends React.PureComponent {\n  static get DEFAULT_STATE() {\n    return {\n      activeIndex: null,\n      draggedIndex: null,\n      draggedSite: null,\n      draggedTitle: null,\n      topSitesPreview: null\n    };\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = _TopSiteList.DEFAULT_STATE;\n    this.onDragEvent = this.onDragEvent.bind(this);\n    this.onActivate = this.onActivate.bind(this);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.state.draggedSite) {\n      const prevTopSites = this.props.TopSites && this.props.TopSites.rows;\n      const newTopSites = nextProps.TopSites && nextProps.TopSites.rows;\n      if (prevTopSites && prevTopSites[this.state.draggedIndex] &&\n        prevTopSites[this.state.draggedIndex].url === this.state.draggedSite.url &&\n        (!newTopSites[this.state.draggedIndex] || newTopSites[this.state.draggedIndex].url !== this.state.draggedSite.url)) {\n        // We got the new order from the redux store via props. We can clear state now.\n        this.setState(_TopSiteList.DEFAULT_STATE);\n      }\n    }\n  }\n\n  userEvent(event, index) {\n    this.props.dispatch(ac.UserEvent({\n      event,\n      source: TOP_SITES_SOURCE,\n      action_position: index\n    }));\n  }\n\n  onDragEvent(event, index, link, title) {\n    switch (event.type) {\n      case \"dragstart\":\n        this.dropped = false;\n        this.setState({\n          draggedIndex: index,\n          draggedSite: link,\n          draggedTitle: title,\n          activeIndex: null\n        });\n        this.userEvent(\"DRAG\", index);\n        break;\n      case \"dragend\":\n        if (!this.dropped) {\n          // If there was no drop event, reset the state to the default.\n          this.setState(_TopSiteList.DEFAULT_STATE);\n        }\n        break;\n      case \"dragenter\":\n        if (index === this.state.draggedIndex) {\n          this.setState({topSitesPreview: null});\n        } else {\n          this.setState({topSitesPreview: this._makeTopSitesPreview(index)});\n        }\n        break;\n      case \"drop\":\n        if (index !== this.state.draggedIndex) {\n          this.dropped = true;\n          this.props.dispatch(ac.AlsoToMain({\n            type: at.TOP_SITES_INSERT,\n            data: {\n              site: {\n                url: this.state.draggedSite.url,\n                label: this.state.draggedTitle,\n                customScreenshotURL: this.state.draggedSite.customScreenshotURL\n              },\n              index,\n              draggedFromIndex: this.state.draggedIndex\n            }\n          }));\n          this.userEvent(\"DROP\", index);\n        }\n        break;\n    }\n  }\n\n  _getTopSites() {\n    // Make a copy of the sites to truncate or extend to desired length\n    let topSites = this.props.TopSites.rows.slice();\n    topSites.length = this.props.TopSitesRows * TOP_SITES_MAX_SITES_PER_ROW;\n    return topSites;\n  }\n\n  /**\n   * Make a preview of the topsites that will be the result of dropping the currently\n   * dragged site at the specified index.\n   */\n  _makeTopSitesPreview(index) {\n    const topSites = this._getTopSites();\n    topSites[this.state.draggedIndex] = null;\n    const pinnedOnly = topSites.map(site => ((site && site.isPinned) ? site : null));\n    const unpinned = topSites.filter(site => site && !site.isPinned);\n    const siteToInsert = Object.assign({}, this.state.draggedSite, {isPinned: true, isDragged: true});\n    if (!pinnedOnly[index]) {\n      pinnedOnly[index] = siteToInsert;\n    } else {\n      // Find the hole to shift the pinned site(s) towards. We shift towards the\n      // hole left by the site being dragged.\n      let holeIndex = index;\n      const indexStep = index > this.state.draggedIndex ? -1 : 1;\n      while (pinnedOnly[holeIndex]) {\n        holeIndex += indexStep;\n      }\n\n      // Shift towards the hole.\n      const shiftingStep = index > this.state.draggedIndex ? 1 : -1;\n      while (holeIndex !== index) {\n        const nextIndex = holeIndex + shiftingStep;\n        pinnedOnly[holeIndex] = pinnedOnly[nextIndex];\n        holeIndex = nextIndex;\n      }\n      pinnedOnly[index] = siteToInsert;\n    }\n\n    // Fill in the remaining holes with unpinned sites.\n    const preview = pinnedOnly;\n    for (let i = 0; i < preview.length; i++) {\n      if (!preview[i]) {\n        preview[i] = unpinned.shift() || null;\n      }\n    }\n\n    return preview;\n  }\n\n  onActivate(index) {\n    this.setState({activeIndex: index});\n  }\n\n  render() {\n    const {props} = this;\n    const topSites = this.state.topSitesPreview || this._getTopSites();\n    const topSitesUI = [];\n    const commonProps = {\n      onDragEvent: this.onDragEvent,\n      dispatch: props.dispatch,\n      intl: props.intl\n    };\n    // We assign a key to each placeholder slot. We need it to be independent\n    // of the slot index (i below) so that the keys used stay the same during\n    // drag and drop reordering and the underlying DOM nodes are reused.\n    // This mostly (only?) affects linux so be sure to test on linux before changing.\n    let holeIndex = 0;\n\n    // On narrow viewports, we only show 6 sites per row. We'll mark the rest as\n    // .hide-for-narrow to hide in CSS via @media query.\n    const maxNarrowVisibleIndex = props.TopSitesRows * 6;\n\n    for (let i = 0, l = topSites.length; i < l; i++) {\n      const link = topSites[i] && Object.assign({}, topSites[i], {iconType: this.props.topSiteIconType(topSites[i])});\n      const slotProps = {\n        key: link ? link.url : holeIndex++,\n        index: i\n      };\n      if (i >= maxNarrowVisibleIndex) {\n        slotProps.className = \"hide-for-narrow\";\n      }\n      topSitesUI.push(!link ? (\n        <TopSitePlaceholder\n          {...slotProps}\n          {...commonProps} />\n      ) : (\n        <TopSite\n          link={link}\n          activeIndex={this.state.activeIndex}\n          onActivate={this.onActivate}\n          {...slotProps}\n          {...commonProps} />\n      ));\n    }\n    return (<ul className={`top-sites-list${this.state.draggedSite ? \" dnd-active\" : \"\"}`}>\n      {topSitesUI}\n    </ul>);\n  }\n}\n\nexport const TopSiteList = injectIntl(_TopSiteList);\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/TopSites/TopSite.jsx","import {actionCreators as ac, actionTypes as at} from \"common/Actions.jsm\";\nimport {addSnippetsSubscriber} from \"content-src/lib/snippets\";\nimport {Base} from \"content-src/components/Base/Base\";\nimport {DetectUserSessionStart} from \"content-src/lib/detect-user-session-start\";\nimport {initStore} from \"content-src/lib/init-store\";\nimport {Provider} from \"react-redux\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport {reducers} from \"common/Reducers.jsm\";\n\nconst store = initStore(reducers, global.gActivityStreamPrerenderedState);\n\nnew DetectUserSessionStart(store).sendEventOrAddListener();\n\n// If we are starting in a prerendered state, we must wait until the first render\n// to request state rehydration (see Base.jsx). If we are NOT in a prerendered state,\n// we can request it immedately.\nif (!global.gActivityStreamPrerenderedState) {\n  store.dispatch(ac.AlsoToMain({type: at.NEW_TAB_STATE_REQUEST}));\n}\n\nReactDOM.hydrate(<Provider store={store}>\n  <Base\n    isFirstrun={global.document.location.href === \"about:welcome\"}\n    isPrerendered={!!global.gActivityStreamPrerenderedState}\n    locale={global.document.documentElement.lang}\n    strings={global.gActivityStreamStrings} />\n</Provider>, document.getElementById(\"root\"));\n\naddSnippetsSubscriber(store);\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/activity-stream.jsx","const DATABASE_NAME = \"snippets_db\";\nconst DATABASE_VERSION = 1;\nconst SNIPPETS_OBJECTSTORE_NAME = \"snippets\";\nexport const SNIPPETS_UPDATE_INTERVAL_MS = 14400000; // 4 hours.\n\nconst SNIPPETS_ENABLED_EVENT = \"Snippets:Enabled\";\nconst SNIPPETS_DISABLED_EVENT = \"Snippets:Disabled\";\n\nimport {actionCreators as ac, actionTypes as at} from \"common/Actions.jsm\";\nimport {ASRouterContent} from \"content-src/asrouter/asrouter-content\";\n\n/**\n * SnippetsMap - A utility for cacheing values related to the snippet. It has\n *               the same interface as a Map, but is optionally backed by\n *               indexedDB for persistent storage.\n *               Call .connect() to open a database connection and restore any\n *               previously cached data, if necessary.\n *\n */\nexport class SnippetsMap extends Map {\n  constructor(dispatch) {\n    super();\n    this._db = null;\n    this._dispatch = dispatch;\n  }\n\n  set(key, value) {\n    super.set(key, value);\n    return this._dbTransaction(db => db.put(value, key));\n  }\n\n  delete(key) {\n    super.delete(key);\n    return this._dbTransaction(db => db.delete(key));\n  }\n\n  clear() {\n    super.clear();\n    this._dispatch(ac.OnlyToMain({type: at.SNIPPETS_BLOCKLIST_CLEARED}));\n    return this._dbTransaction(db => db.clear());\n  }\n\n  get blockList() {\n    return this.get(\"blockList\") || [];\n  }\n\n  /**\n   * blockSnippetById - Blocks a snippet given an id\n   *\n   * @param  {str|int} id   The id of the snippet\n   * @return {Promise}      Resolves when the id has been written to indexedDB,\n   *                        or immediately if the snippetMap is not connected\n   */\n  async blockSnippetById(id) {\n    if (!id) {\n      return;\n    }\n    const {blockList} = this;\n    if (!blockList.includes(id)) {\n      blockList.push(id);\n      this._dispatch(ac.AlsoToMain({type: at.SNIPPETS_BLOCKLIST_UPDATED, data: id}));\n      await this.set(\"blockList\", blockList);\n    }\n  }\n\n  disableOnboarding() {\n    this._dispatch(ac.AlsoToMain({type: at.DISABLE_ONBOARDING}));\n  }\n\n  showFirefoxAccounts() {\n    this._dispatch(ac.AlsoToMain({type: at.SHOW_FIREFOX_ACCOUNTS}));\n  }\n\n  getTotalBookmarksCount() {\n    return new Promise(resolve => {\n      this._dispatch(ac.OnlyToMain({type: at.TOTAL_BOOKMARKS_REQUEST}));\n      global.RPMAddMessageListener(\"ActivityStream:MainToContent\", function onMessage({data: action}) {\n        if (action.type === at.TOTAL_BOOKMARKS_RESPONSE) {\n          resolve(action.data);\n          global.RPMRemoveMessageListener(\"ActivityStream:MainToContent\", onMessage);\n        }\n      });\n    });\n  }\n\n  getAddonsInfo() {\n    return new Promise(resolve => {\n      this._dispatch(ac.OnlyToMain({type: at.ADDONS_INFO_REQUEST}));\n      global.RPMAddMessageListener(\"ActivityStream:MainToContent\", function onMessage({data: action}) {\n        if (action.type === at.ADDONS_INFO_RESPONSE) {\n          resolve(action.data);\n          global.RPMRemoveMessageListener(\"ActivityStream:MainToContent\", onMessage);\n        }\n      });\n    });\n  }\n\n  /**\n   * connect - Attaches an indexedDB back-end to the Map so that any set values\n   *           are also cached in a store. It also restores any existing values\n   *           that are already stored in the indexedDB store.\n   *\n   * @return {type}  description\n   */\n  async connect() {\n    // Open the connection\n    const db = await this._openDB();\n\n    // Restore any existing values\n    await this._restoreFromDb(db);\n\n    // Attach a reference to the db\n    this._db = db;\n  }\n\n  /**\n   * _dbTransaction - Returns a db transaction wrapped with the given modifier\n   *                  function as a Promise. If the db has not been connected,\n   *                  it resolves immediately.\n   *\n   * @param  {func} modifier A function to call with the transaction\n   * @return {obj}           A Promise that resolves when the transaction has\n   *                         completed or errored\n   */\n  _dbTransaction(modifier) {\n    if (!this._db) {\n      return Promise.resolve();\n    }\n    return new Promise((resolve, reject) => {\n      const transaction = modifier(\n        this._db\n          .transaction(SNIPPETS_OBJECTSTORE_NAME, \"readwrite\")\n          .objectStore(SNIPPETS_OBJECTSTORE_NAME)\n      );\n      transaction.onsuccess = event => resolve();\n\n      /* istanbul ignore next */\n      transaction.onerror = event => reject(transaction.error);\n    });\n  }\n\n  _openDB() {\n    return new Promise((resolve, reject) => {\n      const openRequest = indexedDB.open(DATABASE_NAME, DATABASE_VERSION);\n\n      /* istanbul ignore next */\n      openRequest.onerror = event => {\n        // Try to delete the old database so that we can start this process over\n        // next time.\n        indexedDB.deleteDatabase(DATABASE_NAME);\n        reject(event);\n      };\n\n      openRequest.onupgradeneeded = event => {\n        const db = event.target.result;\n        if (!db.objectStoreNames.contains(SNIPPETS_OBJECTSTORE_NAME)) {\n          db.createObjectStore(SNIPPETS_OBJECTSTORE_NAME);\n        }\n      };\n\n      openRequest.onsuccess = event => {\n        let db = event.target.result;\n\n        /* istanbul ignore next */\n        db.onerror = err => console.error(err); // eslint-disable-line no-console\n        /* istanbul ignore next */\n        db.onversionchange = versionChangeEvent => versionChangeEvent.target.close();\n\n        resolve(db);\n      };\n    });\n  }\n\n  _restoreFromDb(db) {\n    return new Promise((resolve, reject) => {\n      let cursorRequest;\n      try {\n        cursorRequest = db.transaction(SNIPPETS_OBJECTSTORE_NAME)\n          .objectStore(SNIPPETS_OBJECTSTORE_NAME).openCursor();\n      } catch (err) {\n        // istanbul ignore next\n        reject(err);\n        // istanbul ignore next\n        return;\n      }\n\n      /* istanbul ignore next */\n      cursorRequest.onerror = event => reject(event);\n\n      cursorRequest.onsuccess = event => {\n        let cursor = event.target.result;\n        // Populate the cache from the persistent storage.\n        if (cursor) {\n          if (cursor.value !== \"blockList\") {\n            this.set(cursor.key, cursor.value);\n          }\n          cursor.continue();\n        } else {\n          // We are done.\n          resolve();\n        }\n      };\n    });\n  }\n}\n\n/**\n * SnippetsProvider - Initializes a SnippetsMap and loads snippets from a\n *                    remote location, or else default snippets if the remote\n *                    snippets cannot be retrieved.\n */\nexport class SnippetsProvider {\n  constructor(dispatch) {\n    // Initialize the Snippets Map and attaches it to a global so that\n    // the snippet payload can interact with it.\n    global.gSnippetsMap = new SnippetsMap(dispatch);\n    this._onAction = this._onAction.bind(this);\n  }\n\n  get snippetsMap() {\n    return global.gSnippetsMap;\n  }\n\n  async _refreshSnippets() {\n    // Check if the cached version of of the snippets in snippetsMap. If it's too\n    // old, blow away the entire snippetsMap.\n    const cachedVersion = this.snippetsMap.get(\"snippets-cached-version\");\n\n    if (cachedVersion !== this.appData.version) {\n      this.snippetsMap.clear();\n    }\n\n    // Has enough time passed for us to require an update?\n    const lastUpdate = this.snippetsMap.get(\"snippets-last-update\");\n    const needsUpdate = !(lastUpdate >= 0) || Date.now() - lastUpdate > SNIPPETS_UPDATE_INTERVAL_MS;\n\n    if (needsUpdate && this.appData.snippetsURL) {\n      this.snippetsMap.set(\"snippets-last-update\", Date.now());\n      try {\n        const response = await fetch(this.appData.snippetsURL);\n        if (response.status === 200) {\n          const payload = await response.text();\n\n          this.snippetsMap.set(\"snippets\", payload);\n          this.snippetsMap.set(\"snippets-cached-version\", this.appData.version);\n        }\n      } catch (e) {\n        console.error(e); // eslint-disable-line no-console\n      }\n    }\n  }\n\n  _noSnippetFallback() {\n    // TODO\n  }\n\n  _forceOnboardingVisibility(shouldBeVisible) {\n    const onboardingEl = document.getElementById(\"onboarding-notification-bar\");\n\n    if (onboardingEl) {\n      onboardingEl.style.display = shouldBeVisible ? \"\" : \"none\";\n    }\n  }\n\n  _showRemoteSnippets() {\n    const snippetsEl = document.getElementById(this.elementId);\n    const payload = this.snippetsMap.get(\"snippets\");\n\n    if (!snippetsEl) {\n      throw new Error(`No element was found with id '${this.elementId}'.`);\n    }\n\n    // This could happen if fetching failed\n    if (!payload) {\n      throw new Error(\"No remote snippets were found in gSnippetsMap.\");\n    }\n\n    if (typeof payload !== \"string\") {\n      throw new Error(\"Snippet payload was incorrectly formatted\");\n    }\n\n    // Note that injecting snippets can throw if they're invalid XML.\n    // eslint-disable-next-line no-unsanitized/property\n    snippetsEl.innerHTML = payload;\n\n    // Scripts injected by innerHTML are inactive, so we have to relocate them\n    // through DOM manipulation to activate their contents.\n    for (const scriptEl of snippetsEl.getElementsByTagName(\"script\")) {\n      const relocatedScript = document.createElement(\"script\");\n      relocatedScript.text = scriptEl.text;\n      scriptEl.parentNode.replaceChild(relocatedScript, scriptEl);\n    }\n  }\n\n  _onAction(msg) {\n    if (msg.data.type === at.SNIPPET_BLOCKED) {\n      if (!this.snippetsMap.blockList.includes(msg.data.data)) {\n        this.snippetsMap.set(\"blockList\", this.snippetsMap.blockList.concat(msg.data.data));\n        document.getElementById(\"snippets-container\").style.display = \"none\";\n      }\n    }\n  }\n\n  /**\n   * init - Fetch the snippet payload and show snippets\n   *\n   * @param  {obj} options\n   * @param  {str} options.appData.snippetsURL  The URL from which we fetch snippets\n   * @param  {int} options.appData.version  The current snippets version\n   * @param  {str} options.elementId  The id of the element in which to inject snippets\n   * @param  {bool} options.connect  Should gSnippetsMap connect to indexedDB?\n   */\n  async init(options) {\n    Object.assign(this, {\n      appData: {},\n      elementId: \"snippets\",\n      connect: true\n    }, options);\n\n    // Add listener so we know when snippets are blocked on other pages\n    if (global.RPMAddMessageListener) {\n      global.RPMAddMessageListener(\"ActivityStream:MainToContent\", this._onAction);\n    }\n\n    // TODO: Requires enabling indexedDB on newtab\n    // Restore the snippets map from indexedDB\n    if (this.connect) {\n      try {\n        await this.snippetsMap.connect();\n      } catch (e) {\n        console.error(e); // eslint-disable-line no-console\n      }\n    }\n\n    // Cache app data values so they can be accessible from gSnippetsMap\n    for (const key of Object.keys(this.appData)) {\n      if (key === \"blockList\") {\n        this.snippetsMap.set(\"blockList\", this.appData[key]);\n      } else {\n        this.snippetsMap.set(`appData.${key}`, this.appData[key]);\n      }\n    }\n\n    // Refresh snippets, if enough time has passed.\n    await this._refreshSnippets();\n\n    // Try showing remote snippets, falling back to defaults if necessary.\n    try {\n      this._showRemoteSnippets();\n    } catch (e) {\n      this._noSnippetFallback(e);\n    }\n\n    window.dispatchEvent(new Event(SNIPPETS_ENABLED_EVENT));\n\n    this._forceOnboardingVisibility(true);\n    this.initialized = true;\n  }\n\n  uninit() {\n    window.dispatchEvent(new Event(SNIPPETS_DISABLED_EVENT));\n    this._forceOnboardingVisibility(false);\n    if (global.RPMRemoveMessageListener) {\n      global.RPMRemoveMessageListener(\"ActivityStream:MainToContent\", this._onAction);\n    }\n    this.initialized = false;\n  }\n}\n\n/**\n * addSnippetsSubscriber - Creates a SnippetsProvider that Initializes\n *                         when the store has received the appropriate\n *                         Snippet data.\n *\n * @param  {obj} store   The redux store\n * @return {obj}         Returns the snippets instance, asrouterContent instance and unsubscribe function\n */\nexport function addSnippetsSubscriber(store) {\n  const snippets = new SnippetsProvider(store.dispatch);\n  const asrouterContent = new ASRouterContent();\n\n  let initializing = false;\n\n  store.subscribe(async () => {\n    const state = store.getState();\n    const isASRouterEnabled = state.Prefs.values.asrouterExperimentEnabled && state.Prefs.values.asrouterOnboardingCohort > 0;\n    // state.Prefs.values[\"feeds.snippets\"]:  Should snippets be shown?\n    // state.Snippets.initialized             Is the snippets data initialized?\n    // snippets.initialized:                  Is SnippetsProvider currently initialised?\n    if (state.Prefs.values[\"feeds.snippets\"] &&\n      // If the message center experiment is enabled, don't show snippets\n      !isASRouterEnabled &&\n      !state.Prefs.values.disableSnippets &&\n      state.Snippets.initialized &&\n      !snippets.initialized &&\n      // Don't call init multiple times\n      !initializing &&\n      location.href !== \"about:welcome\"\n    ) {\n      initializing = true;\n      await snippets.init({appData: state.Snippets});\n      initializing = false;\n    } else if (\n      (state.Prefs.values[\"feeds.snippets\"] === false ||\n        state.Prefs.values.disableSnippets === true) &&\n      snippets.initialized\n    ) {\n      snippets.uninit();\n    }\n\n    // Turn on AS Router snippets if the experiment is enabled and the snippets pref is on;\n    // otherwise, turn it off.\n    if (\n      (state.Prefs.values.asrouterExperimentEnabled || state.Prefs.values.asrouterOnboardingCohort > 0) &&\n      state.Prefs.values[\"feeds.snippets\"] &&\n      !asrouterContent.initialized) {\n      asrouterContent.init();\n    } else if (\n      ((!state.Prefs.values.asrouterExperimentEnabled && state.Prefs.values.asrouterOnboardingCohort === 0) || !state.Prefs.values[\"feeds.snippets\"]) &&\n      asrouterContent.initialized\n    ) {\n      asrouterContent.uninit();\n    }\n  });\n\n  // These values are returned for testing purposes\n  return {snippets, asrouterContent};\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/lib/snippets.js","import { CachedIterable, mapContextSync } from \"fluent\";\n\n/*\n * `ReactLocalization` handles translation formatting and fallback.\n *\n * The current negotiated fallback chain of languages is stored in the\n * `ReactLocalization` instance in form of an iterable of `MessageContext`\n * instances.  This iterable is used to find the best existing translation for\n * a given identifier.\n *\n * `Localized` components must subscribe to the changes of the\n * `ReactLocalization`'s fallback chain.  When the fallback chain changes (the\n * `messages` iterable is set anew), all subscribed compontent must relocalize.\n *\n * The `ReactLocalization` class instances are exposed to `Localized` elements\n * via the `LocalizationProvider` component.\n */\nexport default class ReactLocalization {\n  constructor(messages) {\n    this.contexts = new CachedIterable(messages);\n    this.subs = new Set();\n  }\n\n  /*\n   * Subscribe a `Localized` component to changes of `messages`.\n   */\n  subscribe(comp) {\n    this.subs.add(comp);\n  }\n\n  /*\n   * Unsubscribe a `Localized` component from `messages` changes.\n   */\n  unsubscribe(comp) {\n    this.subs.delete(comp);\n  }\n\n  /*\n   * Set a new `messages` iterable and trigger the retranslation.\n   */\n  setMessages(messages) {\n    this.contexts = new CachedIterable(messages);\n\n    // Update all subscribed Localized components.\n    this.subs.forEach(comp => comp.relocalize());\n  }\n\n  getMessageContext(id) {\n    return mapContextSync(this.contexts, id);\n  }\n\n  formatCompound(mcx, msg, args) {\n    const value = mcx.format(msg, args);\n\n    if (msg.attrs) {\n      var attrs = {};\n      for (const name of Object.keys(msg.attrs)) {\n        attrs[name] = mcx.format(msg.attrs[name], args);\n      }\n    }\n\n    return { value, attrs };\n  }\n\n  /*\n   * Find a translation by `id` and format it to a string using `args`.\n   */\n  getString(id, args, fallback) {\n    const mcx = this.getMessageContext(id);\n\n    if (mcx === null) {\n      return fallback || id;\n    }\n\n    const msg = mcx.getMessage(id);\n    return mcx.format(msg, args);\n  }\n}\n\nexport function isReactLocalization(props, propName) {\n  const prop = props[propName];\n\n  if (prop instanceof ReactLocalization) {\n    return null;\n  }\n\n  return new Error(\n    `The ${propName} context field must be an instance of ReactLocalization.`\n  );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent-react/src/localization.js","import { Component, Children } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport ReactLocalization, { isReactLocalization} from \"./localization\";\n\n/*\n * The Provider component for the `ReactLocalization` class.\n *\n * Exposes a `ReactLocalization` instance to all descendants via React's\n * context feature.  It makes translations available to all localizable\n * elements in the descendant's render tree without the need to pass them\n * explicitly.\n *\n *     <LocalizationProvider messages={}>\n *         \n *     </LocalizationProvider>\n *\n * The `LocalizationProvider` component takes one prop: `messages`.  It should\n * be an iterable of `MessageContext` instances in order of the user's\n * preferred languages.  The `MessageContext` instances will be used by\n * `ReactLocalization` to format translations.  If a translation is missing in\n * one instance, `ReactLocalization` will fall back to the next one.\n */\nexport default class LocalizationProvider extends Component {\n  constructor(props) {\n    super(props);\n    const { messages } = props;\n\n    if (messages === undefined) {\n      throw new Error(\"LocalizationProvider must receive the messages prop.\");\n    }\n\n    if (!messages[Symbol.iterator]) {\n      throw new Error(\"The messages prop must be an iterable.\");\n    }\n\n    this.l10n = new ReactLocalization(messages);\n  }\n\n  getChildContext() {\n    return {\n      l10n: this.l10n\n    };\n  }\n\n  componentWillReceiveProps(next) {\n    const { messages } = next;\n\n    if (messages !== this.props.messages) {\n      this.l10n.setMessages(messages);\n    }\n  }\n\n  render() {\n    return Children.only(this.props.children);\n  }\n}\n\nLocalizationProvider.childContextTypes = {\n  l10n: isReactLocalization\n};\n\nLocalizationProvider.propTypes = {\n  children: PropTypes.element.isRequired,\n  messages: isIterable\n};\n\nfunction isIterable(props, propName, componentName) {\n  const prop = props[propName];\n\n  if (Symbol.iterator in Object(prop)) {\n    return null;\n  }\n\n  return new Error(\n    `The ${propName} prop supplied to ${componentName} must be an iterable.`\n  );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent-react/src/provider.js","import { createElement, Component } from \"react\";\n\nimport { isReactLocalization } from \"./localization\";\n\nexport default function withLocalization(Inner) {\n  class WithLocalization extends Component {\n    componentDidMount() {\n      const { l10n } = this.context;\n\n      if (l10n) {\n        l10n.subscribe(this);\n      }\n    }\n\n    componentWillUnmount() {\n      const { l10n } = this.context;\n\n      if (l10n) {\n        l10n.unsubscribe(this);\n      }\n    }\n\n    /*\n     * Rerender this component in a new language.\n     */\n    relocalize() {\n      // When the `ReactLocalization`'s fallback chain changes, update the\n      // component.\n      this.forceUpdate();\n    }\n\n    /*\n     * Find a translation by `id` and format it to a string using `args`.\n     */\n    getString(id, args, fallback) {\n      const { l10n } = this.context;\n\n      if (!l10n) {\n        return fallback || id;\n      }\n\n      return l10n.getString(id, args, fallback);\n    }\n\n    render() {\n      return createElement(\n        Inner,\n        Object.assign(\n          // getString needs to be re-bound on updates to trigger a re-render\n          { getString: (...args) => this.getString(...args) },\n          this.props\n        )\n      );\n    }\n  }\n\n  WithLocalization.displayName = `WithLocalization(${displayName(Inner)})`;\n\n  WithLocalization.contextTypes = {\n    l10n: isReactLocalization\n  };\n\n  return WithLocalization;\n}\n\nfunction displayName(component) {\n  return component.displayName || component.name || \"Component\";\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent-react/src/with_localization.js","/* eslint-env browser */\n\nconst TEMPLATE = document.createElement(\"template\");\n\nexport function parseMarkup(str) {\n  TEMPLATE.innerHTML = str;\n  return TEMPLATE.content;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent-react/src/markup.js","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in this directory.\n */\n\n// For HTML, certain tags should omit their close tag. We keep a whitelist for\n// those special-case tags.\n\nvar omittedCloseTags = {\n  area: true,\n  base: true,\n  br: true,\n  col: true,\n  embed: true,\n  hr: true,\n  img: true,\n  input: true,\n  keygen: true,\n  link: true,\n  meta: true,\n  param: true,\n  source: true,\n  track: true,\n  wbr: true,\n  // NOTE: menuitem's close tag should be omitted, but that causes problems.\n};\n\nexport default omittedCloseTags;\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent-react/vendor/omittedCloseTags.js","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in this directory.\n */\n\nimport omittedCloseTags from './omittedCloseTags';\n\n// For HTML, certain tags cannot have children. This has the same purpose as\n// `omittedCloseTags` except that `menuitem` should still have its closing tag.\n\nvar voidElementTags = {\n  menuitem: true,\n  ...omittedCloseTags,\n};\n\nexport default voidElementTags;\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent-react/vendor/voidElementTags.js","import { isValidElement, cloneElement, Component, Children } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { isReactLocalization } from \"./localization\";\nimport { parseMarkup } from \"./markup\";\nimport VOID_ELEMENTS from \"../vendor/voidElementTags\";\n\n// Match the opening angle bracket (<) in HTML tags, and HTML entities like\n// &amp;, &#0038;, &#x0026;.\nconst reMarkup = /<|&#?\\w+;/;\n\n/*\n * Prepare props passed to `Localized` for formatting.\n */\nfunction toArguments(props) {\n  const args = {};\n  const elems = {};\n\n  for (const [propname, propval] of Object.entries(props)) {\n    if (propname.startsWith(\"$\")) {\n      const name = propname.substr(1);\n      args[name] = propval;\n    } else if (isValidElement(propval)) {\n      // We'll try to match localNames of elements found in the translation with\n      // names of elements passed as props. localNames are always lowercase.\n      const name = propname.toLowerCase();\n      elems[name] = propval;\n    }\n  }\n\n  return [args, elems];\n}\n\n/*\n * The `Localized` class renders its child with translated props and children.\n *\n *     <Localized id=\"hello-world\">\n *         <p>{'Hello, world!'}</p>\n *     </Localized>\n *\n * The `id` prop should be the unique identifier of the translation.  Any\n * attributes found in the translation will be applied to the wrapped element.\n *\n * Arguments to the translation can be passed as `$`-prefixed props on\n * `Localized`.\n *\n *     <Localized id=\"hello-world\" $username={name}>\n *         <p>{'Hello, { $username }!'}</p>\n *     </Localized>\n *\n *  It's recommended that the contents of the wrapped component be a string\n *  expression.  The string will be used as the ultimate fallback if no\n *  translation is available.  It also makes it easy to grep for strings in the\n *  source code.\n */\nexport default class Localized extends Component {\n  componentDidMount() {\n    const { l10n } = this.context;\n\n    if (l10n) {\n      l10n.subscribe(this);\n    }\n  }\n\n  componentWillUnmount() {\n    const { l10n } = this.context;\n\n    if (l10n) {\n      l10n.unsubscribe(this);\n    }\n  }\n\n  /*\n   * Rerender this component in a new language.\n   */\n  relocalize() {\n    // When the `ReactLocalization`'s fallback chain changes, update the\n    // component.\n    this.forceUpdate();\n  }\n\n  render() {\n    const { l10n } = this.context;\n    const { id, attrs, children } = this.props;\n    const elem = Children.only(children);\n\n    if (!l10n) {\n      // Use the wrapped component as fallback.\n      return elem;\n    }\n\n    const mcx = l10n.getMessageContext(id);\n\n    if (mcx === null) {\n      // Use the wrapped component as fallback.\n      return elem;\n    }\n\n    const msg = mcx.getMessage(id);\n    const [args, elems] = toArguments(this.props);\n    const {\n      value: messageValue,\n      attrs: messageAttrs\n    } = l10n.formatCompound(mcx, msg, args);\n\n    // The default is to forbid all message attributes. If the attrs prop exists\n    // on the Localized instance, only set message attributes which have been\n    // explicitly allowed by the developer.\n    if (attrs && messageAttrs) {\n      var localizedProps = {};\n\n      for (const [name, value] of Object.entries(messageAttrs)) {\n        if (attrs[name]) {\n          localizedProps[name] = value;\n        }\n      }\n    }\n\n    // If the wrapped component is a known void element, explicitly dismiss the\n    // message value and do not pass it to cloneElement in order to avoid the\n    // \"void element tags must neither have `children` nor use\n    // `dangerouslySetInnerHTML`\" error.\n    if (elem.type in VOID_ELEMENTS) {\n      return cloneElement(elem, localizedProps);\n    }\n\n    // If the message has a null value, we're only interested in its attributes.\n    // Do not pass the null value to cloneElement as it would nuke all children\n    // of the wrapped component.\n    if (messageValue === null) {\n      return cloneElement(elem, localizedProps);\n    }\n\n    // If the message value doesn't contain any markup nor any HTML entities,\n    // insert it as the only child of the wrapped component.\n    if (!reMarkup.test(messageValue)) {\n      return cloneElement(elem, localizedProps, messageValue);\n    }\n\n    // If the message contains markup, parse it and try to match the children\n    // found in the translation with the props passed to this Localized.\n    const translationNodes = Array.from(parseMarkup(messageValue).childNodes);\n    const translatedChildren = translationNodes.map(childNode => {\n      if (childNode.nodeType === childNode.TEXT_NODE) {\n        return childNode.textContent;\n      }\n\n      // If the child is not expected just take its textContent.\n      if (!elems.hasOwnProperty(childNode.localName)) {\n        return childNode.textContent;\n      }\n\n      const sourceChild = elems[childNode.localName];\n\n      // If the element passed as a prop to <Localized> is a known void element,\n      // explicitly dismiss any textContent which might have accidentally been\n      // defined in the translation to prevent the \"void element tags must not\n      // have children\" error.\n      if (sourceChild.type in VOID_ELEMENTS) {\n        return sourceChild;\n      }\n\n      // TODO Protect contents of elements wrapped in <Localized>\n      // https://github.com/projectfluent/fluent.js/issues/184\n      // TODO  Control localizable attributes on elements passed as props\n      // https://github.com/projectfluent/fluent.js/issues/185\n      return cloneElement(sourceChild, null, childNode.textContent);\n    });\n\n    return cloneElement(elem, localizedProps, ...translatedChildren);\n  }\n}\n\nLocalized.contextTypes = {\n  l10n: isReactLocalization\n};\n\nLocalized.propTypes = {\n  children: PropTypes.element.isRequired,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent-react/src/localized.js","/*\n * @module fluent-react\n * @overview\n *\n\n * `fluent-react` provides React bindings for Fluent.  It takes advantage of\n * React's Components system and the virtual DOM.  Translations are exposed to\n * components via the provider pattern.\n *\n *     <LocalizationProvider messages={}>\n *         <Localized id=\"hello-world\">\n *             <p>{'Hello, world!'}</p>\n *         </Localized>\n *     </LocalizationProvider>\n *\n * Consult the documentation of the `LocalizationProvider` and the `Localized`\n * components for more information.\n */\n\nexport { default as LocalizationProvider } from \"./provider\";\nexport { default as withLocalization } from \"./with_localization\";\nexport { default as Localized } from \"./localized\";\nexport { default as ReactLocalization, isReactLocalization }\n  from \"./localization\";\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/fluent-react/src/index.js","module.exports = Redux;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Redux\"\n// module id = 26\n// module chunks = 0","import React from \"react\";\n\nexport const VISIBLE = \"visible\";\nexport const VISIBILITY_CHANGE_EVENT = \"visibilitychange\";\n\n/**\n * Component wrapper used to send telemetry pings on every impression.\n */\nexport class ImpressionsWrapper extends React.PureComponent {\n  // This sends an event when a user sees a set of new content. If content\n  // changes while the page is hidden (i.e. preloaded or on a hidden tab),\n  // only send the event if the page becomes visible again.\n  sendImpressionOrAddListener() {\n    if (this.props.document.visibilityState === VISIBLE) {\n      this.props.sendImpression({id: this.props.id});\n    } else {\n      // We should only ever send the latest impression stats ping, so remove any\n      // older listeners.\n      if (this._onVisibilityChange) {\n        this.props.document.removeEventListener(VISIBILITY_CHANGE_EVENT, this._onVisibilityChange);\n      }\n\n      // When the page becomes visible, send the impression stats ping if the section isn't collapsed.\n      this._onVisibilityChange = () => {\n        if (this.props.document.visibilityState === VISIBLE) {\n          this.props.sendImpression({id: this.props.id});\n          this.props.document.removeEventListener(VISIBILITY_CHANGE_EVENT, this._onVisibilityChange);\n        }\n      };\n      this.props.document.addEventListener(VISIBILITY_CHANGE_EVENT, this._onVisibilityChange);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this._onVisibilityChange) {\n      this.props.document.removeEventListener(VISIBILITY_CHANGE_EVENT, this._onVisibilityChange);\n    }\n  }\n\n  componentDidMount() {\n    if (this.props.sendOnMount) {\n      this.sendImpressionOrAddListener();\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.shouldSendImpressionOnUpdate(this.props, prevProps)) {\n      this.sendImpressionOrAddListener();\n    }\n  }\n\n  render() {\n    return this.props.children;\n  }\n}\n\nImpressionsWrapper.defaultProps = {\n  document: global.document,\n  sendOnMount: true\n};\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/asrouter/components/ImpressionsWrapper/ImpressionsWrapper.jsx","import React from \"react\";\n\nexport class ModalOverlay extends React.PureComponent {\n  componentWillMount() {\n    this.setState({active: true});\n    document.body.classList.add(\"modal-open\");\n  }\n\n  componentWillUnmount() {\n    document.body.classList.remove(\"modal-open\");\n    this.setState({active: false});\n  }\n\n  render() {\n    const {active} = this.state;\n    const {title, button_label} = this.props;\n    return (\n      <div>\n        <div className={`modalOverlayOuter ${active ? \"active\" : \"\"}`} />\n        <div className={`modalOverlayInner ${active ? \"active\" : \"\"}`}>\n          <h2> {title} </h2>\n          {this.props.children}\n          <div className=\"footer\">\n            <button onClick={this.props.onDoneButton} className=\"button primary modalButton\"> {button_label} </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/asrouter/components/ModalOverlay/ModalOverlay.jsx","import {ModalOverlay} from \"../../components/ModalOverlay/ModalOverlay\";\nimport React from \"react\";\n\nclass OnboardingCard extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.onClick = this.onClick.bind(this);\n  }\n\n  onClick() {\n    const {props} = this;\n    props.sendUserActionTelemetry({event: \"CLICK_BUTTON\", message_id: props.id, id: props.UISurface});\n    props.onAction(props.content);\n  }\n\n  render() {\n    const {content} = this.props;\n    return (\n      <div className=\"onboardingMessage\">\n        <div className={`onboardingMessageImage ${content.icon}`} />\n        <div className=\"onboardingContent\">\n          <span>\n            <h3> {content.title} </h3>\n            <p> {content.text} </p>\n          </span>\n          <span>\n            <button className=\"button onboardingButton\" onClick={this.onClick}> {content.button_label} </button>\n          </span>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport class OnboardingMessage extends React.PureComponent {\n  render() {\n    const {props} = this;\n    return (\n      <ModalOverlay {...props} button_label={\"Start Browsing\"} title={\"Welcome to Firefox\"}>\n        <div className=\"onboardingMessageContainer\">\n          {props.bundle.map(message => (\n            <OnboardingCard key={message.id}\n              sendUserActionTelemetry={props.sendUserActionTelemetry}\n              onAction={props.onAction}\n              UISurface={props.UISurface}\n              {...message} />\n          ))}\n        </div>\n      </ModalOverlay>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/asrouter/templates/OnboardingMessage/OnboardingMessage.jsx","import React from \"react\";\nimport {safeURI} from \"../../template-utils\";\n\nconst ALLOWED_STYLE_TAGS = [\"color\", \"backgroundColor\"];\n\nexport const Button = props => {\n  const style = {};\n\n  // Add allowed style tags from props, e.g. props.color becomes style={color: props.color}\n  for (const tag of ALLOWED_STYLE_TAGS) {\n    if (typeof props[tag] !== \"undefined\") {\n      style[tag] = props[tag];\n    }\n  }\n  // remove border if bg is set to something custom\n  if (style.backgroundColor) {\n    style.border = \"0\";\n  }\n\n  return (<a href={safeURI(props.url)}\n    onClick={props.onClick}\n    className={props.className || \"ASRouterButton\"}\n    style={style}>\n    {props.children}\n  </a>);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/asrouter/components/Button/Button.jsx","import React from \"react\";\n\nexport class SnippetBase extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.onBlockClicked = this.onBlockClicked.bind(this);\n  }\n\n  onBlockClicked() {\n    this.props.sendUserActionTelemetry({event: \"BLOCK\", id: this.props.UISurface});\n    this.props.onBlock();\n  }\n\n  render() {\n    const {props} = this;\n\n    const containerClassName = `SnippetBaseContainer${props.className ? ` ${props.className}` : \"\"}`;\n\n    return (<div className={containerClassName}>\n      <div className=\"innerWrapper\">\n        {props.children}\n      </div>\n      <button className=\"blockButton\" onClick={this.onBlockClicked} />\n    </div>);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/asrouter/components/SnippetBase/SnippetBase.jsx","import {Button} from \"../../components/Button/Button\";\nimport React from \"react\";\nimport {safeURI} from \"../../template-utils\";\nimport {SnippetBase} from \"../../components/SnippetBase/SnippetBase\";\n\nconst DEFAULT_ICON_PATH = \"chrome://branding/content/icon64.png\";\n\nexport class SimpleSnippet extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.onButtonClick = this.onButtonClick.bind(this);\n  }\n\n  onButtonClick() {\n    this.props.sendUserActionTelemetry({event: \"CLICK_BUTTON\", id: this.props.UISurface});\n  }\n\n  renderTitle() {\n    const {title} = this.props.content;\n    return title ? <h3 className=\"title\">{title}</h3> : null;\n  }\n\n  renderTitleIcon() {\n    const titleIcon = safeURI(this.props.content.title_icon);\n    return titleIcon ? <span className=\"titleIcon\" style={{backgroundImage: `url(\"${titleIcon}\")`}} /> : null;\n  }\n\n  renderButton(className) {\n    const {props} = this;\n    return (<Button\n      className={className}\n      onClick={this.onButtonClick}\n      url={props.content.button_url}\n      color={props.content.button_color}\n      backgroundColor={props.content.button_background_color}>\n      {props.content.button_label}\n    </Button>);\n  }\n\n  render() {\n    const {props} = this;\n    const hasLink = props.content.button_url && props.content.button_type === \"anchor\";\n    const hasButton = props.content.button_url && !props.content.button_type;\n    const className = `SimpleSnippet${props.content.tall ? \" tall\" : \"\"}`;\n    return (<SnippetBase {...props} className={className}>\n      <img src={safeURI(props.content.icon) || DEFAULT_ICON_PATH} className=\"icon\" />\n      <div>\n        {this.renderTitleIcon()} {this.renderTitle()} <p className=\"body\">{props.richText || props.content.text}</p> {hasLink ? this.renderButton(\"ASRouterAnchor\") : null}\n      </div>\n      {hasButton ? <div>{this.renderButton()}</div> : null}\n    </SnippetBase>);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/asrouter/templates/SimpleSnippet/SimpleSnippet.jsx","import {actionCreators as ac, actionTypes as at} from \"common/Actions.jsm\";\nimport {addLocaleData, injectIntl, IntlProvider} from \"react-intl\";\nimport {ASRouterAdmin} from \"content-src/components/ASRouterAdmin/ASRouterAdmin\";\nimport {ConfirmDialog} from \"content-src/components/ConfirmDialog/ConfirmDialog\";\nimport {connect} from \"react-redux\";\nimport {ErrorBoundary} from \"content-src/components/ErrorBoundary/ErrorBoundary\";\nimport {ManualMigration} from \"content-src/components/ManualMigration/ManualMigration\";\nimport {PrerenderData} from \"common/PrerenderData.jsm\";\nimport React from \"react\";\nimport {Search} from \"content-src/components/Search/Search\";\nimport {Sections} from \"content-src/components/Sections/Sections\";\nimport {StartupOverlay} from \"content-src/components/StartupOverlay/StartupOverlay\";\n\nconst PrefsButton = injectIntl(props => (\n  <div className=\"prefs-button\">\n    <button className=\"icon icon-settings\" onClick={props.onClick} title={props.intl.formatMessage({id: \"settings_pane_button_label\"})} />\n  </div>\n));\n\n// Add the locale data for pluralization and relative-time formatting for now,\n// this just uses english locale data. We can make this more sophisticated if\n// more features are needed.\nfunction addLocaleDataForReactIntl(locale) {\n  addLocaleData([{locale, parentLocale: \"en\"}]);\n}\n\nexport class _Base extends React.PureComponent {\n  componentWillMount() {\n    const {App, locale} = this.props;\n    this.sendNewTabRehydrated(App);\n    addLocaleDataForReactIntl(locale);\n  }\n\n  componentDidMount() {\n    // Request state AFTER the first render to ensure we don't cause the\n    // prerendered DOM to be unmounted. Otherwise, NEW_TAB_STATE_REQUEST is\n    // dispatched right after the store is ready.\n    if (this.props.isPrerendered) {\n      this.props.dispatch(ac.AlsoToMain({type: at.NEW_TAB_STATE_REQUEST}));\n      this.props.dispatch(ac.AlsoToMain({type: at.PAGE_PRERENDERED}));\n    }\n  }\n\n  componentWillUnmount() {\n    this.updateTheme();\n  }\n\n  componentWillUpdate({App}) {\n    this.updateTheme();\n    this.sendNewTabRehydrated(App);\n  }\n\n  updateTheme() {\n    const bodyClassName = [\n      \"activity-stream\",\n      this.props.isFirstrun ? \"welcome\" : \"\"\n    ].filter(v => v).join(\" \");\n    global.document.body.className = bodyClassName;\n  }\n\n  // The NEW_TAB_REHYDRATED event is used to inform feeds that their\n  // data has been consumed e.g. for counting the number of tabs that\n  // have rendered that data.\n  sendNewTabRehydrated(App) {\n    if (App && App.initialized && !this.renderNotified) {\n      this.props.dispatch(ac.AlsoToMain({type: at.NEW_TAB_REHYDRATED, data: {}}));\n      this.renderNotified = true;\n    }\n  }\n\n  render() {\n    const {props} = this;\n    const {App, locale, strings} = props;\n    const {initialized} = App;\n\n    const prefs = props.Prefs.values;\n    if ((prefs.asrouterExperimentEnabled || prefs.asrouterOnboardingCohort > 0) && window.location.hash === \"#asrouter\") {\n      return (<ASRouterAdmin />);\n    }\n\n    if (!props.isPrerendered && !initialized) {\n      return null;\n    }\n\n    // Until we can delete the existing onboarding tour, just hide the onboarding button when users are in\n    // the new simplified onboarding experiment. CSS hacks ftw\n    if (prefs.asrouterOnboardingCohort > 0) {\n      global.document.body.classList.add(\"hide-onboarding\");\n    }\n\n    return (<IntlProvider locale={locale} messages={strings}>\n        <ErrorBoundary className=\"base-content-fallback\">\n          <BaseContent {...this.props} />\n        </ErrorBoundary>\n      </IntlProvider>);\n  }\n}\n\nexport class BaseContent extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.openPreferences = this.openPreferences.bind(this);\n  }\n\n  openPreferences() {\n    this.props.dispatch(ac.OnlyToMain({type: at.SETTINGS_OPEN}));\n    this.props.dispatch(ac.UserEvent({event: \"OPEN_NEWTAB_PREFS\"}));\n  }\n\n  render() {\n    const {props} = this;\n    const {App} = props;\n    const {initialized} = App;\n    const prefs = props.Prefs.values;\n\n    const shouldBeFixedToTop = PrerenderData.arePrefsValid(name => prefs[name]);\n\n    const outerClassName = [\n      \"outer-wrapper\",\n      shouldBeFixedToTop && \"fixed-to-top\"\n    ].filter(v => v).join(\" \");\n\n    return (\n      <div>\n        <div className={outerClassName}>\n          <main>\n            {prefs.showSearch &&\n              <div className=\"non-collapsible-section\">\n                <ErrorBoundary>\n                  <Search />\n                </ErrorBoundary>\n              </div>\n            }\n            <div className={`body-wrapper${(initialized ? \" on\" : \"\")}`}>\n              {!prefs.migrationExpired &&\n                <div className=\"non-collapsible-section\">\n                  <ManualMigration />\n                </div>\n                }\n              <Sections />\n              <PrefsButton onClick={this.openPreferences} />\n            </div>\n            <ConfirmDialog />\n          </main>\n        </div>\n        {this.props.isFirstrun && <StartupOverlay />}\n      </div>);\n  }\n}\n\nexport const Base = connect(state => ({App: state.App, Prefs: state.Prefs}))(_Base);\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/Base/Base.jsx","import {ASRouterUtils} from \"../../asrouter/asrouter-content\";\nimport React from \"react\";\n\nexport class ASRouterAdmin extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.onMessage = this.onMessage.bind(this);\n    this.findOtherBundledMessagesOfSameTemplate = this.findOtherBundledMessagesOfSameTemplate.bind(this);\n    this.state = {};\n  }\n\n  onMessage({data: action}) {\n    if (action.type === \"ADMIN_SET_STATE\") {\n      this.setState(action.data);\n    }\n  }\n\n  componentWillMount() {\n    const endpoint = ASRouterUtils.getEndpoint();\n    ASRouterUtils.sendMessage({type: \"ADMIN_CONNECT_STATE\", data: {endpoint}});\n    ASRouterUtils.addListener(this.onMessage);\n  }\n\n  componentWillUnmount() {\n    ASRouterUtils.removeListener(this.onMessage);\n  }\n\n  findOtherBundledMessagesOfSameTemplate(template) {\n    return this.state.messages.filter(msg => msg.template === template && msg.bundled);\n  }\n\n  handleBlock(msg) {\n    if (msg.bundled) {\n      // If we are blocking a message that belongs to a bundle, block all other messages that are bundled of that same template\n      let bundle = this.findOtherBundledMessagesOfSameTemplate(msg.template);\n      return () => ASRouterUtils.blockBundle(bundle);\n    }\n    return () => ASRouterUtils.blockById(msg.id);\n  }\n\n  handleUnblock(msg) {\n    if (msg.bundled) {\n      // If we are unblocking a message that belongs to a bundle, unblock all other messages that are bundled of that same template\n      let bundle = this.findOtherBundledMessagesOfSameTemplate(msg.template);\n      return () => ASRouterUtils.unblockBundle(bundle);\n    }\n    return () => ASRouterUtils.unblockById(msg.id);\n  }\n\n  handleOverride(id) {\n    return () => ASRouterUtils.overrideMessage(id);\n  }\n\n  renderMessageItem(msg) {\n    const isCurrent = msg.id === this.state.lastMessageId;\n    const isBlocked = this.state.blockList.includes(msg.id);\n\n    let itemClassName = \"message-item\";\n    if (isCurrent) { itemClassName += \" current\"; }\n    if (isBlocked) { itemClassName += \" blocked\"; }\n\n    return (<tr className={itemClassName} key={msg.id}>\n      <td className=\"message-id\"><span>{msg.id}</span></td>\n      <td>\n        <button className={`button ${(isBlocked ? \"\" : \" primary\")}`} onClick={isBlocked ? this.handleUnblock(msg) : this.handleBlock(msg)}>{isBlocked ? \"Unblock\" : \"Block\"}</button>\n       {isBlocked ? null : <button className=\"button\" onClick={this.handleOverride(msg.id)}>Show</button>}\n      </td>\n      <td className=\"message-summary\">\n        <pre>{JSON.stringify(msg, null, 2)}</pre>\n      </td>\n    </tr>);\n  }\n\n  renderMessages() {\n    if (!this.state.messages) {\n      return null;\n    }\n    return (<table><tbody>\n      {this.state.messages.map(msg => this.renderMessageItem(msg))}\n    </tbody></table>);\n  }\n\n  renderProviders() {\n    return (<table><tbody>\n      {this.state.providers.map((provider, i) => (<tr className=\"message-item\" key={i}>\n        <td>{provider.id}</td>\n        <td>{provider.type === \"remote\" ? <a target=\"_blank\" href={provider.url}>{provider.url}</a> : \"(local)\"}</td>\n      </tr>))}\n    </tbody></table>);\n  }\n\n  render() {\n    return (<div className=\"asrouter-admin outer-wrapper\">\n      <h1>AS Router Admin</h1>\n      <button className=\"button primary\" onClick={ASRouterUtils.getNextMessage}>Refresh Current Message</button>\n      <h2>Message Providers</h2>\n      {this.state.providers ? this.renderProviders() : null}\n      <h2>Messages</h2>\n      {this.renderMessages()}\n    </div>);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/ASRouterAdmin/ASRouterAdmin.jsx","import {actionCreators as ac, actionTypes} from \"common/Actions.jsm\";\nimport {connect} from \"react-redux\";\nimport {FormattedMessage} from \"react-intl\";\nimport React from \"react\";\n\n/**\n * ConfirmDialog component.\n * One primary action button, one cancel button.\n *\n * Content displayed is controlled by `data` prop the component receives.\n * Example:\n * data: {\n *   // Any sort of data needed to be passed around by actions.\n *   payload: site.url,\n *   // Primary button AlsoToMain action.\n *   action: \"DELETE_HISTORY_URL\",\n *   // Primary button USerEvent action.\n *   userEvent: \"DELETE\",\n *   // Array of locale ids to display.\n *   message_body: [\"confirm_history_delete_p1\", \"confirm_history_delete_notice_p2\"],\n *   // Text for primary button.\n *   confirm_button_string_id: \"menu_action_delete\"\n * },\n */\nexport class _ConfirmDialog extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this._handleCancelBtn = this._handleCancelBtn.bind(this);\n    this._handleConfirmBtn = this._handleConfirmBtn.bind(this);\n  }\n\n  _handleCancelBtn() {\n    this.props.dispatch({type: actionTypes.DIALOG_CANCEL});\n    this.props.dispatch(ac.UserEvent({event: actionTypes.DIALOG_CANCEL, source: this.props.data.eventSource}));\n  }\n\n  _handleConfirmBtn() {\n    this.props.data.onConfirm.forEach(this.props.dispatch);\n  }\n\n  _renderModalMessage() {\n    const message_body = this.props.data.body_string_id;\n\n    if (!message_body) {\n      return null;\n    }\n\n    return (<span>\n      {message_body.map(msg => <p key={msg}><FormattedMessage id={msg} /></p>)}\n    </span>);\n  }\n\n  render() {\n    if (!this.props.visible) {\n      return null;\n    }\n\n    return (<div className=\"confirmation-dialog\">\n      <div className=\"modal-overlay\" onClick={this._handleCancelBtn} />\n      <div className=\"modal\">\n        <section className=\"modal-message\">\n          {this.props.data.icon && <span className={`icon icon-spacer icon-${this.props.data.icon}`} />}\n          {this._renderModalMessage()}\n        </section>\n        <section className=\"actions\">\n          <button onClick={this._handleCancelBtn}>\n            <FormattedMessage id={this.props.data.cancel_button_string_id} />\n          </button>\n          <button className=\"done\" onClick={this._handleConfirmBtn}>\n            <FormattedMessage id={this.props.data.confirm_button_string_id} />\n          </button>\n        </section>\n      </div>\n    </div>);\n  }\n}\n\nexport const ConfirmDialog = connect(state => state.Dialog)(_ConfirmDialog);\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/ConfirmDialog/ConfirmDialog.jsx","import {actionCreators as ac, actionTypes as at} from \"common/Actions.jsm\";\nimport {connect} from \"react-redux\";\nimport {FormattedMessage} from \"react-intl\";\nimport React from \"react\";\n\n/**\n * Manual migration component used to start the profile import wizard.\n * Message is presented temporarily and will go away if:\n * 1.  User clicks \"No Thanks\"\n * 2.  User completed the data import\n * 3.  After 3 active days\n * 4.  User clicks \"Cancel\" on the import wizard (currently not implemented).\n */\nexport class _ManualMigration extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.onLaunchTour = this.onLaunchTour.bind(this);\n    this.onCancelTour = this.onCancelTour.bind(this);\n  }\n\n  onLaunchTour() {\n    this.props.dispatch(ac.AlsoToMain({type: at.MIGRATION_START}));\n    this.props.dispatch(ac.UserEvent({event: at.MIGRATION_START}));\n  }\n\n  onCancelTour() {\n    this.props.dispatch(ac.AlsoToMain({type: at.MIGRATION_CANCEL}));\n    this.props.dispatch(ac.UserEvent({event: at.MIGRATION_CANCEL}));\n  }\n\n  render() {\n    return (<div className=\"manual-migration-container\">\n        <p>\n          <span className=\"icon icon-import\" />\n          <FormattedMessage id=\"manual_migration_explanation2\" />\n        </p>\n        <div className=\"manual-migration-actions actions\">\n          <button className=\"dismiss\" onClick={this.onCancelTour}>\n            <FormattedMessage id=\"manual_migration_cancel_button\" />\n          </button>\n          <button onClick={this.onLaunchTour}>\n            <FormattedMessage id=\"manual_migration_import_button\" />\n          </button>\n        </div>\n    </div>);\n  }\n}\n\nexport const ManualMigration = connect()(_ManualMigration);\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/ManualMigration/ManualMigration.jsx","class _PrerenderData {\n  constructor(options) {\n    this.initialPrefs = options.initialPrefs;\n    this.initialSections = options.initialSections;\n    this._setValidation(options.validation);\n  }\n\n  get validation() {\n    return this._validation;\n  }\n\n  set validation(value) {\n    this._setValidation(value);\n  }\n\n  get invalidatingPrefs() {\n    return this._invalidatingPrefs;\n  }\n\n    // This is needed so we can use it in the constructor\n  _setValidation(value = []) {\n    this._validation = value;\n    this._invalidatingPrefs = value.reduce((result, next) => {\n      if (typeof next === \"string\") {\n        result.push(next);\n        return result;\n      } else if (next && next.oneOf) {\n        return result.concat(next.oneOf);\n      } else if (next && next.indexedDB) {\n        return result.concat(next.indexedDB);\n      }\n      throw new Error(\"Your validation configuration is not properly configured\");\n    }, []);\n  }\n\n  arePrefsValid(getPref, indexedDBPrefs) {\n    for (const prefs of this.validation) {\n      // {oneOf: [\"foo\", \"bar\"]}\n      if (prefs && prefs.oneOf && !prefs.oneOf.some(name => getPref(name) === this.initialPrefs[name])) {\n        return false;\n\n        // {indexedDB: [\"foo\", \"bar\"]}\n      } else if (indexedDBPrefs && prefs && prefs.indexedDB) {\n        const anyModifiedPrefs = prefs.indexedDB.some(prefName => indexedDBPrefs.some(pref => pref && pref[prefName]));\n        if (anyModifiedPrefs) {\n          return false;\n        }\n        // \"foo\"\n      } else if (getPref(prefs) !== this.initialPrefs[prefs]) {\n        return false;\n      }\n    }\n    return true;\n  }\n}\n\nthis.PrerenderData = new _PrerenderData({\n  initialPrefs: {\n    \"migrationExpired\": true,\n    \"feeds.topsites\": true,\n    \"showSearch\": true,\n    \"topSitesRows\": 1,\n    \"feeds.section.topstories\": true,\n    \"feeds.section.highlights\": true,\n    \"sectionOrder\": \"topsites,topstories,highlights\",\n    \"collapsed\": false\n  },\n  // Prefs listed as invalidating will prevent the prerendered version\n  // of AS from being used if their value is something other than what is listed\n  // here. This is required because some preferences cause the page layout to be\n  // too different for the prerendered version to be used. Unfortunately, this\n  // will result in users who have modified some of their preferences not being\n  // able to get the benefits of prerendering.\n  validation: [\n    \"feeds.topsites\",\n    \"showSearch\",\n    \"topSitesRows\",\n    \"sectionOrder\",\n    // This means if either of these are set to their default values,\n    // prerendering can be used.\n    {oneOf: [\"feeds.section.topstories\", \"feeds.section.highlights\"]},\n    // If any component has the following preference set to `true` it will\n    // invalidate the prerendered version.\n    {indexedDB: [\"collapsed\"]}\n  ],\n  initialSections: [\n    {\n      enabled: true,\n      icon: \"pocket\",\n      id: \"topstories\",\n      order: 1,\n      title: {id: \"header_recommended_by\", values: {provider: \"Pocket\"}}\n    },\n    {\n      enabled: true,\n      id: \"highlights\",\n      icon: \"highlights\",\n      order: 2,\n      title: {id: \"header_highlights\"}\n    }\n  ]\n});\n\nthis._PrerenderData = _PrerenderData;\nconst EXPORTED_SYMBOLS = [\"PrerenderData\", \"_PrerenderData\"];\n\n\n\n// WEBPACK FOOTER //\n// ./common/PrerenderData.jsm","/* globals ContentSearchUIController */\n\"use strict\";\n\nimport {FormattedMessage, injectIntl} from \"react-intl\";\nimport {actionCreators as ac} from \"common/Actions.jsm\";\nimport {connect} from \"react-redux\";\nimport {IS_NEWTAB} from \"content-src/lib/constants\";\nimport React from \"react\";\n\nexport class _Search extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.onClick = this.onClick.bind(this);\n    this.onInputMount = this.onInputMount.bind(this);\n  }\n\n  handleEvent(event) {\n    // Also track search events with our own telemetry\n    if (event.detail.type === \"Search\") {\n      this.props.dispatch(ac.UserEvent({event: \"SEARCH\"}));\n    }\n  }\n\n  onClick(event) {\n    window.gContentSearchController.search(event);\n  }\n\n  componentWillUnmount() {\n    delete window.gContentSearchController;\n  }\n\n  onInputMount(input) {\n    if (input) {\n      // The \"healthReportKey\" and needs to be \"newtab\" or \"abouthome\" so that\n      // BrowserUsageTelemetry.jsm knows to handle events with this name, and\n      // can add the appropriate telemetry probes for search. Without the correct\n      // name, certain tests like browser_UsageTelemetry_content.js will fail\n      // (See github ticket #2348 for more details)\n      const healthReportKey = IS_NEWTAB ? \"newtab\" : \"abouthome\";\n\n      // The \"searchSource\" needs to be \"newtab\" or \"homepage\" and is sent with\n      // the search data and acts as context for the search request (See\n      // nsISearchEngine.getSubmission). It is necessary so that search engine\n      // plugins can correctly atribute referrals. (See github ticket #3321 for\n      // more details)\n      const searchSource = IS_NEWTAB ? \"newtab\" : \"homepage\";\n\n      // gContentSearchController needs to exist as a global so that tests for\n      // the existing about:home can find it; and so it allows these tests to pass.\n      // In the future, when activity stream is default about:home, this can be renamed\n      window.gContentSearchController = new ContentSearchUIController(input, input.parentNode,\n        healthReportKey, searchSource);\n      addEventListener(\"ContentSearchClient\", this);\n    } else {\n      window.gContentSearchController = null;\n      removeEventListener(\"ContentSearchClient\", this);\n    }\n  }\n\n  /*\n   * Do not change the ID on the input field, as legacy newtab code\n   * specifically looks for the id 'newtab-search-text' on input fields\n   * in order to execute searches in various tests\n   */\n  render() {\n    return (<div className=\"search-wrapper\">\n      <label htmlFor=\"newtab-search-text\" className=\"search-label\">\n        <span className=\"sr-only\"><FormattedMessage id=\"search_web_placeholder\" /></span>\n      </label>\n      <input\n        id=\"newtab-search-text\"\n        maxLength=\"256\"\n        placeholder={this.props.intl.formatMessage({id: \"search_web_placeholder\"})}\n        ref={this.onInputMount}\n        title={this.props.intl.formatMessage({id: \"search_web_placeholder\"})}\n        type=\"search\" />\n      <button\n        id=\"searchSubmit\"\n        className=\"search-button\"\n        onClick={this.onClick}\n        title={this.props.intl.formatMessage({id: \"search_button\"})}>\n        <span className=\"sr-only\"><FormattedMessage id=\"search_button\" /></span>\n      </button>\n    </div>);\n  }\n}\n\nexport const Search = connect()(injectIntl(_Search));\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/Search/Search.jsx","export const IS_NEWTAB = global.document && global.document.documentURI === \"about:newtab\";\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/lib/constants.js","import {Card, PlaceholderCard} from \"content-src/components/Card/Card\";\nimport {FormattedMessage, injectIntl} from \"react-intl\";\nimport {actionCreators as ac} from \"common/Actions.jsm\";\nimport {CollapsibleSection} from \"content-src/components/CollapsibleSection/CollapsibleSection\";\nimport {ComponentPerfTimer} from \"content-src/components/ComponentPerfTimer/ComponentPerfTimer\";\nimport {connect} from \"react-redux\";\nimport React from \"react\";\nimport {Topics} from \"content-src/components/Topics/Topics\";\nimport {TopSites} from \"content-src/components/TopSites/TopSites\";\n\nconst VISIBLE = \"visible\";\nconst VISIBILITY_CHANGE_EVENT = \"visibilitychange\";\nconst CARDS_PER_ROW_DEFAULT = 3;\nconst CARDS_PER_ROW_COMPACT_WIDE = 4;\n\nfunction getFormattedMessage(message) {\n  return typeof message === \"string\" ? <span>{message}</span> : <FormattedMessage {...message} />;\n}\n\nexport class Section extends React.PureComponent {\n  get numRows() {\n    const {rowsPref, maxRows, Prefs} = this.props;\n    return rowsPref ? Prefs.values[rowsPref] : maxRows;\n  }\n\n  _dispatchImpressionStats() {\n    const {props} = this;\n    let cardsPerRow = CARDS_PER_ROW_DEFAULT;\n    if (props.compactCards && global.matchMedia(`(min-width: 1072px)`).matches) {\n      // If the section has compact cards and the viewport is wide enough, we show\n      // 4 columns instead of 3.\n      // $break-point-widest = 1072px (from _variables.scss)\n      cardsPerRow = CARDS_PER_ROW_COMPACT_WIDE;\n    }\n    const maxCards = cardsPerRow * this.numRows;\n    const cards = props.rows.slice(0, maxCards);\n\n    if (this.needsImpressionStats(cards)) {\n      props.dispatch(ac.ImpressionStats({\n        source: props.eventSource,\n        tiles: cards.map(link => ({id: link.guid}))\n      }));\n      this.impressionCardGuids = cards.map(link => link.guid);\n    }\n  }\n\n  // This sends an event when a user sees a set of new content. If content\n  // changes while the page is hidden (i.e. preloaded or on a hidden tab),\n  // only send the event if the page becomes visible again.\n  sendImpressionStatsOrAddListener() {\n    const {props} = this;\n\n    if (!props.shouldSendImpressionStats || !props.dispatch) {\n      return;\n    }\n\n    if (props.document.visibilityState === VISIBLE) {\n      this._dispatchImpressionStats();\n    } else {\n      // We should only ever send the latest impression stats ping, so remove any\n      // older listeners.\n      if (this._onVisibilityChange) {\n        props.document.removeEventListener(VISIBILITY_CHANGE_EVENT, this._onVisibilityChange);\n      }\n\n      // When the page becomes visible, send the impression stats ping if the section isn't collapsed.\n      this._onVisibilityChange = () => {\n        if (props.document.visibilityState === VISIBLE) {\n          if (!this.props.pref.collapsed) {\n            this._dispatchImpressionStats();\n          }\n          props.document.removeEventListener(VISIBILITY_CHANGE_EVENT, this._onVisibilityChange);\n        }\n      };\n      props.document.addEventListener(VISIBILITY_CHANGE_EVENT, this._onVisibilityChange);\n    }\n  }\n\n  componentDidMount() {\n    if (this.props.rows.length && !this.props.pref.collapsed) {\n      this.sendImpressionStatsOrAddListener();\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const {props} = this;\n    const isCollapsed = props.pref.collapsed;\n    const wasCollapsed = prevProps.pref.collapsed;\n    if (\n      // Don't send impression stats for the empty state\n      props.rows.length &&\n      (\n        // We only want to send impression stats if the content of the cards has changed\n        // and the section is not collapsed...\n        (props.rows !== prevProps.rows && !isCollapsed) ||\n        // or if we are expanding a section that was collapsed.\n        (wasCollapsed && !isCollapsed)\n      )\n    ) {\n      this.sendImpressionStatsOrAddListener();\n    }\n  }\n\n  componentWillUnmount() {\n    if (this._onVisibilityChange) {\n      this.props.document.removeEventListener(VISIBILITY_CHANGE_EVENT, this._onVisibilityChange);\n    }\n  }\n\n  needsImpressionStats(cards) {\n    if (!this.impressionCardGuids || (this.impressionCardGuids.length !== cards.length)) {\n      return true;\n    }\n\n    for (let i = 0; i < cards.length; i++) {\n      if (cards[i].guid !== this.impressionCardGuids[i]) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  render() {\n    const {\n      id, eventSource, title, icon, rows,\n      emptyState, dispatch, compactCards,\n      contextMenuOptions, initialized, disclaimer,\n      pref, privacyNoticeURL, isFirst, isLast\n    } = this.props;\n\n    const maxCardsPerRow = compactCards ? CARDS_PER_ROW_COMPACT_WIDE : CARDS_PER_ROW_DEFAULT;\n    const {numRows} = this;\n    const maxCards = maxCardsPerRow * numRows;\n    const maxCardsOnNarrow = CARDS_PER_ROW_DEFAULT * numRows;\n\n    // Show topics only for top stories and if it's not initialized yet (so\n    // content doesn't shift when it is loaded) or has loaded with topics\n    const shouldShowTopics = (id === \"topstories\" &&\n      (!this.props.topics || this.props.topics.length > 0));\n\n    const realRows = rows.slice(0, maxCards);\n\n    // The empty state should only be shown after we have initialized and there is no content.\n    // Otherwise, we should show placeholders.\n    const shouldShowEmptyState = initialized && !rows.length;\n\n    const cards = [];\n    if (!shouldShowEmptyState) {\n      for (let i = 0; i < maxCards; i++) {\n        const link = realRows[i];\n        // On narrow viewports, we only show 3 cards per row. We'll mark the rest as\n        // .hide-for-narrow to hide in CSS via @media query.\n        const className = (i >= maxCardsOnNarrow) ? \"hide-for-narrow\" : \"\";\n        cards.push(link ? (\n          <Card key={i}\n            index={i}\n            className={className}\n            dispatch={dispatch}\n            link={link}\n            contextMenuOptions={contextMenuOptions}\n            eventSource={eventSource}\n            shouldSendImpressionStats={this.props.shouldSendImpressionStats}\n            isWebExtension={this.props.isWebExtension} />\n        ) : (\n          <PlaceholderCard key={i} className={className} />\n        ));\n      }\n    }\n\n    const sectionClassName = [\n      \"section\",\n      compactCards ? \"compact-cards\" : \"normal-cards\"\n    ].join(\" \");\n\n    // <Section> <-- React component\n    // <section> <-- HTML5 element\n    return (<ComponentPerfTimer {...this.props}>\n      <CollapsibleSection className={sectionClassName} icon={icon}\n        title={title}\n        id={id}\n        eventSource={eventSource}\n        disclaimer={disclaimer}\n        collapsed={this.props.pref.collapsed}\n        showPrefName={(pref && pref.feed) || id}\n        privacyNoticeURL={privacyNoticeURL}\n        Prefs={this.props.Prefs}\n        isFirst={isFirst}\n        isLast={isLast}\n        dispatch={this.props.dispatch}\n        isWebExtension={this.props.isWebExtension}>\n\n        {!shouldShowEmptyState && (<ul className=\"section-list\" style={{padding: 0}}>\n          {cards}\n        </ul>)}\n        {shouldShowEmptyState &&\n          <div className=\"section-empty-state\">\n            <div className=\"empty-state\">\n              {emptyState.icon && emptyState.icon.startsWith(\"moz-extension://\") ?\n                <img className=\"empty-state-icon icon\" style={{\"background-image\": `url('${emptyState.icon}')`}} /> :\n                <img className={`empty-state-icon icon icon-${emptyState.icon}`} />}\n              <p className=\"empty-state-message\">\n                {getFormattedMessage(emptyState.message)}\n              </p>\n            </div>\n          </div>}\n        {shouldShowTopics && <Topics topics={this.props.topics} read_more_endpoint={this.props.read_more_endpoint} />}\n      </CollapsibleSection>\n    </ComponentPerfTimer>);\n  }\n}\n\nSection.defaultProps = {\n  document: global.document,\n  rows: [],\n  emptyState: {},\n  pref: {},\n  title: \"\"\n};\n\nexport const SectionIntl = connect(state => ({Prefs: state.Prefs}))(injectIntl(Section));\n\nexport class _Sections extends React.PureComponent {\n  renderSections() {\n    const sections = [];\n    const enabledSections = this.props.Sections.filter(section => section.enabled);\n    const {sectionOrder, \"feeds.topsites\": showTopSites} = this.props.Prefs.values;\n    // Enabled sections doesn't include Top Sites, so we add it if enabled.\n    const expectedCount = enabledSections.length + ~~showTopSites;\n\n    for (const sectionId of sectionOrder.split(\",\")) {\n      const commonProps = {\n        key: sectionId,\n        isFirst: sections.length === 0,\n        isLast: sections.length === expectedCount - 1\n      };\n      if (sectionId === \"topsites\" && showTopSites) {\n        sections.push(<TopSites {...commonProps} />);\n      } else {\n        const section = enabledSections.find(s => s.id === sectionId);\n        if (section) {\n          sections.push(<SectionIntl {...section} {...commonProps} />);\n        }\n      }\n    }\n    return sections;\n  }\n\n  render() {\n    return (\n      <div className=\"sections-list\">\n        {this.renderSections()}\n      </div>\n    );\n  }\n}\n\nexport const Sections = connect(state => ({Sections: state.Sections, Prefs: state.Prefs}))(_Sections);\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/Sections/Sections.jsx","export const cardContextTypes = {\n  history: {\n    intlID: \"type_label_visited\",\n    icon: \"history-item\"\n  },\n  bookmark: {\n    intlID: \"type_label_bookmarked\",\n    icon: \"bookmark-added\"\n  },\n  trending: {\n    intlID: \"type_label_recommended\",\n    icon: \"trending\"\n  },\n  now: {\n    intlID: \"type_label_now\",\n    icon: \"now\"\n  },\n  pocket: {\n    intlID: \"type_label_pocket\",\n    icon: \"pocket\"\n  },\n  download: {\n    intlID: \"type_label_downloaded\",\n    icon: \"download\"\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/Card/types.js","import {actionCreators as ac, actionTypes as at} from \"common/Actions.jsm\";\nimport {cardContextTypes} from \"./types\";\nimport {connect} from \"react-redux\";\nimport {FormattedMessage} from \"react-intl\";\nimport {GetPlatformString} from \"content-src/lib/link-menu-options\";\nimport {LinkMenu} from \"content-src/components/LinkMenu/LinkMenu\";\nimport React from \"react\";\nimport {ScreenshotUtils} from \"content-src/lib/screenshot-utils\";\n\n// Keep track of pending image loads to only request once\nconst gImageLoading = new Map();\n\n/**\n * Card component.\n * Cards are found within a Section component and contain information about a link such\n * as preview image, page title, page description, and some context about if the page\n * was visited, bookmarked, trending etc...\n * Each Section can make an unordered list of Cards which will create one instane of\n * this class. Each card will then get a context menu which reflects the actions that\n * can be done on this Card.\n */\nexport class _Card extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      activeCard: null,\n      imageLoaded: false,\n      showContextMenu: false,\n      cardImage: null\n    };\n    this.onMenuButtonClick = this.onMenuButtonClick.bind(this);\n    this.onMenuUpdate = this.onMenuUpdate.bind(this);\n    this.onLinkClick = this.onLinkClick.bind(this);\n  }\n\n  /**\n   * Helper to conditionally load an image and update state when it loads.\n   */\n  async maybeLoadImage() {\n    // No need to load if it's already loaded or no image\n    const {cardImage} = this.state;\n    if (!cardImage) {\n      return;\n    }\n\n    const imageUrl = cardImage.url;\n    if (!this.state.imageLoaded) {\n      // Initialize a promise to share a load across multiple card updates\n      if (!gImageLoading.has(imageUrl)) {\n        const loaderPromise = new Promise((resolve, reject) => {\n          const loader = new Image();\n          loader.addEventListener(\"load\", resolve);\n          loader.addEventListener(\"error\", reject);\n          loader.src = imageUrl;\n        });\n\n        // Save and remove the promise only while it's pending\n        gImageLoading.set(imageUrl, loaderPromise);\n        loaderPromise.catch(ex => ex).then(() => gImageLoading.delete(imageUrl)).catch();\n      }\n\n      // Wait for the image whether just started loading or reused promise\n      await gImageLoading.get(imageUrl);\n\n      // Only update state if we're still waiting to load the original image\n      if (ScreenshotUtils.isRemoteImageLocal(this.state.cardImage, this.props.link.image) &&\n          !this.state.imageLoaded) {\n        this.setState({imageLoaded: true});\n      }\n    }\n  }\n\n  /**\n   * Helper to obtain the next state based on nextProps and prevState.\n   *\n   * NOTE: Rename this method to getDerivedStateFromProps when we update React\n   *       to >= 16.3. We will need to update tests as well. We cannot rename this\n   *       method to getDerivedStateFromProps now because there is a mismatch in\n   *       the React version that we are using for both testing and production.\n   *       (i.e. react-test-render => \"16.3.2\", react => \"16.2.0\").\n   *\n   * See https://github.com/airbnb/enzyme/blob/master/packages/enzyme-adapter-react-16/package.json#L43.\n   */\n  static getNextStateFromProps(nextProps, prevState) {\n    const {image} = nextProps.link;\n    const imageInState = ScreenshotUtils.isRemoteImageLocal(prevState.cardImage, image);\n    let nextState = null;\n\n    // Image is updating.\n    if (!imageInState && nextProps.link) {\n      nextState = {imageLoaded: false};\n    }\n\n    if (imageInState) {\n      return nextState;\n    }\n\n    // Since image was updated, attempt to revoke old image blob URL, if it exists.\n    ScreenshotUtils.maybeRevokeBlobObjectURL(prevState.cardImage);\n\n    nextState = nextState || {};\n    nextState.cardImage = ScreenshotUtils.createLocalImageObject(image);\n\n    return nextState;\n  }\n\n  onMenuButtonClick(event) {\n    event.preventDefault();\n    this.setState({\n      activeCard: this.props.index,\n      showContextMenu: true\n    });\n  }\n\n  /**\n   * Report to telemetry additional information about the item.\n   */\n  _getTelemetryInfo() {\n    // Filter out \"history\" type for being the default\n    if (this.props.link.type !== \"history\") {\n      return {value: {card_type: this.props.link.type}};\n    }\n\n    return null;\n  }\n\n  onLinkClick(event) {\n    event.preventDefault();\n    if (this.props.link.type === \"download\") {\n      this.props.dispatch(ac.OnlyToMain({\n        type: at.SHOW_DOWNLOAD_FILE,\n        data: this.props.link\n      }));\n    } else {\n      const {altKey, button, ctrlKey, metaKey, shiftKey} = event;\n      this.props.dispatch(ac.OnlyToMain({\n        type: at.OPEN_LINK,\n        data: Object.assign(this.props.link, {event: {altKey, button, ctrlKey, metaKey, shiftKey}})\n      }));\n    }\n    if (this.props.isWebExtension) {\n      this.props.dispatch(ac.WebExtEvent(at.WEBEXT_CLICK, {\n        source: this.props.eventSource,\n        url: this.props.link.url,\n        action_position: this.props.index\n      }));\n    } else {\n      this.props.dispatch(ac.UserEvent(Object.assign({\n        event: \"CLICK\",\n        source: this.props.eventSource,\n        action_position: this.props.index\n      }, this._getTelemetryInfo())));\n\n      if (this.props.shouldSendImpressionStats) {\n        this.props.dispatch(ac.ImpressionStats({\n          source: this.props.eventSource,\n          click: 0,\n          tiles: [{id: this.props.link.guid, pos: this.props.index}]\n        }));\n      }\n    }\n  }\n\n  onMenuUpdate(showContextMenu) {\n    this.setState({showContextMenu});\n  }\n\n  componentDidMount() {\n    this.maybeLoadImage();\n  }\n\n  componentDidUpdate() {\n    this.maybeLoadImage();\n  }\n\n  // NOTE: Remove this function when we update React to >= 16.3 since React will\n  //       call getDerivedStateFromProps automatically. We will also need to\n  //       rename getNextStateFromProps to getDerivedStateFromProps.\n  componentWillMount() {\n    const nextState = _Card.getNextStateFromProps(this.props, this.state);\n    if (nextState) {\n      this.setState(nextState);\n    }\n  }\n\n  // NOTE: Remove this function when we update React to >= 16.3 since React will\n  //       call getDerivedStateFromProps automatically. We will also need to\n  //       rename getNextStateFromProps to getDerivedStateFromProps.\n  componentWillReceiveProps(nextProps) {\n    const nextState = _Card.getNextStateFromProps(nextProps, this.state);\n    if (nextState) {\n      this.setState(nextState);\n    }\n  }\n\n  componentWillUnmount() {\n    ScreenshotUtils.maybeRevokeBlobObjectURL(this.state.cardImage);\n  }\n\n  render() {\n    const {index, className, link, dispatch, contextMenuOptions, eventSource, shouldSendImpressionStats} = this.props;\n    const {props} = this;\n    const isContextMenuOpen = this.state.showContextMenu && this.state.activeCard === index;\n    // Display \"now\" as \"trending\" until we have new strings #3402\n    const {icon, intlID} = cardContextTypes[link.type === \"now\" ? \"trending\" : link.type] || {};\n    const hasImage = this.state.cardImage || link.hasImage;\n    const imageStyle = {backgroundImage: this.state.cardImage ? `url(${this.state.cardImage.url})` : \"none\"};\n    const outerClassName = [\n      \"card-outer\",\n      className,\n      isContextMenuOpen && \"active\",\n      props.placeholder && \"placeholder\"\n    ].filter(v => v).join(\" \");\n\n    return (<li className={outerClassName}>\n      <a href={link.type === \"pocket\" ? link.open_url : link.url} onClick={!props.placeholder ? this.onLinkClick : undefined}>\n        <div className=\"card\">\n          <div className=\"card-preview-image-outer\">\n            {hasImage &&\n              <div className={`card-preview-image${this.state.imageLoaded ? \" loaded\" : \"\"}`} style={imageStyle} />\n            }\n          </div>\n          <div className=\"card-details\">\n            {link.type === \"download\" && <div className=\"card-host-name alternate\"><FormattedMessage id={GetPlatformString(this.props.platform)} /></div>}\n            {link.hostname &&\n              <div className=\"card-host-name\">\n                {link.hostname.slice(0, 100)}{link.type === \"download\" && `  \\u2014 ${link.description}`}\n              </div>\n            }\n            <div className={[\n              \"card-text\",\n              icon ? \"\" : \"no-context\",\n              link.description ? \"\" : \"no-description\",\n              link.hostname ? \"\" : \"no-host-name\"\n            ].join(\" \")}>\n              <h4 className=\"card-title\" dir=\"auto\">{link.title}</h4>\n              <p className=\"card-description\" dir=\"auto\">{link.description}</p>\n            </div>\n            <div className=\"card-context\">\n              {icon && !link.context && <span className={`card-context-icon icon icon-${icon}`} />}\n              {link.icon && link.context && <span className=\"card-context-icon icon\" style={{backgroundImage: `url('${link.icon}')`}} />}\n              {intlID && !link.context && <div className=\"card-context-label\"><FormattedMessage id={intlID} defaultMessage=\"Visited\" /></div>}\n              {link.context && <div className=\"card-context-label\">{link.context}</div>}\n            </div>\n          </div>\n        </div>\n      </a>\n      {!props.placeholder && <button className=\"context-menu-button icon\"\n        onClick={this.onMenuButtonClick}>\n        <span className=\"sr-only\">{`Open context menu for ${link.title}`}</span>\n      </button>}\n      {isContextMenuOpen &&\n        <LinkMenu\n          dispatch={dispatch}\n          index={index}\n          source={eventSource}\n          onUpdate={this.onMenuUpdate}\n          options={link.contextMenuOptions || contextMenuOptions}\n          site={link}\n          siteInfo={this._getTelemetryInfo()}\n          shouldSendImpressionStats={shouldSendImpressionStats} />\n      }\n   </li>);\n  }\n}\n_Card.defaultProps = {link: {}};\nexport const Card = connect(state => ({platform: state.Prefs.values.platform}))(_Card);\nexport const PlaceholderCard = props => <Card placeholder={true} className={props.className} />;\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/Card/Card.jsx","import {actionCreators as ac} from \"common/Actions.jsm\";\nimport {ContextMenu} from \"content-src/components/ContextMenu/ContextMenu\";\nimport {injectIntl} from \"react-intl\";\nimport React from \"react\";\nimport {SectionMenuOptions} from \"content-src/lib/section-menu-options\";\n\nconst DEFAULT_SECTION_MENU_OPTIONS = [\"MoveUp\", \"MoveDown\", \"Separator\", \"RemoveSection\", \"CheckCollapsed\", \"Separator\", \"ManageSection\"];\nconst WEBEXT_SECTION_MENU_OPTIONS = [\"MoveUp\", \"MoveDown\", \"Separator\", \"CheckCollapsed\", \"Separator\", \"ManageWebExtension\"];\n\nexport class _SectionMenu extends React.PureComponent {\n  getOptions() {\n    const {props} = this;\n\n    const propOptions = props.isWebExtension ? [...WEBEXT_SECTION_MENU_OPTIONS] : [...DEFAULT_SECTION_MENU_OPTIONS];\n    // Prepend custom options and a separator\n    if (props.extraOptions) {\n      propOptions.splice(0, 0, ...props.extraOptions, \"Separator\");\n    }\n    // Insert privacy notice before the last option (\"ManageSection\")\n    if (props.privacyNoticeURL) {\n      propOptions.splice(-1, 0, \"PrivacyNotice\");\n    }\n\n    const options = propOptions.map(o => SectionMenuOptions[o](props)).map(option => {\n      const {action, id, type, userEvent} = option;\n      if (!type && id) {\n        option.label = props.intl.formatMessage({id});\n        option.onClick = () => {\n          props.dispatch(action);\n          if (userEvent) {\n            props.dispatch(ac.UserEvent({\n              event: userEvent,\n              source: props.source\n            }));\n          }\n        };\n      }\n      return option;\n    });\n\n    // This is for accessibility to support making each item tabbable.\n    // We want to know which item is the first and which item\n    // is the last, so we can close the context menu accordingly.\n    options[0].first = true;\n    options[options.length - 1].last = true;\n    return options;\n  }\n\n  render() {\n    return (<ContextMenu\n      onUpdate={this.props.onUpdate}\n      options={this.getOptions()} />);\n  }\n}\n\nexport const SectionMenu = injectIntl(_SectionMenu);\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/SectionMenu/SectionMenu.jsx","import {FormattedMessage} from \"react-intl\";\nimport React from \"react\";\n\nexport class Topic extends React.PureComponent {\n  render() {\n    const {url, name} = this.props;\n    return (<li><a key={name} className=\"topic-link\" href={url}>{name}</a></li>);\n  }\n}\n\nexport class Topics extends React.PureComponent {\n  render() {\n    const {topics, read_more_endpoint} = this.props;\n    return (\n      <div className=\"topic\">\n        <span><FormattedMessage id=\"pocket_read_more\" /></span>\n        <ul>{topics && topics.map(t => <Topic key={t.name} url={t.url} name={t.name} />)}</ul>\n\n        {read_more_endpoint && <a className=\"topic-read-more\" href={read_more_endpoint}>\n          <FormattedMessage id=\"pocket_read_even_more\" />\n        </a>}\n      </div>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/Topics/Topics.jsx","import {actionCreators as ac, actionTypes as at} from \"common/Actions.jsm\";\nimport {MIN_CORNER_FAVICON_SIZE, MIN_RICH_FAVICON_SIZE, TOP_SITES_SOURCE} from \"./TopSitesConstants\";\nimport {CollapsibleSection} from \"content-src/components/CollapsibleSection/CollapsibleSection\";\nimport {ComponentPerfTimer} from \"content-src/components/ComponentPerfTimer/ComponentPerfTimer\";\nimport {connect} from \"react-redux\";\nimport {injectIntl} from \"react-intl\";\nimport React from \"react\";\nimport {TOP_SITES_MAX_SITES_PER_ROW} from \"common/Reducers.jsm\";\nimport {TopSiteForm} from \"./TopSiteForm\";\nimport {TopSiteList} from \"./TopSite\";\n\nfunction topSiteIconType(link) {\n  if (link.customScreenshotURL) {\n    return \"custom_screenshot\";\n  }\n  if (link.tippyTopIcon || link.faviconRef === \"tippytop\") {\n    return \"tippytop\";\n  }\n  if (link.faviconSize >= MIN_RICH_FAVICON_SIZE) {\n    return \"rich_icon\";\n  }\n  if (link.screenshot && link.faviconSize >= MIN_CORNER_FAVICON_SIZE) {\n    return \"screenshot_with_icon\";\n  }\n  if (link.screenshot) {\n    return \"screenshot\";\n  }\n  return \"no_image\";\n}\n\n/**\n * Iterates through TopSites and counts types of images.\n * @param acc Accumulator for reducer.\n * @param topsite Entry in TopSites.\n */\nfunction countTopSitesIconsTypes(topSites) {\n  const countTopSitesTypes = (acc, link) => {\n    acc[topSiteIconType(link)]++;\n    return acc;\n  };\n\n  return topSites.reduce(countTopSitesTypes, {\n    \"custom_screenshot\": 0,\n    \"screenshot_with_icon\": 0,\n    \"screenshot\": 0,\n    \"tippytop\": 0,\n    \"rich_icon\": 0,\n    \"no_image\": 0\n  });\n}\n\nexport class _TopSites extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.onFormClose = this.onFormClose.bind(this);\n  }\n\n  /**\n   * Dispatch session statistics about the quality of TopSites icons and pinned count.\n   */\n  _dispatchTopSitesStats() {\n    const topSites = this._getVisibleTopSites();\n    const topSitesIconsStats = countTopSitesIconsTypes(topSites);\n    const topSitesPinned = topSites.filter(site => !!site.isPinned).length;\n    // Dispatch telemetry event with the count of TopSites images types.\n    this.props.dispatch(ac.AlsoToMain({\n      type: at.SAVE_SESSION_PERF_DATA,\n      data: {topsites_icon_stats: topSitesIconsStats, topsites_pinned: topSitesPinned}\n    }));\n  }\n\n  /**\n   * Return the TopSites that are visible based on prefs and window width.\n   */\n  _getVisibleTopSites() {\n    // We hide 2 sites per row when not in the wide layout.\n    let sitesPerRow = TOP_SITES_MAX_SITES_PER_ROW;\n    // $break-point-widest = 1072px (from _variables.scss)\n    if (!global.matchMedia(`(min-width: 1072px)`).matches) {\n      sitesPerRow -= 2;\n    }\n    return this.props.TopSites.rows.slice(0, this.props.TopSitesRows * sitesPerRow);\n  }\n\n  componentDidUpdate() {\n    this._dispatchTopSitesStats();\n  }\n\n  componentDidMount() {\n    this._dispatchTopSitesStats();\n  }\n\n  onFormClose() {\n    this.props.dispatch(ac.UserEvent({\n      source: TOP_SITES_SOURCE,\n      event: \"TOP_SITES_EDIT_CLOSE\"\n    }));\n    this.props.dispatch({type: at.TOP_SITES_CANCEL_EDIT});\n  }\n\n  render() {\n    const {props} = this;\n    const {editForm} = props.TopSites;\n\n    return (<ComponentPerfTimer id=\"topsites\" initialized={props.TopSites.initialized} dispatch={props.dispatch}>\n      <CollapsibleSection\n        className=\"top-sites\"\n        icon=\"topsites\"\n        id=\"topsites\"\n        title={{id: \"header_top_sites\"}}\n        extraMenuOptions={[\"AddTopSite\"]}\n        showPrefName=\"feeds.topsites\"\n        eventSource={TOP_SITES_SOURCE}\n        collapsed={props.TopSites.pref ? props.TopSites.pref.collapsed : undefined}\n        isFirst={props.isFirst}\n        isLast={props.isLast}\n        dispatch={props.dispatch}>\n        <TopSiteList TopSites={props.TopSites} TopSitesRows={props.TopSitesRows} dispatch={props.dispatch} intl={props.intl} topSiteIconType={topSiteIconType} />\n        <div className=\"edit-topsites-wrapper\">\n          {editForm &&\n            <div className=\"edit-topsites\">\n              <div className=\"modal-overlay\" onClick={this.onFormClose} />\n              <div className=\"modal\">\n                <TopSiteForm\n                  site={props.TopSites.rows[editForm.index]}\n                  onClose={this.onFormClose}\n                  dispatch={this.props.dispatch}\n                  intl={this.props.intl}\n                  {...editForm} />\n              </div>\n            </div>\n          }\n        </div>\n      </CollapsibleSection>\n    </ComponentPerfTimer>);\n  }\n}\n\nexport const TopSites = connect(state => ({\n  TopSites: state.TopSites,\n  Prefs: state.Prefs,\n  TopSitesRows: state.Prefs.values.topSitesRows\n}))(injectIntl(_TopSites));\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/TopSites/TopSites.jsx","import {FormattedMessage} from \"react-intl\";\nimport React from \"react\";\n\nexport class TopSiteFormInput extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {validationError: this.props.validationError};\n    this.onChange = this.onChange.bind(this);\n    this.onMount = this.onMount.bind(this);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.shouldFocus && !this.props.shouldFocus) {\n      this.input.focus();\n    }\n    if (nextProps.validationError && !this.props.validationError) {\n      this.setState({validationError: true});\n    }\n    // If the component is in an error state but the value was cleared by the parent\n    if (this.state.validationError && !nextProps.value) {\n      this.setState({validationError: false});\n    }\n  }\n\n  onChange(ev) {\n    if (this.state.validationError) {\n      this.setState({validationError: false});\n    }\n    this.props.onChange(ev);\n  }\n\n  onMount(input) {\n    this.input = input;\n  }\n\n  render() {\n    const showClearButton = this.props.value && this.props.onClear;\n    const {typeUrl} = this.props;\n    const {validationError} = this.state;\n\n    return (<label><FormattedMessage id={this.props.titleId} />\n      <div className={`field ${typeUrl ? \"url\" : \"\"}${validationError ? \" invalid\" : \"\"}`}>\n        {this.props.loading ?\n          <div className=\"loading-container\"><div className=\"loading-animation\" /></div> :\n          showClearButton && <div className=\"icon icon-clear-input\" onClick={this.props.onClear} />}\n        <input type=\"text\"\n          value={this.props.value}\n          ref={this.onMount}\n          onChange={this.onChange}\n          placeholder={this.props.intl.formatMessage({id: this.props.placeholderId})}\n          autoFocus={this.props.shouldFocus}\n          disabled={this.props.loading} />\n        {validationError &&\n          <aside className=\"error-tooltip\">\n            <FormattedMessage id={this.props.errorMessageId} />\n          </aside>}\n      </div>\n    </label>);\n  }\n}\n\nTopSiteFormInput.defaultProps = {\n  showClearButton: false,\n  value: \"\",\n  validationError: false\n};\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/TopSites/TopSiteFormInput.jsx","import {actionCreators as ac, actionTypes as at} from \"common/Actions.jsm\";\nimport {FormattedMessage} from \"react-intl\";\nimport React from \"react\";\nimport {TOP_SITES_SOURCE} from \"./TopSitesConstants\";\nimport {TopSiteFormInput} from \"./TopSiteFormInput\";\nimport {TopSiteLink} from \"./TopSite\";\n\nexport class TopSiteForm extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    const {site} = props;\n    this.state = {\n      label: site ? (site.label || site.hostname) : \"\",\n      url: site ? site.url : \"\",\n      validationError: false,\n      customScreenshotUrl: site ? site.customScreenshotURL : \"\",\n      showCustomScreenshotForm: site ? site.customScreenshotURL : false\n    };\n    this.onClearScreenshotInput = this.onClearScreenshotInput.bind(this);\n    this.onLabelChange = this.onLabelChange.bind(this);\n    this.onUrlChange = this.onUrlChange.bind(this);\n    this.onCancelButtonClick = this.onCancelButtonClick.bind(this);\n    this.onClearUrlClick = this.onClearUrlClick.bind(this);\n    this.onDoneButtonClick = this.onDoneButtonClick.bind(this);\n    this.onCustomScreenshotUrlChange = this.onCustomScreenshotUrlChange.bind(this);\n    this.onPreviewButtonClick = this.onPreviewButtonClick.bind(this);\n    this.onEnableScreenshotUrlForm = this.onEnableScreenshotUrlForm.bind(this);\n    this.validateUrl = this.validateUrl.bind(this);\n  }\n\n  onLabelChange(event) {\n    this.setState({\"label\": event.target.value});\n  }\n\n  onUrlChange(event) {\n    this.setState({\n      url: event.target.value,\n      validationError: false\n    });\n  }\n\n  onClearUrlClick() {\n    this.setState({\n      url: \"\",\n      validationError: false\n    });\n  }\n\n  onEnableScreenshotUrlForm() {\n    this.setState({showCustomScreenshotForm: true});\n  }\n\n  _updateCustomScreenshotInput(customScreenshotUrl) {\n    this.setState({\n      customScreenshotUrl,\n      validationError: false\n    });\n    this.props.dispatch({type: at.PREVIEW_REQUEST_CANCEL});\n  }\n\n  onCustomScreenshotUrlChange(event) {\n    this._updateCustomScreenshotInput(event.target.value);\n  }\n\n  onClearScreenshotInput() {\n    this._updateCustomScreenshotInput(\"\");\n  }\n\n  onCancelButtonClick(ev) {\n    ev.preventDefault();\n    this.props.onClose();\n  }\n\n  onDoneButtonClick(ev) {\n    ev.preventDefault();\n\n    if (this.validateForm()) {\n      const site = {url: this.cleanUrl(this.state.url)};\n      const {index} = this.props;\n      if (this.state.label !== \"\") {\n        site.label = this.state.label;\n      }\n\n      if (this.state.customScreenshotUrl) {\n        site.customScreenshotURL = this.cleanUrl(this.state.customScreenshotUrl);\n      } else if (this.props.site && this.props.site.customScreenshotURL) {\n        // Used to flag that previously cached screenshot should be removed\n        site.customScreenshotURL = null;\n      }\n      this.props.dispatch(ac.AlsoToMain({\n        type: at.TOP_SITES_PIN,\n        data: {site, index}\n      }));\n      this.props.dispatch(ac.UserEvent({\n        source: TOP_SITES_SOURCE,\n        event: \"TOP_SITES_EDIT\",\n        action_position: index\n      }));\n\n      this.props.onClose();\n    }\n  }\n\n  onPreviewButtonClick(event) {\n    event.preventDefault();\n    if (this.validateForm()) {\n      this.props.dispatch(ac.AlsoToMain({\n        type: at.PREVIEW_REQUEST,\n        data: {url: this.cleanUrl(this.state.customScreenshotUrl)}\n      }));\n      this.props.dispatch(ac.UserEvent({\n        source: TOP_SITES_SOURCE,\n        event: \"PREVIEW_REQUEST\"\n      }));\n    }\n  }\n\n  cleanUrl(url) {\n    // If we are missing a protocol, prepend http://\n    if (!url.startsWith(\"http:\") && !url.startsWith(\"https:\")) {\n      return `http://${url}`;\n    }\n    return url;\n  }\n\n  _tryParseUrl(url) {\n    try {\n      return new URL(url);\n    } catch (e) {\n      return null;\n    }\n  }\n\n  validateUrl(url) {\n    const validProtocols = [\"http:\", \"https:\"];\n    const urlObj = this._tryParseUrl(url) || this._tryParseUrl(this.cleanUrl(url));\n\n    return urlObj && validProtocols.includes(urlObj.protocol);\n  }\n\n  validateCustomScreenshotUrl() {\n    const {customScreenshotUrl} = this.state;\n    return !customScreenshotUrl || this.validateUrl(customScreenshotUrl);\n  }\n\n  validateForm() {\n    const validate = this.validateUrl(this.state.url) && this.validateCustomScreenshotUrl();\n\n    if (!validate) {\n      this.setState({validationError: true});\n    }\n\n    return validate;\n  }\n\n  _renderCustomScreenshotInput() {\n    const {customScreenshotUrl} = this.state;\n    const requestFailed = this.props.previewResponse === \"\";\n    const validationError = (this.state.validationError && !this.validateCustomScreenshotUrl()) || requestFailed;\n    // Set focus on error if the url field is valid or when the input is first rendered and is empty\n    const shouldFocus = (validationError && this.validateUrl(this.state.url)) || !customScreenshotUrl;\n    const isLoading = this.props.previewResponse === null &&\n      customScreenshotUrl && this.props.previewUrl === this.cleanUrl(customScreenshotUrl);\n\n    if (!this.state.showCustomScreenshotForm) {\n      return (<a className=\"enable-custom-image-input\" onClick={this.onEnableScreenshotUrlForm}>\n        <FormattedMessage id=\"topsites_form_use_image_link\" />\n      </a>);\n    }\n    return (<div className=\"custom-image-input-container\">\n      <TopSiteFormInput\n        errorMessageId={requestFailed ? \"topsites_form_image_validation\" : \"topsites_form_url_validation\"}\n        loading={isLoading}\n        onChange={this.onCustomScreenshotUrlChange}\n        onClear={this.onClearScreenshotInput}\n        shouldFocus={shouldFocus}\n        typeUrl={true}\n        value={customScreenshotUrl}\n        validationError={validationError}\n        titleId=\"topsites_form_image_url_label\"\n        placeholderId=\"topsites_form_url_placeholder\"\n        intl={this.props.intl} />\n    </div>);\n  }\n\n  render() {\n    const {customScreenshotUrl} = this.state;\n    const requestFailed = this.props.previewResponse === \"\";\n    // For UI purposes, editing without an existing link is \"add\"\n    const showAsAdd = !this.props.site;\n    const previous = (this.props.site && this.props.site.customScreenshotURL) || \"\";\n    const changed = customScreenshotUrl && this.cleanUrl(customScreenshotUrl) !== previous;\n    // Preview mode if changes were made to the custom screenshot URL and no preview was received yet\n    // or the request failed\n    const previewMode = changed && !this.props.previewResponse;\n    const previewLink = Object.assign({}, this.props.site);\n    if (this.props.previewResponse) {\n      previewLink.screenshot = this.props.previewResponse;\n      previewLink.customScreenshotURL = this.props.previewUrl;\n    }\n    return (\n      <form className=\"topsite-form\">\n        <div className=\"form-input-container\">\n          <h3 className=\"section-title\">\n            <FormattedMessage id={showAsAdd ? \"topsites_form_add_header\" : \"topsites_form_edit_header\"} />\n          </h3>\n          <div className=\"fields-and-preview\">\n            <div className=\"form-wrapper\">\n              <TopSiteFormInput onChange={this.onLabelChange}\n                value={this.state.label}\n                titleId=\"topsites_form_title_label\"\n                placeholderId=\"topsites_form_title_placeholder\"\n                intl={this.props.intl} />\n              <TopSiteFormInput onChange={this.onUrlChange}\n                shouldFocus={this.state.validationError && !this.validateUrl(this.state.url)}\n                value={this.state.url}\n                onClear={this.onClearUrlClick}\n                validationError={this.state.validationError && !this.validateUrl(this.state.url)}\n                titleId=\"topsites_form_url_label\"\n                typeUrl={true}\n                placeholderId=\"topsites_form_url_placeholder\"\n                errorMessageId=\"topsites_form_url_validation\"\n                intl={this.props.intl} />\n              {this._renderCustomScreenshotInput()}\n            </div>\n            <TopSiteLink link={previewLink}\n              defaultStyle={requestFailed}\n              title={this.state.label} />\n          </div>\n        </div>\n        <section className=\"actions\">\n          <button className=\"cancel\" type=\"button\" onClick={this.onCancelButtonClick}>\n            <FormattedMessage id=\"topsites_form_cancel_button\" />\n          </button>\n          {previewMode ?\n            <button className=\"done preview\" type=\"submit\" onClick={this.onPreviewButtonClick}>\n              <FormattedMessage id=\"topsites_form_preview_button\" />\n            </button> :\n            <button className=\"done\" type=\"submit\" onClick={this.onDoneButtonClick}>\n              <FormattedMessage id={showAsAdd ? \"topsites_form_add_button\" : \"topsites_form_save_button\"} />\n            </button>}\n        </section>\n      </form>\n    );\n  }\n}\n\nTopSiteForm.defaultProps = {\n  site: null,\n  index: -1\n};\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/TopSites/TopSiteForm.jsx","import {FormattedMessage, injectIntl} from \"react-intl\";\nimport {actionCreators as ac} from \"common/Actions.jsm\";\nimport {connect} from \"react-redux\";\nimport React from \"react\";\n\nexport class _StartupOverlay extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.onInputChange = this.onInputChange.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n    this.clickSkip = this.clickSkip.bind(this);\n    this.initScene = this.initScene.bind(this);\n    this.removeOverlay = this.removeOverlay.bind(this);\n    this.onInputInvalid = this.onInputInvalid.bind(this);\n\n    this.state = {emailInput: \"\"};\n    this.initScene();\n  }\n\n  initScene() {\n    // Timeout to allow the scene to render once before attaching the attribute\n    // to trigger the animation.\n    setTimeout(() => {\n      this.setState({show: true});\n    }, 10);\n  }\n\n  removeOverlay() {\n    window.removeEventListener(\"visibilitychange\", this.removeOverlay);\n    this.setState({show: false});\n    setTimeout(() => {\n      // Allow scrolling and fully remove overlay after animation finishes.\n      document.body.classList.remove(\"welcome\");\n    }, 400);\n  }\n\n  onInputChange(e) {\n    let error = e.target.previousSibling;\n    this.setState({emailInput: e.target.value});\n    error.classList.remove(\"active\");\n    e.target.classList.remove(\"invalid\");\n  }\n\n  onSubmit() {\n    this.props.dispatch(ac.UserEvent({event: \"SUBMIT_EMAIL\"}));\n    window.addEventListener(\"visibilitychange\", this.removeOverlay);\n  }\n\n  clickSkip() {\n    this.props.dispatch(ac.UserEvent({event: \"SKIPPED_SIGNIN\"}));\n    this.removeOverlay();\n  }\n\n  onInputInvalid(e) {\n    let error = e.target.previousSibling;\n    error.classList.add(\"active\");\n    e.target.classList.add(\"invalid\");\n    e.preventDefault(); // Override built-in form validation popup\n  }\n\n  render() {\n    let termsLink = (<a href=\"https://accounts.firefox.com/legal/terms\" target=\"_blank\" rel=\"noopener noreferrer\"><FormattedMessage id=\"firstrun_terms_of_service\" /></a>);\n    let privacyLink = (<a href=\"https://accounts.firefox.com/legal/privacy\" target=\"_blank\" rel=\"noopener noreferrer\"><FormattedMessage id=\"firstrun_privacy_notice\" /></a>);\n    return (\n      <div className={`overlay-wrapper ${this.state.show ? \"show \" : \"\"}`}>\n        <div className=\"background\" />\n        <div className=\"firstrun-scene\">\n          <div className=\"fxaccounts-container\">\n            <div className=\"firstrun-left-divider\">\n              <h1 className=\"firstrun-title\"><FormattedMessage id=\"firstrun_title\" /></h1>\n              <p className=\"firstrun-content\"><FormattedMessage id=\"firstrun_content\" /></p>\n              <a className=\"firstrun-link\" href=\"https://www.mozilla.org/firefox/features/sync/\" target=\"_blank\" rel=\"noopener noreferrer\"><FormattedMessage id=\"firstrun_learn_more_link\" /></a>\n            </div>\n            <div className=\"firstrun-sign-in\">\n              <p className=\"form-header\"><FormattedMessage id=\"firstrun_form_header\" /><span className=\"sub-header\"><FormattedMessage id=\"firstrun_form_sub_header\" /></span></p>\n              <form method=\"get\" action=\"https://accounts.firefox.com\" target=\"_blank\" rel=\"noopener noreferrer\" onSubmit={this.onSubmit}>\n                <input name=\"service\" type=\"hidden\" value=\"sync\" />\n                <input name=\"action\" type=\"hidden\" value=\"email\" />\n                <input name=\"context\" type=\"hidden\" value=\"fx_desktop_v3\" />\n                <input name=\"entrypoint\" type=\"hidden\" value=\"activity-stream-firstrun\" />\n                <input name=\"utm_source\" type=\"hidden\" value=\"activity-stream\" />\n                <input name=\"utm_campaign\" type=\"hidden\" value=\"firstrun\" />\n                <span className=\"error\">{this.props.intl.formatMessage({id: \"firstrun_invalid_input\"})}</span>\n                <input className=\"email-input\" name=\"email\" type=\"email\" required=\"true\" onInvalid={this.onInputInvalid} placeholder={this.props.intl.formatMessage({id: \"firstrun_email_input_placeholder\"})} onChange={this.onInputChange} />\n                <div className=\"extra-links\">\n                  <FormattedMessage\n                    id=\"firstrun_extra_legal_links\"\n                    values={{\n                      terms: termsLink,\n                      privacy: privacyLink\n                    }} />\n                </div>\n                <button className=\"continue-button\" type=\"submit\"><FormattedMessage id=\"firstrun_continue_to_login\" /></button>\n              </form>\n              <button className=\"skip-button\" disabled={!!this.state.emailInput} onClick={this.clickSkip}><FormattedMessage id=\"firstrun_skip_login\" /></button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport const StartupOverlay = connect()(injectIntl(_StartupOverlay));\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/components/StartupOverlay/StartupOverlay.jsx","import {actionCreators as ac, actionTypes as at} from \"common/Actions.jsm\";\nimport {perfService as perfSvc} from \"common/PerfService.jsm\";\n\nconst VISIBLE = \"visible\";\nconst VISIBILITY_CHANGE_EVENT = \"visibilitychange\";\n\nexport class DetectUserSessionStart {\n  constructor(store, options = {}) {\n    this._store = store;\n    // Overrides for testing\n    this.document = options.document || global.document;\n    this._perfService = options.perfService || perfSvc;\n    this._onVisibilityChange = this._onVisibilityChange.bind(this);\n  }\n\n  /**\n   * sendEventOrAddListener - Notify immediately if the page is already visible,\n   *                    or else set up a listener for when visibility changes.\n   *                    This is needed for accurate session tracking for telemetry,\n   *                    because tabs are pre-loaded.\n   */\n  sendEventOrAddListener() {\n    if (this.document.visibilityState === VISIBLE) {\n      // If the document is already visible, to the user, send a notification\n      // immediately that a session has started.\n      this._sendEvent();\n    } else {\n      // If the document is not visible, listen for when it does become visible.\n      this.document.addEventListener(VISIBILITY_CHANGE_EVENT, this._onVisibilityChange);\n    }\n  }\n\n  /**\n   * _sendEvent - Sends a message to the main process to indicate the current\n   *              tab is now visible to the user, includes the\n   *              visibility_event_rcvd_ts time in ms from the UNIX epoch.\n   */\n  _sendEvent() {\n    this._perfService.mark(\"visibility_event_rcvd_ts\");\n\n    try {\n      let visibility_event_rcvd_ts = this._perfService\n        .getMostRecentAbsMarkStartByName(\"visibility_event_rcvd_ts\");\n\n      this._store.dispatch(ac.AlsoToMain({\n        type: at.SAVE_SESSION_PERF_DATA,\n        data: {visibility_event_rcvd_ts}\n      }));\n    } catch (ex) {\n      // If this failed, it's likely because the `privacy.resistFingerprinting`\n      // pref is true.  We should at least not blow up.\n    }\n  }\n\n  /**\n   * _onVisibilityChange - If the visibility has changed to visible, sends a notification\n   *                      and removes the event listener. This should only be called once per tab.\n   */\n  _onVisibilityChange() {\n    if (this.document.visibilityState === VISIBLE) {\n      this._sendEvent();\n      this.document.removeEventListener(VISIBILITY_CHANGE_EVENT, this._onVisibilityChange);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./content-src/lib/detect-user-session-start.js"],"sourceRoot":""}