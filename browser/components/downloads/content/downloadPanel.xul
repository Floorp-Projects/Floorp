<?xml-stylesheet href="chrome://global/skin/" type="text/css"?> 
<?xml-stylesheet href="chrome://browser/content/downloads/downloadmanager.css"?>
<?xml-stylesheet href="chrome://browser/skin/downloads/downloadmanager.css"?>

<!DOCTYPE window [
<!ENTITY % downloadManagerDTD SYSTEM "chrome://browser/locale/downloads/downloadmanager.dtd">
%downloadManagerDTD;
]>

<page xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
      xmlns:nc="http://home.netscape.com/NC-rdf#"
      xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
      onload="Startup();" onunload="Shutdown();">
      
  <script type="application/x-javascript" src="chrome://browser/content/downloads/downloadPanel.js"/>
  <script type="application/x-javascript" src="chrome://browser/content/contentAreaUtils.js"/>
  <script type="application/x-javascript" src="chrome://global/content/nsDragAndDrop.js"/>
  <script type="application/x-javascript" src="chrome://global/content/nsTransferable.js"/>
  <script type="application/x-javascript" src="chrome://global/content/globalOverlay.js"/>

  <commandset id="commandUpdate_Downloads"
              commandupdater="true"
              events="focus,list-select"
              oncommandupdate="downloadViewController.onCommandUpdate()"/>
  
  <command id="cmd_properties"
           oncommand="goDoCommand('cmd_properties');"/>
  <command id="cmd_remove"
           oncommand="goDoCommand('cmd_remove');"/>
  <command id="cmd_openfile"
           oncommand="goDoCommand('cmd_openfile');"/>
  <command id="cmd_showinshell"
           oncommand="goDoCommand('cmd_showinshell');"/>
  
  <keyset>
    <key id="key_remove" keycode="VK_DELETE" command="cmd_remove"/>
  </keyset>
  
  <popup id="downloadHistoryPopup" onpopupshowing="return buildContextMenu();">
    <menuitem id="menuitem_launch" label="&cmd.openfile.label;" default="true"
              accesskey="&cmd.openfile.accesskey;" command="cmd_openfile"/>
    <menuitem id="menuitem_show" label="&cmd.show.label;" accesskey="&cmd.show.accesskey;"
              command="cmd_showinshell"/>
    <menuseparator id="menuseparator_launch"/>
    <menuitem id="menuitem_remove" label="&cmd.remove.label;" accesskey="&cmd.remove.accesskey;"
              command="cmd_remove"/>
  </popup>

  <vbox flex="1">
    <vbox id="downloadView" flex="3" style="overflow: auto;"
          datasources="rdf:null" ref="NC:DownloadsRoot"
          ondragdrop="nsDragAndDrop.drop(event, downloadDNDObserver);">
      <template>
        <rule nc:DownloadState="0" parsetype="Integer">
            <download uri="rdf:*"
                      image="moz-icon:rdf:http://home.netscape.com/NC-rdf#File"
                      target="rdf:http://home.netscape.com/NC-rdf#Name"
                      file="rdf:http://home.netscape.com/NC-rdf#File"/>
        </rule>
      </template>
    </vbox>
    <splitter id="download-splitter" style="min-height: 3px; height: 3px;"/>
    <vbox flex="1">
      <sidebarheader align="center">
        <label value="&finishedDownloads.label;"/>
      </sidebarheader>
      <listbox id="downloadHistoryView" flex="1" class="plain" seltype="multiple"
                datasources="rdf:null" ref="NC:DownloadsRoot" flags="dont-test-empty"
                ondblclick="if (event.button == 0) goDoCommand('cmd_openfile');"
                onselect="onSelect(event);" context="downloadHistoryPopup">
        <listcols>
          <listcol id="Name" primary="true"
                   label="&name.label;"
                   width="3*" flex="3"
                   persist="width"/>
        </listcols>
        <template>
          <rule nc:DownloadState="1" parsetype="Integer">
            <listitem uri="rdf:*">
              <listrow>
                <listcell>
                  <image src="moz-icon:rdf:http://home.netscape.com/NC-rdf#File"/>
                  <label value="rdf:http://home.netscape.com/NC-rdf#Name"/>
                </listcell>
              </listrow>
            </listitem>
          </rule>
        </template>
      </listbox>
    </vbox>
  </vbox>
</page>
