/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

/* Style for the custom element "unified-extensions-item". */

:root {
  --icon-size: 32px;
  --dot-position: calc(var(--icon-size) / 2 + var(--arrowpanel-menuitem-margin-inline) + var(--arrowpanel-menuitem-padding-inline) - 4px);
}

:root[uidensity="compact"] {
  --icon-size: 24px;
}

unified-extensions-item {
  align-items: center;
  display: flex;
}

/* This is based on the attention UI defined in:
 * https://searchfox.org/mozilla-central/rev/560b7b1b17/browser/themes/shared/tabs.css#624 */
#unified-extensions-button[attention],
.unified-extensions-item[attention],
unified-extensions-item[attention] {
  background-image: radial-gradient(circle, var(--tab-attention-icon-color), var(--tab-attention-icon-color) 2px, transparent 2px);
  background-position: center bottom max(0px, calc(var(--arrowpanel-menuitem-padding-block) - 4px));
  background-size: 8px 8px;
  background-repeat: no-repeat;
}

unified-extensions-item[attention] {
  background-position: left var(--dot-position) bottom 0px;
}

unified-extensions-item[attention]:-moz-locale-dir(rtl) {
  background-position-x: right var(--dot-position);
}

.unified-extensions-item-action {
  overflow: hidden;
}

/* The padding-block for menuitems is set to 0 in compact mode which, with the
 * extension icon being 32px in this case, makes the item look crowded even for
 * compact mode. */
:root[uidensity="compact"] panel:not([touchmode]) .unified-extensions-item-action {
  padding-block: 4px;
}

.unified-extensions-item-action[disabled].subviewbutton {
  color: var(--panel-description-color);
}

.unified-extensions-item-action[disabled] .unified-extensions-item-icon {
  opacity: 0.5;
}

unified-extensions-item[secondary-button-hovered="true"] .unified-extensions-item-action.subviewbutton {
  color: inherit;
}

.unified-extensions-item-icon,
/* When the unified extensions pref is enabled, we also want to increase the
 * size of the icons in the extension CUI widgets. */
#unified-extensions-panel .unified-extensions-item[unified-extensions="true"] .webextension-browser-action > .toolbarbutton-badge-stack > .toolbarbutton-icon {
  height: var(--icon-size);
  width: var(--icon-size);
  margin-inline-end: 6px;
}

.unified-extensions-item-icon,
.unified-extensions-item-contents {
  pointer-events: none;
}

.unified-extensions-item-name,
.unified-extensions-item-message {
  margin: 0;
  padding-inline-start: .5em;
  width: 22em;
  word-break: break-word;
}

.unified-extensions-item-message {
  color: var(--panel-description-color);
}

unified-extensions-item[secondary-button-hovered="true"] .unified-extensions-item-message:not(.unified-extensions-item-message-hover),
unified-extensions-item:not([secondary-button-hovered="true"]) .unified-extensions-item-message-hover,
/* The two selectors below are for CUI widgets. */
.unified-extensions-item[secondary-button-hovered="true"] .unified-extensions-item-message:not(.unified-extensions-item-message-hover),
.unified-extensions-item:not([secondary-button-hovered="true"]) .unified-extensions-item-message-hover {
  display: none;
}

.unified-extensions-item-open-menu.subviewbutton {
  list-style-image: url("chrome://global/skin/icons/settings.svg");
  margin: 0;
  margin-inline-end: var(--arrowpanel-menuitem-margin-inline);
  /* Have the icon even padding all around by default */
  padding: var(--arrowpanel-menuitem-padding-inline);
}

.unified-extensions-item-open-menu.subviewbutton > .toolbarbutton-text {
  display: none;
}

/* --- browser action CUI widget styles --- */

/* Hide secondary (menu) button when the widget is in the list of widgets in
 * customization mode. */
toolbaritem.unified-extensions-item:not([cui-areatype="panel"], [overflowedItem=true]) .unified-extensions-item-open-menu {
  display: none;
}

/* Hide subviewbutton label by default, it should only be shown in the overflow
 * panel and the palette. */
toolbaritem.unified-extensions-item[cui-areatype="toolbar"] .toolbarbutton-text {
  display: none;
}

/* Hide unified extensions content by default */
toolbaritem.unified-extensions-item:not([overflowedItem="true"]) .unified-extensions-item-contents {
  display: none;
}

toolbaritem.unified-extensions-item .unified-extensions-item-open-menu.subviewbutton {
  -moz-box-flex: 0;
  margin-inline-start: var(--arrowpanel-menuitem-margin-inline);
  padding: var(--arrowpanel-menuitem-padding);
}

/* --- browser action CUI widget styles in the overflow/unified extensions panel --- */

/* Align CUI widgets with the custom elements in the unified extensions panel. */
#unified-extensions-panel toolbaritem.unified-extensions-item {
  max-width: max-content;
}

/* Show CUI widget label in overflow panel when the unified extensions pref is
 * not set. */
.widget-overflow-list toolbaritem.unified-extensions-item[unified-extensions="false"] .unified-extensions-item-action .toolbarbutton-text {
  text-align: start;
  display: block;
}

/* This will be removed as part of 1777484 */
panel toolbaritem.unified-extensions-item .unified-extensions-item-message {
  display: none;
}

.widget-overflow-list .unified-extensions-item[attention] {
  background-position: left 12px bottom;
}

.widget-overflow-list .unified-extensions-item[attention]:-moz-locale-dir(rtl) {
  background-position-x: right 12px;
}

#unified-extensions-panel .unified-extensions-item[attention] {
  background-position: left calc(12px + var(--arrowpanel-menuitem-margin-inline)) bottom;
}

#unified-extensions-panel .unified-extensions-item[attention]:-moz-locale-dir(rtl) {
  background-position-x: right calc(12px + var(--arrowpanel-menuitem-margin-inline));
}
