/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

@media (-moz-windows-default-theme) {
  @media (-moz-windows-accent-color-in-titlebar) {
    :root[sizemode=normal][tabsintitlebar] #navigator-toolbox {
      border-top: .5px solid ActiveBorder;
    }
  }

  :root[sizemode=normal][tabsintitlebar]:-moz-window-inactive #navigator-toolbox {
    border-top-color: InactiveBorder;
  }

  :root[tabsintitlebar] .tab-label:-moz-window-inactive {
    /* Calculated to match the opacity change of Windows Explorer
       titlebar text change for inactive windows. */
    opacity: .6;
  }

  :root[tabsintitlebar] .tab-secondary-label:-moz-window-inactive {
    opacity: .6;
  }
}

/* See bug 1715990 about why we do this ourselves on HCM */
@media (prefers-contrast) {
  :root[tabsintitlebar]:not(:-moz-lwtheme) {
    background-color: ActiveCaption;
    color: CaptionText;
  }

  :root[tabsintitlebar]:not(:-moz-lwtheme):-moz-window-inactive {
    background-color: InactiveCaption;
    color: InactiveCaptionText;
  }
}

.titlebar-button {
  appearance: none !important;
  border: none;
  margin: 0 !important;
  padding: 8px 17px;
  -moz-context-properties: stroke;
  stroke: currentColor;
}

.titlebar-button > .toolbarbutton-icon {
  width: 12px;
  height: 12px;
}

.titlebar-min {
  list-style-image: url(chrome://browser/skin/window-controls/minimize.svg);
}

.titlebar-max {
  list-style-image: url(chrome://browser/skin/window-controls/maximize.svg);
}

.titlebar-restore {
  list-style-image: url(chrome://browser/skin/window-controls/restore.svg);
}

.titlebar-restore > .toolbarbutton-icon:-moz-locale-dir(rtl) {
  transform: scaleX(-1);
}

.titlebar-close {
  list-style-image: url(chrome://browser/skin/window-controls/close.svg);
}

:root[lwtheme-image] .titlebar-button {
  -moz-context-properties: unset;
}
:root[lwtheme-image] .titlebar-min {
  list-style-image: url(chrome://browser/skin/window-controls/minimize-themes.svg);
}
:root[lwtheme-image] .titlebar-max {
  list-style-image: url(chrome://browser/skin/window-controls/maximize-themes.svg);
}
:root[lwtheme-image] .titlebar-restore {
  list-style-image: url(chrome://browser/skin/window-controls/restore-themes.svg);
}
:root[lwtheme-image] .titlebar-close {
  list-style-image: url(chrome://browser/skin/window-controls/close-themes.svg);
}

/* the 12px image renders a 10px icon, and the 10px upscaled gets rounded to 12.5, which
 * rounds up to 13px, which makes the icon one pixel too big on 1.25dppx. Fix: */
@media (min-resolution: 1.20dppx) and (max-resolution: 1.45dppx) {
  .titlebar-button > .toolbarbutton-icon {
    width: 11.5px;
    height: 11.5px;
  }
}

/* 175% dpi should result in the same device pixel sizes as 150% dpi. */
@media (min-resolution: 1.70dppx) and (max-resolution: 1.95dppx) {
  .titlebar-button {
    padding-inline: 14.1px;
  }

  .titlebar-button > .toolbarbutton-icon {
    width: 10.8px;
    height: 10.8px;
  }
}

/* 225% dpi should result in the same device pixel sizes as 200% dpi. */
@media (min-resolution: 2.20dppx) and (max-resolution: 2.45dppx) {
  .titlebar-button {
    padding-inline: 15.3333px;
  }

  .titlebar-button > .toolbarbutton-icon {
    width: 10.8px;
    height: 10.8px;
  }
}

/* 275% dpi should result in the same device pixel sizes as 250% dpi. */
@media (min-resolution: 2.70dppx) and (max-resolution: 2.95dppx) {
  /* NB: todo: this should also change padding on the buttons
   * themselves, but without a device to test this on, it's
   * impossible to know by how much. */
  .titlebar-button > .toolbarbutton-icon {
    width: 10.8px;
    height: 10.8px;
  }
}

@media (-moz-windows-default-theme) {
  #main-menubar > menu[_moz-menuactive="true"] {
    color: inherit;
  }

  #main-menubar > menu[_moz-menuactive="true"],
  .titlebar-button:hover {
    background-color: hsla(0,0%,0%,.12);
  }
  .titlebar-button:hover:active {
    background-color: hsla(0,0%,0%,.22);
  }

  #toolbar-menubar[brighttext] > #menubar-items > #main-menubar > menu[_moz-menuactive="true"],
  toolbar[brighttext] .titlebar-button:not(.titlebar-close):hover {
    background-color: hsla(0,0%,100%,.22);
  }
  toolbar[brighttext] .titlebar-button:not(.titlebar-close):hover:active {
    background-color: hsla(0,0%,100%,.32);
  }

  .titlebar-close:hover {
    stroke: white;
    background-color: hsl(355,86%,49%);
  }
  .titlebar-close:hover:active {
    background-color: hsl(355,82%,69%);
  }

  .titlebar-button:not(:hover) > .toolbarbutton-icon:-moz-window-inactive {
    opacity: 0.5;
  }
}

@media (-moz-windows-default-theme: 0) {
  .titlebar-button {
    background-color: -moz-field;
    stroke: ButtonText;
  }
  .titlebar-button:hover {
    background-color: SelectedItem;
    stroke: SelectedItemText;
  }

  .titlebar-min {
    list-style-image: url(chrome://browser/skin/window-controls/minimize-highcontrast.svg);
  }

  .titlebar-max {
    list-style-image: url(chrome://browser/skin/window-controls/maximize-highcontrast.svg);
  }

  .titlebar-restore {
    list-style-image: url(chrome://browser/skin/window-controls/restore-highcontrast.svg);
  }

  .titlebar-close {
    list-style-image: url(chrome://browser/skin/window-controls/close-highcontrast.svg);
  }

  :root[darkwindowframe="true"]:not(:-moz-window-inactive, :-moz-lwtheme) {
    color: white;
  }

  #appcontent:not(:-moz-lwtheme) {
    background-color: -moz-dialog;
  }
}
