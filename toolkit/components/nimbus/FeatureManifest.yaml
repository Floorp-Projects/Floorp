# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

# Features must be added here to be accessible through the NimbusFeature API.

"no-feature-firefox-desktop":
  description: A dummy feature for experiments that target no feature.
  owner: barret@mozilla.com
  applications:
    - firefox-desktop
    - firefox-desktop-background-task
  hasExposure: false
  variables: {}

testFeature:
  description: Test only feature
  owner: barret@mozilla.com
  applications:
    - firefox-desktop
    - firefox-desktop-background-task
  hasExposure: false
  isEarlyStartup: true
  variables:
    enabled:
      type: boolean
      description: Whether or not this feature is enabled
    testInt:
      type: int
      fallbackPref: nimbus.testing.testInt
      description: Int pref used by platform API tests
    testSetString:
      type: string
      setPref: nimbus.testing.testSetString
      description: A string pref set by Nimbus tests

nimbus-qa-1:
  description: A feature for testing pref-setting on the default branch.
  owner: barret@mozilla.com
  hasExposure: false
  variables:
    value:
      type: string
      setPref: nimbus.qa.pref-1
      description: The value to set for the pref.

nimbus-qa-2:
  description: A feature for testing pref-setting on the user branch.
  owner: barret@mozilla.com
  isEarlyStartup: true
  hasExposure: false
  variables:
    value:
      type: string
      setPref: nimbus.qa.pref-2
      description: The value to set for the pref.

# `search` is for search engine experimentation features which do not require
# isEarlyStartup to be set.
search:
  description: Search engine experimentation support and testing features.
  owner: search-and-suggest-program@mozilla.com
  hasExposure: false
  variables:
    extraParams:
      type: json
      description: >-
        This allows extra parameters to be set for search engines requests including,
        where calls to the suggestions API, the search engine configuration defines
        those parameters.

        The use of this field should be coordinated with the Search team.

        The field value is an array of objects with key/value fields. For example:

        [
          {"key": "google_channel_row", "value": "foo"}
        ]

        This is matched to a section in the search configuration:

        "extraParams": [
          {
            "name": "channel",
            "pref": "google_channel_row",
            "condition": "pref"
          }
        ],

        In this case, the resulting URL for the appropriate search engine would have
        `&channel=foo` added to the URL when doing searches.

        If the key is not referenced in the search configuration, then no parameter
        will be added. Only the search team can update the configuration.
    cbhStudyUs:
      type: string
      setPref: browser.search.param.google_channel_us
      description: >-
        NOTE: Please use `extraParams` rather than this field.
        A string pref set by Nimbus tests for US search cohort
    cbhStudyRow:
      type: string
      setPref: browser.search.param.google_channel_row
      description: >-
        NOTE: Please use `extraParams` rather than this field.
        A string pref set by Nimbus tests for Rest of World (ROW) search cohort
    richSuggestionsFeatureGate:
      type: boolean
      setPref: browser.urlbar.richSuggestions.featureGate
      description: >-
        Feature gate that controls whether Rich Suggestions are enabled.
    serpEventTelemetryEnabled:
      type: boolean
      setPref: browser.search.serpEventTelemetry.enabled
      description: Whether the Glean SERP event telemetry is enabled.
    serpEventTelemetryCategorizationEnabled:
      type: boolean
      setPref: browser.search.serpEventTelemetryCategorization.enabled
      description: Whether the Glean SERP event telemetry for SERP categorization is enabled.
    trendingEnabled:
      type: boolean
      setPref: browser.urlbar.trending.featureGate
      description: Feature gate that controls whether trending suggestions are enabled.
    trendingRequireSearchMode:
      type: boolean
      setPref: browser.urlbar.trending.requireSearchMode
      description: Controls whether trending suggestions are only shown in search mode or not.
    trendingMaxResultsNoSearchMode:
      type: int
      setPref: browser.urlbar.trending.maxResultsNoSearchMode
      description: The maximum number of trending results mode outside search mode.

# `searchConfiguration` is for search experiment features for items that require
# isEarlyStartup to be true. These items may require a reload of the search
# engine configuration, and an additional reload may happen during the startup
# process.
searchConfiguration:
  description: Search experimentation support for the engine configuration
  owner: search-and-suggest-program@mozilla.com
  isEarlyStartup: true
  hasExposure: false
  variables:
    experiment:
      type: string
      fallbackPref: browser.search.experiment
      description: >-
        Used to activate only matching configurations that contain the value in
        `experiment`
    seperatePrivateDefaultUIEnabled:
      type: boolean
      description: Whether the UI for the separate private default feature is enabled.
    seperatePrivateDefaultUrlbarResultEnabled:
      type: boolean
      description: Whether the urlbar result for the separate private default is shown.

urlbar:
  description: The Address Bar
  owner: search-and-suggest-program@mozilla.com
  hasExposure: true
  exposureDescription: >-
    The timing of the exposure event depends on the experiment, but generally
    the event is recorded once per app session when the user first encounters
    the UI of the experiment in which they're enrolled.
  variables:
    addonsFeatureGate:
      type: boolean
      fallbackPref: browser.urlbar.addons.featureGate
      description: >-
        Feature gate that controls whether all aspects of the addons suggestion
        feature are exposed to the user.
    addonsShowLessFrequentlyCap:
      type: int
      description: >-
        If defined and non-zero, this is the maximum number of times the user
        will be able to click the "Show less frequently" command for addon
        suggestions. If undefined or zero, the user will be able to click the
        command without any limit.
    autoFillAdaptiveHistoryEnabled:
      type: boolean
      fallbackPref: browser.urlbar.autoFill.adaptiveHistory.enabled
      description: Whether enabling adaptive history autofill.
    autoFillAdaptiveHistoryMinCharsThreshold:
      type: int
      fallbackPref: browser.urlbar.autoFill.adaptiveHistory.minCharsThreshold
      description: Minimum char length of the user's search string to trigger adaptive history autofill.
    autoFillAdaptiveHistoryUseCountThreshold:
      type: string
      description: This value assumes float expression like "0.47". Threshold for use count of input history that we handle as adaptive history autofill. If the use count is this value or more, it will be a candidate.
    experimentType:
      type: string
      description: The type of the experiment (or rollout). If "best-match", then the Nimbus exposure event will be recorded when the user first triggers a best match (or would have triggered a best match, for users in the control group). If "modal", the event will be recorded when the user first triggers to show the onbording dialog. If empty, the event will be recorded when the user first triggers any type of Suggest suggestion.
      enum:
        - best-match
        - modal
        - ""
    mdnFeatureGate:
      type: boolean
      setPref: browser.urlbar.mdn.featureGate
      description: >-
        Feature gate that controls whether all aspects of the mdn suggestion
        feature are exposed to the user.
    merinoClientVariants:
      type: string
      fallbackPref: browser.urlbar.merino.clientVariants
      description: >-
        Comma separated list of client variants to report to the Merino server.
        May impact server behavior.
    merinoEndpointURL:
      type: string
      fallbackPref: browser.urlbar.merino.endpointURL
      description: >-
        The Merino endpoint URL, not including parameters. An empty string will
        cause Firefox not to fetch from Merino.
    merinoProviders:
      type: string
      fallbackPref: browser.urlbar.merino.providers
      description: >-
        Comma-separated list of providers to request from the Merino server.
        Merino will return suggestions only for these providers.
    merinoTimeoutMs:
      type: int
      fallbackPref: browser.urlbar.merino.timeoutMs
      description: Timeout for Merino fetches (ms)
    exposureResults:
      type: string
      setPref: browser.urlbar.exposureResults
      description: >-
        Comma-separated list of result type combinations, that are used to determine if an exposure event should be fired.
    showExposureResults:
      type: boolean
      setPref: browser.urlbar.showExposureResults
      description: >-
        Boolean used to determine if the results defined in `exposureResults` should be shown in search results. Should be false for Control branch of an experiment.
    pocketFeatureGate:
      type: boolean
      fallbackPref: browser.urlbar.pocket.featureGate
      description: >-
        Feature gate that controls whether all aspects of the Pocket suggestions
        feature are exposed to the user.
    pocketShowLessFrequentlyCap:
      type: int
      description: >-
        If defined and non-zero, this is the maximum number of times the user
        will be able to click the "Show less frequently" command for Pocket
        suggestions. If undefined or zero, the user will be able to click the
        command without any limit.
    quickSuggestAllowPositionInSuggestions:
      type: boolean
      fallbackPref: browser.urlbar.quicksuggest.allowPositionInSuggestions
      description: Whether quick suggest results can be shown in position specified in the suggestions.
    quickSuggestContextualOptInEnabled:
      type: boolean
      setPref: browser.urlbar.quicksuggest.contextualOptIn
      description: Whether the Firefox Suggest contextual opt-in result is enabled. If true, this implicitly disables shouldShowOnboardingDialog.
    quickSuggestContextualOptInSayHello:
      type: boolean
      setPref: browser.urlbar.quicksuggest.contextualOptIn.sayHello
      description: Controls which variant of the copy is used for the Firefox Suggest contextual opt-in result.
    quickSuggestContextualOptInTopPosition:
      type: boolean
      setPref: browser.urlbar.quicksuggest.contextualOptIn.topPosition
      description: Controls whether the Firefox Suggest contextual opt-in result appears at the top of results or at the bottom, after one-off buttons.
    quickSuggestDataCollectionEnabled:
      type: boolean
      description: Whether data collection should be enabled by default. If this variable is specified, it will override the value implied by the scenario. It will never override the user's local preference to disable (or enable) data collection, if the user has already toggled that preference.
    quickSuggestEnabled:
      type: boolean
      fallbackPref: browser.urlbar.quicksuggest.enabled
      description: Gate for the Firefox Suggest feature as a whole. If false, the Firefox Suggest preferences UI and Suggest suggestions will not be shown. If true, the preferences UI will be shown, and the user can turn suggestions on or off.
    quickSuggestImpressionCapsSponsoredEnabled:
      type: boolean
      fallbackPref: browser.urlbar.quicksuggest.impressionCaps.sponsoredEnabled
      description: Whether sponsored suggestions are subject to impression frequency caps. If false, sponsored suggestions can be shown an unlimited number of times over any given period. If true, sponsored suggestion impressions will be subject to the caps in the remote settings configuration.
    quickSuggestImpressionCapsNonSponsoredEnabled:
      type: boolean
      fallbackPref: browser.urlbar.quicksuggest.impressionCaps.nonSponsoredEnabled
      description: Whether non-sponsored suggestions are subject to impression frequency caps. If false, non-sponsored suggestions can be shown an unlimited number of times over any given period. If true, non-sponsored suggestion impressions will be subject to the caps in the remote settings configuration.
    quickSuggestNonSponsoredEnabled:
      type: boolean
      description: Whether non-sponsored suggestions should be enabled by default. If this variable is specified, it will override the value implied by the scenario. It will never override the user's local preference to disable (or enable) non-sponsored suggestions, if the user has already toggled that preference.
    quickSuggestNonSponsoredIndex:
      type: int
      fallbackPref: browser.urlbar.quicksuggest.nonSponsoredIndex
      description: >-
        The index of non-sponsored QuickSuggest results within the general
        group. A negative index is relative to the end of the group
    quickSuggestOnboardingDialogVariation:
      type: string
      description: >-
        Specify the messages/UI variation for QuickSuggest onboarding dialog. This value is case insensitive.
    quickSuggestRemoteSettingsDataType:
      type: string
      description: The `type` of the suggestions data in remote settings. If not specified, "data" is used.
    quickSuggestRustEnabled:
      type: boolean
      fallbackPref: browser.urlbar.quicksuggest.rustEnabled
      description: >-
        Whether Firefox Suggest will use the new Rust backend instead of the
        original JS backend.
    quickSuggestScenario:
      # IMPORTANT: This should not have a fallbackPref. See UrlbarPrefs.jsm.
      type: string
      description: The Firefox Suggest scenario in which the user is enrolled
      enum:
        - history
        - offline
        - online
    quickSuggestScoreMap:
      type: json
      description: >-
        A JSON object that maps telemetry result types to suggestion scores. If
        a telemetry result type is present in this map, the client will use the
        corresponding score as the score for all suggestions of the type,
        overriding all other sources of scores for the type. In other words,
        the scores in this map will override scores that are set in remote
        settings and Merino as well as scores that are hardcoded in the client.
        Example entries: `"amo": 0.5`, `"adm_sponsored": 0.9`
    quickSuggestShouldShowOnboardingDialog:
      type: boolean
      fallbackPref: browser.urlbar.quicksuggest.shouldShowOnboardingDialog
      description: Whether or not to show the QuickSuggest onboarding dialog
    quickSuggestShowOnboardingDialogAfterNRestarts:
      type: int
      fallbackPref: browser.urlbar.quicksuggest.showOnboardingDialogAfterNRestarts
      description: Show QuickSuggest onboarding dialog after N browser restarts
    quickSuggestSponsoredEnabled:
      type: boolean
      description: Whether sponsored suggestions should be enabled by default. If this variable is specified, it will override the value implied by the scenario. It will never override the user's local preference to disable (or enable) sponsored suggestions, if the user has already toggled that preference.
    quickSuggestSponsoredIndex:
      type: int
      fallbackPref: browser.urlbar.quicksuggest.sponsoredIndex
      description: >-
        The index of sponsored QuickSuggest results within the general group. A
        negative index is relative to the end of the group
    quickSuggestSponsoredPriority:
      type: boolean
      fallbackPref: browser.urlbar.quicksuggest.sponsoredPriority
      description: >-
        Whether or not showing sponsored suggestion as priority.
        If this variable is true, the following things are processed.
        * "Sponsored" label is shown as the group label.
        * Change the suggested index to 1.
        * Handle as top pick.
    recentSearchesFeatureGate:
      type: boolean
      setPref: browser.urlbar.recentsearches.featureGate
      description: Gate for the recent searches feature.
    recentSearchesMaxResults:
      type: int
      setPref: browser.urlbar.recentsearches.maxResults
      description: The maximum number of recent searches to show.
    recordNavigationalSuggestionTelemetry:
      type: boolean
      description: Whether to record navigational suggestion telemetry. Defaults to false.
    showSearchTermsFeatureGate:
      type: boolean
      fallbackPref: browser.urlbar.showSearchTerms.featureGate
      description: Gate for the show search terms feature. If false, the preference#search will not show the search terms feature checkbox, and search terms will never persist in the urlbar. If true, the preference checkbox will be shown on preferences#search, and the user can choose to persist search terms on or off in the urlbar.
    weatherFeatureGate:
      type: boolean
      fallbackPref: browser.urlbar.weather.featureGate
      description: >-
        Feature gate that controls whether all aspects of the weather suggestion
        feature are exposed to the user. See also `weatherKeywords` and
        `weatherKeywordsMinimumLength`. In summary: To enable the weather
        suggestion, set `weatherFeatureGate` to true, `weatherKeywords` to an
        array of full keyword strings, and `weatherKeywordsMinimumLength` to a
        non-zero integer. To disable the weather suggestion, leave out all
        weather-related variables.
    weatherKeywords:
      type: json
      description: >-
        An array of full keyword strings that will trigger the weather
        suggestion when the user types them in the address bar. If absent or
        null, Firefox will fall back to the weather keywords defined in remote
        settings. If neither Nimbus nor remote settings defines any keywords,
        the weather suggestion will be disabled. See also
        `weatherKeywordsMinimumLength`.
    weatherKeywordsMinimumLength:
      type: int
      description: >-
        If defined and non-zero, the weather suggestion will be triggered by
        typing any prefix of a full weather keyword when the prefix is at least
        `weatherKeywordsMinimumLength` characters long. If this variable is
        absent or zero, Firefox will fall back to the minimum length defined in
        remote settings. If neither Nimbus nor remote settings defines a minimum
        length, only full keywords will trigger the suggestion. See also
        `weatherKeywords`.
    weatherKeywordsMinimumLengthCap:
      type: int
      description: >-
        If defined and non-zero, the user will not be able to increment the
        minimum keyword length beyond this value. e.g., if this value is 6, the
        current minimum length is 5, and the user clicks "Show less frequently",
        then the minimum length will be incremented to 6, the "Show less
        frequently" command will be hidden, and the user can continue to trigger
        the weather suggestion by typing 6 characters, but they will not be able
        to increment the minimum length any further. If this variable is absent
        or zero, Firefox will fall back to the cap defined in remote settings.
        If neither Nimbus nor remote settings defines a cap, no cap will be
        used, and the user will be able to increment the minimum length without
        any limit.

frecency:
  description: "The address bar ranking algorithm"
  owner: search-and-suggest-program@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    originsAlternativeEnable:
      description: >-
        Use an alternative ranking algorithm for autofilling origins, that is
        mainly domains of Web pages. When the user types the beginning of an
        origin, we autofill the whole origin. Whether autofill happens depends
        on the ranking algorithm. Bookmarks are always autofilled anyway.
      type: boolean
      setPref: "places.frecency.origins.alternative.featureGate"
    originsDaysCutOff:
      description: >-
        The alternative ranking algorithm only considers pages visited in the
        last N days, where N is controlled by this variable.
      type: int
      setPref: "places.frecency.origins.alternative.daysCutOff"
    pagesAlternativeEnable:
      description: >-
        Use an alternative ranking algorithm for sorting history and bookmarks
        among the urlbar results.
      type: boolean
      setPref: "places.frecency.pages.alternative.featureGate"
    pagesNumSampledVisits:
      description: >-
        The number of recent visits to sample when calculating the ranking of
        a page. Examining all the visits would be expensive, so we only sample
        recent visits.
      type: int
      setPref: "places.frecency.pages.alternative.numSampledVisits"
    pagesHalfLifeDays:
      description: >-
        The number of days after which the ranking halves. This implements the
        "recency" part of the algorithm.
      type: int
      setPref: "places.frecency.pages.alternative.halfLifeDays"
    pagesHighWeight:
      description: >-
        The weight to use for the high importance bucket.
      type: int
      setPref: "places.frecency.pages.alternative.highWeight"
    pagesMediumWeight:
      description: >-
        The weight to use for the medium importance bucket.
      type: int
      setPref: "places.frecency.pages.alternative.mediumWeight"
    pagesLowWeight:
      description: >-
        The weight to use for the low importance bucket.
      type: int
      setPref: "places.frecency.pages.alternative.lowWeight"

aboutwelcome:
  description: "The about:welcome page"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    Exposure is sent once per browsing session when the about:welcome URL is
    first accessed.
  isEarlyStartup: true
  variables:
    enabled:
      type: boolean
      fallbackPref: browser.aboutwelcome.enabled
      description: >-
        Should users see about:welcome? If this is false, users will see a
        regular new tab instead.
    id:
      type: string
      description: >-
        Descriptive ID for the about:welcome content
    screens:
      type: json
      fallbackPref: browser.aboutwelcome.screens
      description: Content to show in the onboarding flow
    languageMismatchEnabled:
      type: boolean
      fallbackPref: intl.multilingual.aboutWelcome.languageMismatchEnabled
      description: >-
        Suggest to change the language on about:welcome when there is a mismatch with
        the OS.
    transitions:
      type: boolean
      description: Enable transition effect between screens
    showModal:
      type: boolean
      fallbackPref: browser.aboutwelcome.showModal
      description: >-
        Should users see window modal onboarding
    backdrop:
      type: string
      fallbackPref: browser.aboutwelcome.backdrop
      description: >-
        Specify the color to be used to update the background color

moreFromMozilla:
  description: "New page on about:preferences to suggest more Mozilla products"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    Exposure is sent once per browsing session when the about:preferences URL is
    first accessed.
  variables:
    enabled:
      type: boolean
      fallbackPref: browser.preferences.moreFromMozilla
      description: Should users see the new more from Mozilla section.
    template:
      type: string
      fallbackPref: browser.preferences.moreFromMozilla.template
      description: UI template used to display Mozilla products. Possible values simple, advanced. Default is simple.

windowsLaunchOnLogin:
  description: "New checkbox in about:preferences startup section to start Firefox on Windows login"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    Exposure is sent once per browsing session when the about:preferences URL is
    first accessed.
  variables:
    enabled:
      type: boolean
      setPref: browser.startup.windowsLaunchOnLogin.enabled
      description: Should users see the Windows launch on login checkbox.

abouthomecache:
  description: "The startup about:home cache."
  owner: omc@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    enabled:
      type: boolean
      fallbackPref: browser.startup.homepage.abouthome_cache.enabled
      description: Is the feature enabled?

newtab:
  description: "The about:newtab page"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    Exposure is sent once per browsing session when the first newtab page loads
    (either about:newtab or about:home).
  isEarlyStartup: true
  variables:
    newTheme:
      type: boolean
      description: Enable the new theme
    customizationMenuEnabled:
      type: boolean
      fallbackPref: browser.newtabpage.activity-stream.customizationMenu.enabled
      description: Enable the customization panel inside of the newtab
    prefsButtonIcon:
      type: string
      description: Icon url to use for the preferences button
    topSitesContileEnabled:
      type: boolean
      fallbackPref: browser.topsites.contile.enabled
      description: Enable the Contile integration for Sponsored Top Sites
    topSitesUseAdditionalTilesFromContile:
      type: boolean
      description: Allow Contile to use additonal sponsored top sites

pocketNewtab:
  description: The Pocket section in newtab
  owner: sdowne@getpocket.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    spocPositions:
      type: string
      fallbackPref: browser.newtabpage.activity-stream.discoverystream.spoc-positions
      description: CSV string of spoc position indexes on newtab Pocket grid
    spocTopsitesPositions:
      type: string
      fallbackPref: browser.newtabpage.activity-stream.discoverystream.spoc-topsites-positions
      description: CSV string of spoc position indexes on newtab topsites section
    spocAdTypes:
      type: string
      fallbackPref: browser.newtabpage.activity-stream.discoverystream.spocAdTypes
      description: CSV string of data to set the spoc content.
    spocZoneIds:
      type: string
      fallbackPref: browser.newtabpage.activity-stream.discoverystream.spocZoneIds
      description: CSV string of data to set the spoc content.
    spocTopsitesAdTypes:
      type: string
      fallbackPref: browser.newtabpage.activity-stream.discoverystream.spocTopsitesAdTypes
      description: CSV string of data to set the spoc content.
    spocTopsitesZoneIds:
      type: string
      fallbackPref: browser.newtabpage.activity-stream.discoverystream.spocTopsitesZoneIds
      description: CSV string of data to set the spoc content.
    spocTopsitesPlacementEnabled:
      type: boolean
      fallbackPref: browser.newtabpage.activity-stream.discoverystream.spocTopsitesPlacement.enabled
      description: Tuns on and off the sponsored topsites placement.
    spocSiteId:
      type: string
      fallbackPref: browser.newtabpage.activity-stream.discoverystream.spocSiteId
      description: String ID to set the spoc content.
    widgetPositions:
      type: string
      fallbackPref: browser.newtabpage.activity-stream.discoverystream.widget-positions
      description: CSV string of widget position indexes on newtab grid
    hybridLayout:
      type: boolean
      fallbackPref: browser.newtabpage.activity-stream.discoverystream.hybridLayout.enabled
      description: Enable compact cards on newtab grid only for specific breakpoints
    hideCardBackground:
      type: boolean
      fallbackPref: browser.newtabpage.activity-stream.discoverystream.hideCardBackground.enabled
      description: Removes Pocket card background and borders.
    fourCardLayout:
      type: boolean
      fallbackPref: browser.newtabpage.activity-stream.discoverystream.fourCardLayout.enabled
      description: Enable four Pocket cards per row.
    newFooterSection:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.newFooterSection.enabled
      description: Enable an updated Pocket section topics footer
    saveToPocketCard:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.saveToPocketCard.enabled
      description: >-
        A save to Pocket button inside the card, shown on the card thumbnail, on
        hover.
    saveToPocketCardRegions:
      type: string
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.saveToPocketCardRegions
      description: >-
        CSV string of regions that support the save to Pocket button inside the card.
    hideDescriptions:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.hideDescriptions.enabled
      description: >-
        Hide or display descriptions for Pocket stories on newtab.
    hideDescriptionsRegions:
      type: string
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.hideDescriptionsRegions
      description: >-
        CSV string of regions that hide descriptions for Pocket stories on newtab.
    compactGrid:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.compactGrid.enabled
      description: >-
        Reduce the number of pixels between the Pocket cards on newtab.
    compactImages:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.compactImages.enabled
      description: >-
        Reduce the height on Pocket card images on newtab.
    imageGradient:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.imageGradient.enabled
      description: >-
        Add a gradient to the bottom of Pocket card images on newtab to blend the
        image in with the card.
    titleLines:
      type: int
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.titleLines
      description: >-
        Changes the maximum number of lines a title can be for Pocket cards on newtab.
    descLines:
      type: int
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.descLines
      description: >-
        Changes the maximum number of lines a description can be for Pocket cards on newtab.
    onboardingExperience:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.onboardingExperience.enabled
      description: >-
        Enables an onboarding experience for Pocket section on newtab.
    essentialReadsHeader:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.essentialReadsHeader.enabled
      description: >-
        Updates the Pocket section header and title to say "Today’s Essential Reads",
        moves the "Recommended by Pocket" header to the right side.
    editorsPicksHeader:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.editorsPicksHeader.enabled
      description: >-
        Updates the Pocket section header and title to say "Editor’s Picks", if used with
        essentialReadsHeader, creates a second section 2 rows down for editorsPicksHeader.
    recentSavesEnabled:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.recentSaves.enabled
      description: >-
        Updates the Pocket section with a new header and 1 row of recently saved Pocket stories.
    readTime:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.readTime.enabled
      description: >-
        Displays an estimated read time for Pocket cards on newtab.
    newSponsoredLabel:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.newSponsoredLabel.enabled
      description: >-
        Updates the sponsored label position to below the image for Pocket cards on newtab.
    sendToPocket:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.sendToPocket.enabled
      description: >-
        Decides what to do when a logged out user click "Save to Pocket" from a Pocket card.
    recsPersonalized:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.recs.personalized
      description: >-
        Enables Pocket stories personalization.
    spocsPersonalized:
      type: boolean
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.spocs.personalized
      description: >-
        Enables Pocket sponsored content personalization.
    spocsCacheTimeout:
      type: int
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.spocs.cacheTimeout
      description: >-
        Set sponsored content cache timeout in minutes.
    discoveryStreamConfig:
      description: A JSON blob of discovery stream configuration.
      type: string
      setPref: "browser.newtabpage.activity-stream.discoverystream.config"
    spocsEndpoint:
      description: The URL for the spocs endpoint.
      type: string
      setPref: "browser.newtabpage.activity-stream.discoverystream.spocs-endpoint"
    regionStoriesConfig:
      description: A comma-separated list of region to get stories for.
      type: string
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.region-stories-config
    regionBffConfig:
      type: string
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.region-bff-config
      description: A comma-separated list of regions to get stories from the recommendations BFF. Also requires region-stories-config.
    regionStoriesBlock:
      description: A comma-separated list of regions that do not get stories, regardless of locale-list-config.
      type: string
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.region-stories-block
    localeListConfig:
      description: A comma-separated list of locales that get stories, regardless of region-stories-config.
      type: string
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.locale-list-config
    regionSpocsConfig:
      description: A comma-separated list of regions that get spocs by default.
      type: string
      fallbackPref: >-
        browser.newtabpage.activity-stream.discoverystream.region-spocs-config
    topSitesMaxSponsored:
      # Defined under `pocketNewtab` as it needs to be used along with other variables
      type: int
      description: The maximum number of sponsored Top Sites to be displayed
    topSitesContileMaxSponsored:
      # Defined under `pocketNewtab` as it needs to be used along with other variables
      type: int
      description: The maximum number of sponsored Top Sites used from Contile
    topSitesContileSovEnabled:
      # Defined under `pocketNewtab` as it needs to be used along with other variables
      description: Enable the Share-of-Voice feature for Sponsored Topsites.
      type: boolean
      fallbackPref: >-
        browser.topsites.contile.sov.enabled

saveToPocket:
  description: The save to Pocket feature
  owner: sdowne@getpocket.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    emailButton:
      type: boolean
      fallbackPref: extensions.pocket.refresh.emailButton.enabled
      description: Just for the new Pocket panels, enables the email signup button.
    hideRecentSaves:
      type: boolean
      fallbackPref: extensions.pocket.refresh.hideRecentSaves.enabled
      description: Hides the recently saved section in the home panel.
    bffRecentSaves:
      type: boolean
      fallbackPref: "extensions.pocket.bffRecentSaves"
      description: Use the new BFF Proxy Service instead of the legacy Pocket Service for Recent Saves
    bffApi:
      type: string
      fallbackPref: "extensions.pocket.bffApi"
      description: BFF Proxy Service domain
    oAuthConsumerKeyBff:
      type: string
      fallbackPref: "extensions.pocket.oAuthConsumerKeyBff"
      description: BFF Proxy Service OAuth Consumer Key

password-autocomplete:
  description: A special autocomplete UI for password fields.
  owner: sgalich@mozilla.com
  hasExposure: false
  variables:
    directMigrateSingleProfile:
      type: boolean
      description: Enable direct migration?

cm-csv-import:
  description: Importing logins from CSV files
  owner: issozi@mozilla.com
  hasExposure: false
  variables:
    csvImport:
      type: boolean
      description: Can show CSV Import in about:logins or Migration Wizard
      setPref: "signon.management.page.fileImport.enabled"

shellService:
  description: "Interface with OS, e.g., pinning and set default"
  owner: desktop-integrations@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    disablePin:
      type: boolean
      description: Disable pin to taskbar feature
    setDefaultBrowserUserChoice:
      type: boolean
      fallbackPref: browser.shell.setDefaultBrowserUserChoice
      description: Should it set as default browser
    setDefaultPDFHandler:
      type: boolean
      fallbackPref: browser.shell.setDefaultPDFHandler
      description: Should setting it as the default browser set it as the default PDF handler.
    setDefaultPDFHandlerOnlyReplaceBrowsers:
      type: boolean
      fallbackPref: browser.shell.setDefaultPDFHandler.onlyReplaceBrowsers
      description: >-
        Should setting it as the default PDF handler only replace existing PDF
        handlers that are browsers, and not other PDF handlers such as Acrobat
        Reader or Nitro PDF.

upgradeDialog:
  description: The dialog shown for major upgrades
  owner: omc@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    enabled:
      type: boolean
      fallbackPref: browser.startup.upgradeDialog.enabled
      description: Is the feature enabled?

cfr:
  description: "A Firefox Messaging System message for the cfr message channel"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

"moments-page":
  description: "A Firefox Messaging System message for the moments-page message channel"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

infobar:
  description: "A Firefox Messaging system message for the infobar message channel"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

spotlight:
  description: "A Firefox Messaging System message for the spotlight message channel"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

# Before 117, this feature only included one variable, pdfJsTourProgress. So,
# the minimum version for messaging experiments using this feature ID is 117.
featureCallout:
  description: "A Firefox Messaging System message for the Feature Callout message channel"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

fullPageTranslation:
  description: This feature opens a popup panel to offer to translate a page.
  owner: gtatum@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    boolean:
      description: Set to true to enable the translations feature
      type: boolean
      setPref: browser.translations.enable

fullPageTranslationAutomaticPopup:
  description: Controls whether the popup automatically shows for translations.
  owner: gtatum@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    boolean:
      description: Set to true to automatically popup, and false to only show the button.
      type: boolean
      setPref: browser.translations.automaticallyPopup

addAnImageInPDF:
  description: Add an image in an existing pdf.
  owner: cdenizet@mozilla.com
  hasExposure: false
  variables:
    boolean:
      description: Set to true to enable the add-an-image feature
      type: boolean
      setPref: pdfjs.enableStampEditor

# fxms-message-* placeholder feature ids
#
# https://docs.google.com/spreadsheets/d/119YbeKStLL0Fg2QkK-yN93mrtD1rlneGZGTl_jAwtyw/edit#gid=1903378504
# has info on using these placeholder feature ids, as well as (very short) instructions on
# checking to see if we need more (which we do once per Nightly) and how to add them.
#
# Instructions for adding a new fxms-message-* placeholder feature id
# 1) clone an existing one here
# 2) update the YAML feature id to the next unused number
# 3) update the YAML description
# 4) add the new feature id to MESSAGING_EXPERIMENTS_DEFAULT_FEATURES list in MessagingExperimentConstants.sys.mjs
# 5) add the new feature id and the version it landed to the spreadsheet tab linked to above

fxms-message-1:
  description: "A Firefox Messaging System message"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

fxms-message-2:
  description: "Firefox Messaging System message 2"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

fxms-message-3:
  description: "Firefox Messaging System message 3"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

fxms-message-4:
  description: "Firefox Messaging System message 4"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

fxms-message-5:
  description: "Firefox Messaging System message 5"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

fxms-message-6:
  description: "Firefox Messaging System message 6"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

fxms-message-7:
  description: "Firefox Messaging System message 7"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

fxms-message-8:
  description: "Firefox Messaging System message 8"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

fxms-message-9:
  description: "Firefox Messaging System message 9"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

fxms-message-10:
  description: "Firefox Messaging System message 10"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

fxms-message-11:
  description: "Firefox Messaging System message 11"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    "Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched."
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

pbNewtab:
  description: "A Firefox Messaging System message for the pbNewtab message channel"
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched.
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/MessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/MessagingExperiment.schema.json"
  variables: {}

backgroundTaskMessage:
  description: "A Firefox Messaging System message for the background task message channel"
  owner: nalexander@mozilla.com
  applications:
    - firefox-desktop-background-task
  hasExposure: true
  exposureDescription: >-
    Exposure is sent if the message is about to be shown after trigger and targeting conditions on the message matched.
  isEarlyStartup: false
  schema:
    uri: "resource://activity-stream/schemas/BackgroundTaskMessagingExperiment.schema.json"
    path: "browser/components/newtab/content-src/asrouter/schemas/BackgroundTaskMessagingExperiment.schema.json"
  variables: {}

pictureinpicture:
  description: Message for first time Picture-in-Picture users
  owner: nbaumgardner@mozilla.com
  hasExposure: true
  exposureDescription: Exposure is sent when a user hovers over a video and Picture-in-Picture has not been used before
  variables:
    title:
      type: string
      description: The title to be used for the PiP toggle
    message:
      type: string
      description: The message to be used in the PiP toggle
    showIconOnly:
      type: boolean
      description: Whether to show the first time PiP toggle or show the PiP icon only
    oldToggle:
      type: boolean
      description: Whether to show the control style (true) or variant style (false) for the first time PiP toggle
    displayDuration:
      type: int
      description: Duration of PiP first time toggle display in days before switching to PiP icon toggle

glean:
  description: "The Glean data-control-plane feature within Firefox Desktop for controlling metric configuration"
  owner: glean-team@mozilla.com
  hasExposure: false
  variables:
    newtabPingEnabled:
      type: "boolean"
      fallbackPref: "browser.newtabpage.ping.enabled"
      description: "Whether to submit the 'newtab' ping"
    gleanMetricConfiguration:
      type: json
      description: |
        A map of metric base-identifiers to booleans representing the state of the 'enabled' flag for that metric.
        This variable is intended for interacting with the Glean data-control-plane via the Server Knobs functionality
        to remotely configure metrics to be enabled or disabled.

gleanInternalSdk:
  description: "The Glean internal SDK feature intended only for internal Glean Team use"
  hasExposure: false
  # Some variables are used through the C++ API and thus require pref-storage.
  # We rely on those values at Glean.init time, which happens at startup.
  isEarlyStartup: true
  variables:
    finalInactive:
      type: "boolean"
      description: "Enables FOG early shutdown pings when true"
    gleanMetricConfiguration:
      type: json
      description: |
        A map of metric base-identifiers to booleans representing the state of the 'enabled' flag for that metric.
        This is not for public use! For data-control-plane use, please refer to the Glean documentation and use the
        `gleanMetricConfiguration` found in the `glean` feature for this.
    gleanMaxPingsPerMinute:
      type: int
      description: >-
        Maximum number of pings that can be sent in a 60 second interval
    enableEventTimestamps:
      type: "boolean"
      description: "Enables precise event timestamps for Glean events"

majorRelease2022:
  description: Major Release 2022
  owner: firefoxview@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    feltPrivacyPBMDarkTheme:
      type: boolean
      fallbackPref: "browser.theme.dark-private-windows"
      description: "Use dark theme variant for PBM windows. This is only supported if the theme sets darkTheme data."
    feltPrivacyShowPreferencesSection:
      type: boolean
      fallbackPref: "browser.privacySegmentation.preferences.show"
      description: "Controls visibility of the privacy segmentation preferences section."
    feltPrivacyWindowSeparation:
      type: boolean
      fallbackPref: "browser.privateWindowSeparation.enabled"
      description: "Whether or not private browsing windows use a separate icon in the Windows taskbar"
    colorwayCloset:
      type: boolean
      fallbackPref: "browser.theme.colorway-closet"
      description: "Whether or not to show the colorway closet modal"
    firefoxView:
      type: boolean
      fallbackPref: "browser.tabs.firefox-view"
      description: "Whether or not to show the firefox view tab"
    onboarding:
      type: boolean
      fallbackPref: "browser.majorrelease.onboarding"
      description: "Whether or not to use the MR2022 onboarding settings."

browserLowMemoryPrefs:
  description: Prefs which control the browser's behaviour under low memory.
  owner: haftandilian@mozilla.com
  hasExposure: false
  variables:
    lowMemoryResponseMask:
      description: Control the response on macOS when under memory pressure.
      type: int
      setPref: "browser.lowMemoryResponseMask"
    lowMemoryResponseOnWarn:
      description: Controls which macOS memory-pressure levels trigger the browser low memory response.
      type: boolean
      setPref: "browser.lowMemoryResponseOnWarn"
    tabsUnloadOnLowMemory:
      description: Whether to unload tabs when available memory is running low.
      type: boolean
      setPref: "browser.tabs.unloadOnLowMemory"

scriptLoaderPrefs:
  description: Prefs that control the script loader.
  owner: npierron@mozilla.com
  hasExposure: false
  variables:
    delazificationStrategy:
      description: >-
        Selects which parsing/delazification strategy should be used while
        parsing scripts off-main-thread. See DelazificationOption in
        CompileOptions.h for values.
      type: int
      setPref: "dom.script_loader.delazification.strategy"

echPrefs:
  description: Prefs that control Encrypted Client Hello.
  owner: djackson@mozilla.com
  hasExposure: false
  variables:
    tlsEnabled:
      description: Whether to enable ECH for connections using TLS
      type: boolean
      setPref: "network.dns.echconfig.enabled"
    h3Enabled:
      description: Whether to enable ECH for connections using H3/QUIC
      type: boolean
      setPref: "network.dns.http3_echconfig.enabled"
    forceWaitHttpsRR:
      description: Whether to force waiting for HTTPS DNS records, which ECH requires.
      type: boolean
      setPref: "network.dns.force_waiting_https_rr"
    insecureFallback:
      description: Whether to fallback to non-ECH connections if all ECH RRs fail.
      type: boolean
      setPref: "network.dns.echconfig.fallback_to_origin_when_all_failed"
    tlsGreaseProb:
      description: Probability of GREASEing a TLS connection with ECH (0-100).
      type: int
      setPref: "security.tls.ech.grease_probability"
    h3GreaseEnabled:
      description: Whether to apply GREASE settings to H3/QUIC connections.
      type: boolean
      setPref: "security.tls.ech.grease_http3"
    disableGreaseOnFallback:
      description: Whether to disable GREASE when retrying a connection.
      type: boolean
      setPref: "security.tls.ech.disable_grease_on_fallback"
    greasePaddingSize:
      description: Assumed echConfig padding length for GREASE extensions (1-255).
      type: int
      setPref: "security.tls.ech.grease_size"

dohPrefs:
  description: Prefs that control DNS over HTTPS.
  owner: vgosu@mozilla.com
  hasExposure: false
  variables:
    trrMode:
      description: Has a value of 2 for TRR first, 3 for TRR only, 0 for off.
      type: int
      setPref: "network.trr.mode"
    trrUri:
      description: The URL of the DNS over HTTPS endpoint
      type: string
      setPref: "network.trr.uri"
    dohMode:
      description: Same as trrMode, but set by the DoHController module.
      type: int
      setPref: "doh-rollout.mode"
    dohUri:
      description: Same as trrUri, but set by the DoHController module.
      type: string
      setPref: "doh-rollout.uri"
    enableFallbackWarningPage:
      description: Whether DoH fallback warning page will be displayed when DoH doesn't work in TRR first mode.
      type: boolean
      setPref: "network.trr.display_fallback_warning"
    showFallbackCheckbox:
      description: Whether the checkbox to enable the fallback warning page is displayed in the settings UI.
      type: boolean
      setPref: "network.trr_ui.show_fallback_warning_option"

dooh:
  description: "DNS over Oblivious HTTP"
  owner: vgosu@mozilla.com
  hasExposure: false
  variables:
    ohttpEnabled:
      description: Whether to use Oblivious HTTP for the resolution
      type: boolean
      setPref: "network.trr.use_ohttp"
    ohttpRelayUri:
      description: The URL of the Oblivious HTTP relay
      type: string
      setPref: "network.trr.ohttp.relay_uri"
    ohttpConfigUri:
      description: The URL used to fetch the configuration of the Oblivious HTTP gateway
      type: string
      setPref: "network.trr.ohttp.config_uri"
    ohttpUri:
      description: The URL of the Oblivious DNS over HTTPS target resource
      type: string
      setPref: "network.trr.ohttp.uri"

networking:
  description: "Firefox Networking (Necko)"
  owner: vgosu@mozilla.com
  hasExposure: false
  variables:
    ehPreloadEnabled:
      description: Whether Early Hints preload is enabled
      type: boolean
      setPref: "network.early-hints.enabled"
    ehPreconnectEnabled:
      description: Whether Early Hints preconnect is enabled
      type: boolean
      setPref: "network.early-hints.preconnect.enabled"
    dnsMaxPriorityThreads:
      description: The maximum number of high priority DNS threads that can be created.
      type: int
      setPref: "network.dns.max_high_priority_threads"
    dnsMaxAnyPriorityThreads:
      description: The maximum number of DNS threads that can be created to handle any priority DNS requests.
      type: int
      setPref: "network.dns.max_any_priority_threads"
    preconnect:
      description: Whether the rel=preconnect feature is enabled
      type: boolean
      setPref: "network.preconnect"
    networkPredictor:
      description: Whether the Necko predictor is enabled
      type: boolean
      setPref: "network.predictor.enabled"
    http3CCalgorithm:
      description: The congestion control algorithm with which to configure neqo. 0 for NewReno, 1 for Cubic
      type: int
      setPref: "network.http.http3.cc_algorithm"
    sendOnDataFinished:
      description: Whether we can send OnDataFinished in the content process
      type: boolean
      setPref: "network.send_OnDataFinished"
    sendOnDataFinshedFromInputStreamPump:
      description: Whether we can send OnDataFinished to the content process from InputStreamPump
      type: boolean
      setPref: "network.send_OnDataFinished.nsInputStreamPump"
    sendOnDataFinishedToHtml5parser:
      description: Whether we can send OnDataFinished to the html5parser in content process
      type: boolean
      setPref: "network.send_OnDataFinished.html5parser"
    sendOnDataFinishedToCssLoader:
      description: Whether we can send OnDataFinished to the cssLoader in content process
      type: boolean
      setPref: "network.send_OnDataFinished.cssLoader"


pingsender:
  description: "In-product usage of the pingsender telemetry reporter."
  owner: nalexander@mozilla.com
  hasExposure: false
  variables:
    backgroundTaskEnabled:
      type: "boolean"
      fallbackPref: "toolkit.telemetry.shutdownPingSender.backgroundtask.enabled"
      description: "Whether to use the `pingsender` background task to send shutdown telemetry"

dapTelemetry:
  description: DAP Telemetry
  owner: simon@mozilla.com
  hasExposure: false
  isEarlyStartup: true # Data is sent on startup with a trigger in BrowserGlue.sys.mjs
  variables:
    enabled:
      type: boolean
      fallbackPref: toolkit.telemetry.dap_enabled
      description: Whether to automatically send DAP measurements.
    task1Enabled:
      type: boolean
      fallbackPref: toolkit.telemetry.dap_task1_enabled
      description: Whether to send fake measurements for task 1.
    task1TaskId:
      type: string
      fallbackPref: toolkit.telemetry.dap_task1_taskid
      description: The task ID to use for task 1 measurements.
    visitCountingEnabled:
      type: boolean
      fallbackPref: toolkit.telemetry.dap_visit_counting_enabled
      description: Whether to count visits to the provided list of URLs.
    visitCountingExperimentList:
      fallbackPref: toolkit.telemetry.dap_visit_counting_experiment_list
      type: json
      description: A list of experiments with URLs for which we want to count visits.

etpLevel2PBMPref:
  description: The pref that controls the ETP level 2 list in the private browsing mode
  owner: tihuang@mozilla.com
  hasExposure: false
  variables:
    enabled:
      description: Whether to enable ETP level 2 list in the private browsing mode.
      type: boolean
      setPref: "privacy.annotate_channels.strict_list.pbmode.enabled"

fxaButtonVisibility:
  description: Prefs to control the visibility of the Firefox Accounts toolbar button when not signed in.
  owner: mconley@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    boolean:
      description: True if the Firefox Accounts toolbar button should be visible when not signed in.
      type: boolean
      setPref: identity.fxaccounts.toolbar.defaultVisible

legacyHeartbeat:
  description: Normandy Heartbeat exposed to Nimbus
  owner: barret@mozilla.com
  hasExposure: false
  schema:
    uri: "resource://normandy/schemas/LegacyHeartbeat.schema.json"
    path: "toolkit/components/normandy/schemas/LegacyHeartbeat.schema.json"
  variables:
    survey:
      type: json
      description: The Heartbeat survey parameters.

queryStripping:
  description: Query parameter stripping anti-tracking feature.
  owner: pbz@mozilla.com
  hasExposure: false
  variables:
    enabledNormalBrowsing:
      type: boolean
      setPref: privacy.query_stripping.enabled
      description: Enables / disables URL query string stripping in normal browsing mode.
    enabledPrivateBrowsing:
      type: boolean
      setPref: privacy.query_stripping.enabled.pbmode
      description: Enables / disables URL query string stripping in private browsing mode.
    allowList:
      type: string
      setPref: privacy.query_stripping.allow_list
      description: >-
        List of sites exempt from query stripping. This list will be merged with
        records coming from RemoteSettings.
    stripList:
      type: string
      setPref: privacy.query_stripping.strip_list
      description: >-
        List of query params to be stripped from URIs. This list will be merged
        with records coming from RemoteSettings.

fontvisibility:
  description: Control Font Visibility in PBM
  owner: tom@mozilla.com
  hasExposure: false
  variables:
    enabledETP:
      type: int
      setPref: layout.css.font-visibility.trackingprotection
      description: Set the Font Visibility level when Enhanced Tracking Protection is enabled
    enabledStandard:
      type: int
      setPref: layout.css.font-visibility.standard
      description: Set the Font Visibility level for normal browsing
    enabledPBM:
      type: int
      setPref: layout.css.font-visibility.private
      description: Set the Font Visibility level for private browsing (will override ETP)

fingerprintingProtection:
  description: Control Fingerprinting Protection
  owner: tihuang@mozilla.com
  hasExposure: false
  variables:
    enabledNormal:
      type: boolean
      setPref: privacy.fingerprintingProtection
      description: Enables / disables fingerprinting protection in normal browsing mode.
    enabledPrivate:
      type: boolean
      setPref: privacy.fingerprintingProtection.pbmode
      description: Enables / disables fingerprinting protection in private browsing mode.
    overrides:
      type: string
      setPref: privacy.fingerprintingProtection.overrides
      description: >-
        The protection overrides to add or remove fingerprinting protection
        targets. Please check RFPTargets.inc for all supported targets.

migrationWizard:
  description: Prefs to control the Migration Wizard UI.
  owner: mconley@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    showImportAll:
      description: True if the "Variant 2" of the Migration Wizard browser / profile selection UI should be used. This is only meaningful in the new Migration Wizard.
      type: boolean
      setPref: browser.migrate.content-modal.import-all.enabled
    showPreferencesEntrypoint:
      description: True if an entrypoint to the migration wizard should be visible in about:preferences.
      type: boolean
      setPref: browser.migrate.preferences-entrypoint.enabled
    aboutWelcomeBehavior:
      description: >-
        When migration is kicked off from about:welcome, there are
        a few different behaviors that we want to test, controlled
        by a preference that is instrumented for Nimbus. The pref
        has the following possible states:

        "autoclose":
          The user will be directed to the migration wizard in
          about:preferences, but once the wizard is dismissed,
          the tab will close.

        "embedded":
          The migration wizard is embedded in about:welcome.

        "standalone":
          The migration wizard will open in a new top-level content
          window.

        "default" / other
          The user will be directed to the migration wizard in
          about:preferences. The tab will not close once the
          user closes the wizard.
      type: string
      setPref: browser.migrate.content-modal.about-welcome-behavior
    migrateExtensions:
      description: True if importing extensions is enabled.
      type: boolean
      setPref: browser.migrate.chrome.extensions.enabled
    chromeCanRequestPermissions:
      description: >-
        True if Chrome-based browsers can request read permissions on
        platforms where the browser is restricted from reading the contents
        of a Chrome-based browser's user data directory. In practice, this
        is only relevant to the Linux platform when the browser is installed
        as a Snap package.
      type: boolean
      setPref: browser.migrate.chrome.get_permissions.enabled

mixedContentUpgrading:
  description: Prefs to control whether we upgrade mixed passive content (images, audio, video) from http to https
  owner: fbraun@mozilla.com
  hasExposure: false
  variables:
    enabled:
      description: True if the mixed content upgrading pref is enabled
      type: boolean
      setPref: security.mixed_content.upgrade_display_content
    image:
      description: True if the mixed content upgrading is enabled for images
      type: boolean
      setPref: security.mixed_content.upgrade_display_content.image
    audio:
      description: True if the mixed content upgrading is enabled for audio
      type: boolean
      setPref: security.mixed_content.upgrade_display_content.audio
    video:
      description: True if the mixed content upgrading is enabled for videos
      type: boolean
      setPref: security.mixed_content.upgrade_display_content.video

jsParallelParsing:
  description: Pref to toggle JS parallel parsing.
  owner: dpalmeiro@mozilla.com, nbp@mozilla.com
  isEarlyStartup: true
  hasExposure: false
  variables:
    enabled:
      description: True to enable parallel parsing.
      type: boolean
      setPref: "javascript.options.parallel_parsing"

gcParallelMarking:
  description: Pref to toggle parallel marking in the GC.
  owner: dpalmeiro@mozilla.com, jonco@mozilla.com
  isEarlyStartup: true
  hasExposure: false
  variables:
    enabled:
      description: True to enable parallel marking.
      type: boolean
      setPref: "javascript.options.mem.gc_parallel_marking"

jitThresholds:
  description: Prefs that control jit tier thresholds.
  owner: dpalmeiro@mozilla.com, jdemooij@mozilla.com
  isEarlyStartup: true
  hasExposure: false
  variables:
    blinterp_threshold:
      description: Set the threshold to enable blinterp compilation.
      type: int
      setPref: "javascript.options.blinterp.threshold"
    baseline_threshold:
      description: Set the threshold to enable baseline compilation.
      type: int
      setPref: "javascript.options.baselinejit.threshold"
    ion_threshold:
      description: Set the threshold to enable ion compilation.
      type: int
      setPref: "javascript.options.ion.threshold"
    ion_bailout_threshold:
      description: Set the ion frequent bailout threshold.
      type: int
      setPref: "javascript.options.ion.frequent_bailout_threshold"
    ion_offthread_compilation:
      description: True to enable offthread ion compilations.
      type: boolean
      setPref: "javascript.options.ion.offthread_compilation"
    inlining_max_length:
      description: Set the max bytecode length considered for inlining.
      type: int
      setPref: "javascript.options.inlining_bytecode_max_length"

jitHintsCache:
  description: Pref to toggle the JIT hints cache.
  owner: dpalmeiro@mozilla.com
  isEarlyStartup: true
  hasExposure: false
  variables:
    enabled:
      description: True to enable the hints cache.
      type: boolean
      setPref: "javascript.options.jithints"

raceCacheWithNetwork:
  description: Prefs to toggle the race cache with network.
  owner: dpalmeiro@mozilla.com, acreskey@mozilla.com
  hasExposure: false
  variables:
    enabled:
      description: True to enable the rcwn feature.
      type: boolean
      setPref: "network.http.rcwn.enabled"

httpSpeculativeParallelLimit:
  description: Prefs to control the http speculative parallel limit.
  owner: dpalmeiro@mozilla.com, acreskey@mozilla.com
  hasExposure: false
  variables:
    speculative_parallel_limit:
      description: Maximum number of parallel speculative connections.
      type: int
      setPref: "network.http.speculative-parallel-limit"

deviceMigration:
  description: Prefs to control aspects of the new device migration experiment
  owner: hjones@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    helpMenuHidden:
      description: True if new help menu item should be hidden
      type: boolean
      fallbackPref: browser.device-migration.help-menu.hidden

shopping2023:
  description: Prefs to control the 2023 shopping experiment.
  owner: jhirsch@mozilla.com
  hasExposure: true
  exposureDescription: >-
    The timing of the exposure event depends on the experiment, but generally
    the event is recorded when the user first encounters onboarding UI for
    the shopping feature.
  variables:
    enabled:
      description: True if the experience is enabled (experimental treatment group)
      type: boolean
      fallbackPref: browser.shopping.experience2023.enabled
    control:
      description: True if the experiment is enabled but experience is disabled (experimental control group)
      type: boolean
      fallbackPref: browser.shopping.experience2023.control
    adsEnabled:
      description: True if showing recommended products is enabled
      type: boolean
      setPref: browser.shopping.experience2023.ads.enabled
    adsExposure:
      description: True if we want to record ad inventory for opted-in users, even if ads are disabled
      type: boolean
      setPref: browser.shopping.experience2023.ads.exposure
    surveyEnabled:
      description: True if showing survey is enabled
      type: boolean
      fallbackPref: browser.shopping.experience2023.survey.enabled
shoppingOHTTP:
  description: Prefs to control the OHTTP URLs used for shopping.
  owner: gijs@mozilla.com
  hasExposure: false
  variables:
    ohttpRelayURL:
      description: What OHTTP relay URL to use
      type: string
      setPref: toolkit.shopping.ohttpRelayURL
    ohttpConfigURL:
      description: URL for the OHTTP config to use
      type: string
      setPref: toolkit.shopping.ohttpConfigURL

opaqueResponseBlocking:
  description: Prefs to enable Opaque Response Blocking
  owner: farre@mozilla.com
  isEarlyStartup: true
  hasExposure: true
  exposureDescription: Exposure is sent when a response is blocked
  variables:
    enabled:
      description: Whether ORB is enabled
      type: boolean
      setPref: "browser.opaqueResponseBlocking"
    javascriptValidator:
      description: Whether JavaScript validation for ORB is enabled
      type: boolean
      setPref: "browser.opaqueResponseBlocking.javascriptValidator"
    filterFetchResponse:
      description: Whether filtering of internal responses in the parent ORB is enabled
      type: int
      setPref: "browser.opaqueResponseBlocking.filterFetchResponse"
    mediaExceptionsStrategy:
      description: >-
        If we partially or wholly allow audio and video MIME types in conflict with spec.
      type: int
      setPref: "browser.opaqueResponseBlocking.mediaExceptionsStrategy"

updatePrompt:
  description: Prefs to control content and behavior of update notifications
  owner: omc@mozilla.com
  hasExposure: true
  exposureDescription: >-
    Exposure is sent at most once per browsing session when an update
    notification prompt is displayed.
  isEarlyStartup: true
  variables:
    showReleaseNotesLink:
      type: boolean
      description: >-
        If true, the "Learn More" link will be shown in the update prompt. If
        false or omitted, the link will only be shown for supported locales.
    releaseNotesURL:
      type: string
      fallbackPref: app.releaseNotesURL.prompt
      description: >-
        Template for the URL opened when the user clicks the "Learn More" link
        in the update prompt. If an empty string, the link will not be shown.

powerSaver:
  description: Prefs to control power saving behaviors
  owner: florian@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    reduceFrameRates:
      type: int
      setPref: "gfx.display.max-frame-rate"
      description: >-
        Limit the number of frames displayed per second.
        If omitted, the refresh rate of the screen will be used.
    mediaAutoPlay:
      type: int
      setPref: "media.autoplay.default"
      description: >-
        Control if media is allowed to auto-play, with and without sound.
    backgroundTimerMinTime:
      type: int
      setPref: "dom.min_background_timeout_value"
      description: >-
        Limit how frequently timers are allowed to run in background tabs.
    backgroundTimerRegenerationRate:
      type: int
      setPref: "dom.timeout.background_budget_regeneration_rate"
      description: >-
        Limit how quickly the background tab timer budget regenerates.

firefoxViewNext:
  description: Next Iteration of Firefox View
  owner: firefoxview@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    enabled:
      type: boolean
      fallbackPref: "browser.tabs.firefox-view-next"
      description: "Whether or not to enable the new Firefox View"
    newIcon:
      type: boolean
      fallbackPref: "browser.tabs.firefox-view-newIcon"
      description: "Whether or not use the new icon"

backgroundUpdate:
  description: Prefs to control aspects of the background update process.
  owner: install-update@mozilla.com
  hasExposure: true
  exposureDescription: >-
    The exposure event is sent when scheduling the background task and both the
    feature is enabled and the service registry key (Mozilla Maintenance
    Service) is *not* available for this installation. That is the first time
    the feature can impact Firefox behaviour and the user experience.
  isEarlyStartup: true
  variables:
    enableUpdatesForUnelevatedInstallations:
      description: >-
        Allow the background update process to download and apply updates when
        the Mozilla Maintenance Service is unavailable but the installation
        directory can be written.
      type: boolean
      setPref: app.update.background.allowUpdatesForUnelevatedInstallations

bookmarks:
  description: Prefs to control aspects of the bookmarks system.
  owner: omc@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    enableBookmarksToolbar:
      type: string
      setPref: browser.toolbars.bookmarks.visibility
      description: If the bookmarks toolbar should never, always, or only show on newtab.

cookieBannerHandling:
  description: Automatically handle cookie banners on the user's behalf.
  owner: pbz@mozilla.com
  hasExposure: false
  variables:
    modeNormalBrowsing:
      type: int
      setPref: cookiebanners.service.mode
      description: >-
        Controls the cookie banner handling mode in normal browsing.
        Values: 0 - disabled, 1 - reject all, 2 - reject all with accept all fallback.
    modePrivateBrowsing:
      type: int
      setPref: cookiebanners.service.mode.privateBrowsing
      description: >-
        Controls the cookie banner handling mode in private browsing.
        Values: 0 - disabled, 1 - reject all, 2 - reject all with accept all fallback.
    enableGlobalRules:
      type: boolean
      setPref: cookiebanners.service.enableGlobalRules
      description: >-
        Enables use of global CookieBannerRules, which apply to all sites.
        This enables handling of CMPs across sites without the use of site-specific rules.
    enableGlobalRulesSubFrames:
      type: boolean
      setPref: cookiebanners.service.enableGlobalRules.subFrames
      description: >-
        Whether global rules are allowed to run in sub-frames. Running query
        selectors in every sub-frame may negatively impact performance, but is
        required for some CMPs.
    enableDetectOnly:
      type: boolean
      setPref: cookiebanners.service.detectOnly
      description: >-
        When set to true, cookie banners are detected and detection events are
        dispatched, but they will not be handled.
        This pref applies to both normal and private browsing windows.
    enableFirefoxDesktopUI:
      type: boolean
      setPref: cookiebanners.ui.desktop.enabled
      description: Enables the cookie banner desktop UI.
    enablePromo:
      type: boolean
      setPref: browser.promo.cookiebanners.enabled
      description: Enables the cookie banner promo in about:privatebrowsing.

backgroundThreads:
  description: Prefs to control MacOS thread priorities for power savings.
  owner: kwright@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    use_low_power:
      description: >-
        Use the MacOS QoS libraries to deprioritize select threads.
      type: boolean
      setPref: threads.use_low_power.enabled
    lower_mainthread_priority_in_background:
      description: >-
        When a browsing context is put in the background and isn't actively playing
        media, deprioritize its main thread.
      type: boolean
      setPref: threads.lower_mainthread_priority_in_background.enabled

reportBrokenSite:
  description: the Report Broken Site feature
  hasExposure: false
  isEarlyStartup: true
  variables:
    enabled:
      type: boolean
      setPref: ui.new-webcompat-reporter.enabled
      description: >-
        Whether Report Broken Site is enabled
    sendMoreInfo:
      type: boolean
      setPref: ui.new-webcompat-reporter.send-more-info-link
      description: >-
        Whether Report Broken Site shows the send more info link directing
        users to webcompat.com (defaults to true for prerelease channels)
    reasonDropdown:
      type: int
      setPref: ui.new-webcompat-reporter.reason-dropdown
      description: >-
        0 = do not show the "reason" dropdown
        1 = show an optional "reason" dropdown
        2 = show a required "reason" dropdown

feltPrivacy:
  description: Prefs for Felt Privacy v1 experiments
  owner: cmeador@mozilla.com
  hasExposure: true
  exposureDescription: Exposure when user opens a private browsing window.
  variables:
    feltPrivacy:
      type: boolean
      setPref: browser.privatebrowsing.felt-privacy-v1
      description: >-
        When true, new styles and copy enabled on about:privatebrowsing. When true,
        a toggle for showing or hiding quick suggestions appears in about:preferences.
    resetPBMAction:
      type: boolean
      setPref: browser.privatebrowsing.resetPBM.enabled
      description: >-
        Enables the reset PBM feature button and confirmation panel.

attribution:
  description: Prefs related to install attribution
  hasExposure: false
  isEarlyStartup: true
  variables:
    macosEnabled:
      type: boolean
      description: Whether or not macOS attribution data will be processed and sent in Telemetry
      fallbackPref: browser.attribution.macos.enabled

phc:
  description: Prefs to control the Probabalistic Heap Checker (PHC)
  owner: pbone@mozilla.com
  hasExposure: false
  isEarlyStartup: true
  variables:
    phcEnabled:
      description: Whether to enable PHC
      type: boolean
      setPref: memory.phc.enabled

mailto:
  description: Prefs to control aspects of the mailto handler
  owner: install-update@mozilla.com
  hasExposure: true
  exposureDescription: >-
    The exposure event is sent when a webmail site calls the
    registerProtocolHandler function and when users use mailto links in Firefox.
  isEarlyStartup: false
  variables:
    dualPrompt:
      type: boolean
      description: >-
        Can be used to toggle the entire feature on and off.
      fallbackPref: browser.mailto.dualPrompt
    dualPrompt.os:
      type: boolean
      description: >-
        Make webmail sites display prompts to set Firefox as default OS mailto
        application and another prompt to set the current site as default
        webmail site in Firefox.
      fallbackPref: browser.mailto.dualPrompt.os

