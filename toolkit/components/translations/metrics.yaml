# This Source Code Form is subject to the terms of the Mozilla Public↩
# License, v. 2.0. If a copy of the MPL was not distributed with this↩
# file, You can obtain one at http://mozilla.org/MPL/2.0/.↩

# Adding a new metric? We have docs for that!↩
# https://firefox-source-docs.mozilla.org/toolkit/components/glean/user/new_definitions_file.html↩

---
$schema: moz://mozilla.org/schemas/glean/metrics/2-0-0
$tags:
  - 'Firefox :: Translation'

translations:
  requests_count:
    type: counter
    description: >
      The count of translation requests.
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1836436
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1836436
    data_sensitivity:
      - technical
    notification_emails:
      - translations-telemetry-alerts@mozilla.com
    expires: 122

  error_rate:
    type: rate
    description: >
      The rate of failed translations requests.
    denominator_metric: translations.requests_count
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1836436
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1836436
    data_sensitivity:
      - technical
    notification_emails:
      - translations-telemetry-alerts@mozilla.com
    expires: 122

  error:
    type: event
    description: >
      The specific translations error that caused a full-page translation failure.
    extra_keys:
      flow_id: &flow_id
        type: string
        description: A uuid to relate events associated with the current panel session.
      first_interaction: &first_interaction
        type: boolean
        description: >
          True if this event occurred in the user's first interaction with translations,
          otherwise false.
      reason:
        type: string
        description: The reason for the error.
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1836436
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1841366
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1836436#c4
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1841366#c11
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_sensitivity:
      - technical
    notification_emails:
      - translations-telemetry-alerts@mozilla.com
    expires: 122

  translation_request:
    type: event
    description: >
      Triggers when a full-page translation request is sent.
    extra_keys:
      flow_id: *flow_id
      first_interaction: *first_interaction
      from_language:
        type: string
        description: The language being translated from.
      to_language:
        type: string
        description: The language being translated into.
      auto_translate:
        type: boolean
        description: >
          True if this translation was triggered automatically
          due to configured always-translate-language settings.
          False if this translation was triggered manually.
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1836381
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1841366
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1836381#c4
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1841366#c11
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_sensitivity:
      - interaction
    notification_emails:
      - translations-telemetry-alerts@mozilla.com
    expires: 122

  restore_page:
    type: event
    description: >
      Triggers when the a restore-page event is triggered.
    extra_keys:
      flow_id: *flow_id
      first_interaction: *first_interaction
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_sensitivity:
      - interaction
    notification_emails:
      - translations-telemetry-alerts@mozilla.com
    expires: 122

translations.panel:
  open:
    type: event
    description: >
      Triggers when the translations panel is opened.
    extra_keys:
      flow_id: *flow_id
      first_interaction: *first_interaction
      opened_from:
        type: string
        description: The method by which the translations panel was opened.
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1835502
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1841366
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1835502#c7
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1841366#c11
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_sensitivity:
      - interaction
    notification_emails:
      - translations-telemetry-alerts@mozilla.com
    expires: 122

  cancel_button:
    type: event
    description: >
      Triggers when the cancel button is invoked in the translations panel.
    extra_keys:
      flow_id: *flow_id
      first_interaction: *first_interaction
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_sensitivity:
      - interaction
    notification_emails:
      - translations-telemetry-alerts@mozilla.com
    expires: 122

  change_source_language_button:
    type: event
    description: >
      Triggers when the change-source-language button is invoked in the translations panel.
    extra_keys:
      flow_id: *flow_id
      first_interaction: *first_interaction
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_sensitivity:
      - interaction
    notification_emails:
      - translations-telemetry-alerts@mozilla.com
    expires: 122

  dismiss_error_button:
    type: event
    description: >
      Triggers when the dismiss-error button is invoked in the translations panel.
    extra_keys:
      flow_id: *flow_id
      first_interaction: *first_interaction
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_sensitivity:
      - interaction
    notification_emails:
      - translations-telemetry-alerts@mozilla.com
    expires: 122

  restore_page_button:
    type: event
    description: >
      Triggers when the restore-page button is invoked in the translations panel.
    extra_keys:
      flow_id: *flow_id
      first_interaction: *first_interaction
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_sensitivity:
      - interaction
    notification_emails:
      - translations-telemetry-alerts@mozilla.com
    expires: 122

  translate_button:
    type: event
    description: >
      Triggers when the translate button is invoked in the translations panel.
    extra_keys:
      flow_id: *flow_id
      first_interaction: *first_interaction
    bugs:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_reviews:
      - https://bugzilla.mozilla.org/show_bug.cgi?id=1845428
    data_sensitivity:
      - interaction
    notification_emails:
      - translations-telemetry-alerts@mozilla.com
    expires: 122
