From: Dan Baker <dbaker@mozilla.com>
Date: Thu, 14 Mar 2024 10:51:00 -0600
Subject: Bug 1883116 - (fix-e79e722834) add enviroment_factory to libwebrtc
 build and change to use GetRealTimeClockRaw.

Mercurial Revision: https://hg.mozilla.org/mozilla-central/rev/2185cab977988fd4ab03b38dc67f9b06162444da
---
 BUILD.gn                               | 1 +
 api/environment/environment_factory.cc | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/BUILD.gn b/BUILD.gn
index 7feca08e60..85ead4162f 100644
--- a/BUILD.gn
+++ b/BUILD.gn
@@ -580,6 +580,7 @@ if (!build_with_chromium) {
 
     if (build_with_mozilla) {
       deps += [
+        "api/environment:environment_factory",
         "api/video:video_frame",
         "api/video:video_rtp_headers",
         "test:rtp_test_utils",
diff --git a/api/environment/environment_factory.cc b/api/environment/environment_factory.cc
index c0b681aa08..c55cecd1ab 100644
--- a/api/environment/environment_factory.cc
+++ b/api/environment/environment_factory.cc
@@ -98,7 +98,7 @@ Environment EnvironmentFactory::CreateWithDefaults() && {
     Set(std::make_unique<FieldTrialBasedConfig>());
   }
   if (clock_ == nullptr) {
-    Set(Clock::GetRealTimeClock());
+    Set(Clock::GetRealTimeClockRaw());
   }
   if (task_queue_factory_ == nullptr) {
     Set(CreateDefaultTaskQueueFactory(field_trials_));
