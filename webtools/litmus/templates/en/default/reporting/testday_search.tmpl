[%# ***** BEGIN LICENSE BLOCK *****
  # Version: MPL 1.1
  #
  # The contents of this file are subject to the Mozilla Public License Version
  # 1.1 (the "License"); you may not use this file except in compliance with
  # the License. You may obtain a copy of the License at
  # http://www.mozilla.org/MPL/
  #
  # Software distributed under the License is distributed on an "AS IS" basis,
  # WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
  # for the specific language governing rights and limitations under the
  # License.
  #
  # The Original Code is Litmus.
  #
  # The Initial Developer of the Original Code is
  # The Mozilla Corporation.
  # Portions created by the Initial Developer are Copyright (C) 2006
  # the Initial Developer. All Rights Reserved.
  #
  # Contributor(s):
  #   Chris Cooper <ccooper@deadsquid.com>
  #   Zach Lipton <zach@zachlipton.com>
  #
  # ***** END LICENSE BLOCK *****
#%]
  
[%# INTERFACE:
  # no interface for this template
#%]

<script type="text/javascript">
var products=[% products_js %];
var branches=[% branches_js %];
var testgroups=[% testgroups_js %];

function init()
{
    populateProductSelect("product_id");
    productBox = document.getElementById('product_id');
    branchBox = document.getElementById('branch_id');
    FormInit(document.forms['testday_report'], document.location.search);
    FormInit(document.forms['testevent_report'], document.location.search);
    changeProduct(productBox);
    FormInit(document.forms['testevent_report'], document.location.search);
    changeBranch(branchBox);
    FormInit(document.forms['testevent_report'], document.location.search);
}

function populateProductSelect(selectID)
{
    if (products) {
        var selectBox = document.getElementById(selectID)
        selectBox.options.length = 0;
        selectBox.options[0] = new Option('-Product-','');
        for (var i=0; i<products.length; i++) {
            selectBox.options[i+1] = new Option(products[i].name,products[i].product_id);
        }
    }
}

function changeProduct(productSelectBox)
{
    if (productSelectBox.selectedIndex &&
        productSelectBox.options[productSelectBox.selectedIndex].value != '') {

        var branchSelectBox = document.getElementById('branch_id');
        if (branchSelectBox) {
            branchSelectBox.options.length = 0;
            branchSelectBox.options[0] = new Option('-Branch-','');
            var i = 1;
            for (var j=0; j<branches.length; j++) {
                if (branches[j].product_id == productSelectBox.options[productSelectBox.selectedIndex].value) {
                    branchSelectBox.options[i] = new Option(branches[j].name,branches[j].branch_id);
                    i++;
                }
            }
        }  

        var testgroupSelectBox = document.getElementById('testgroup_id');
        if (testgroupSelectBox) {
            testgroupSelectBox.options.length = 0;
            testgroupSelectBox.options[0] = new Option('-Testgroup-','');
            var i = 1;
            for (var j=0; j<testgroups.length; j++) {
                if (testgroups[j].product_id == productSelectBox.options[productSelectBox.selectedIndex].value) {
                    testgroupSelectBox.options[i] = new Option(testgroups[j].name,testgroups[j].testgroup_id);
                    i++;
                }
            }
        }  

    }
}

function changeBranch(branchSelectBox)
{
    if (branchSelectBox.selectedIndex &&
        branchSelectBox.options[branchSelectBox.selectedIndex].value != '') {
        var testgroupSelectBox = document.getElementById('testgroup_id');
        if (testgroupSelectBox) {
            testgroupSelectBox.options.length = 0;
            testgroupSelectBox.options[0] = new Option('-Testgroup-','');
            var i = 1;
            for (var j=0; j<testgroups.length; j++) {
                if (testgroups[j].branch_id == branchSelectBox.options[branchSelectBox.selectedIndex].value) {
                    testgroupSelectBox.options[i] = new Option(testgroups[j].name,testgroups[j].testgroup_id);
                    i++;
                }
            }
        }  
        
    }
}
</script>

<div class="section-full">

  <form action="testday_report.cgi" method="get" name="testday_report" id="testday_report">

    <table class="testcase-search">
      <tr>
        <th>Scheduled Testdays</th>
      </tr>
      <tr>
        <td valign="top" width="100%">
          <div class="testcase-search">
            <table>
              <tr>
                <td>[% INCLUDE form_widgets/select_testday_id.tmpl name="testday_id" %]</td>
              </tr>
              <tr>
                <td><input class="button" type="submit" value="Generate Report"></td>
              </tr>
            </table>
          </div>    
        </td>
      </tr>
    </table>                  

  </form>

  <form action="testday_report.cgi" method="get" name="testevent_report" id="testevent_report">

    <table class="testcase-search">
      <tr>
        <th colspan="3">User-defined Events</th>
      </tr>
      <tr>
        <td>
          <div class="testcase-search">
            <table>
              <tr>
                <td colspan="3">This search form can be used to generate the same set of testday reports for any time period or set of criteria.</td>
              </tr>
              <tr>
                <td colspan="3"><hr/></td>
              </tr>
              <tr>
                <td>Start Time:</td>
                <td><input name="start_timestamp" id="start_timestamp" type="text" size="16"></td>
	        <td>&lArr; YYYYMMDDHHmmSS (required)</td>
              </tr>
              <tr>
                <td>Finish Time:</td>
                <td><input name="finish_timestamp" id="finish_timestamp" type="text" size="16"></td>
	        <td>&lArr; YYYYMMDDHHmmSS (required)</td>
              </tr>
              <tr>
                <td>Product:</td>
                <td>[% INCLUDE form_widgets/select_product_id.tmpl name="product_id" placeholder=1 onchange="changeProduct(this);" %]</td>
              </tr>
              <tr>
                <td>Branch:</td>
                <td>[% INCLUDE form_widgets/select_branch_id.tmpl name="branch_id" placeholder=1 onchange="changeBranch(this);" %]</td>
 		<td>&lArr; Select Product first</td>
              </tr>
              <tr>
                <td>Testgroup:</td>
                <td>[% INCLUDE form_widgets/select_testgroup_id.tmpl name="testgroup_id" placeholder=1 %]</td>
 		<td>&lArr; Select Branch first</td>
              </tr>
              <tr>
                <td>Build ID:</td>
                <td><input name="build_id" id="build_id" type="text" size="10"></td>
              </tr>
              <tr>
                <td>Locale:</td>
                <td>[% INCLUDE form_widgets/select_locale.tmpl name="locale" placeholder=1 %]
              </tr>
              <tr>
                <td><input class="button" type="submit" value="Generate Report"></td>
              </tr>
            </table>
          </div>

        </td>
      </tr>
    </table> 

  </form>

</div>

