<!DOCTYPE HTML>
<html class="reftest-wait">
<title>Test for bug 1224251</title>
<style>

body { background: white; color: black }

table {
  padding: 0;
  border-spacing: 0;
  border: none;
  width: 15em;
}

tr {
  background: rgba(0, 0, 255, 0.8);
}

td {
  border: none;
}

</style>


<table>
  <tr style="opacity: 0.8"><td>cell</td></tr>
</table>

<script>

var tr = document.getElementsByTagName("tr")[0];

// Not sure why, but to make this test fail without the patch, this has to
// be a setTimeout(0) rather than waiting for MozReftestInvalidate.
setTimeout(step1, 0);

function step1() {
  tr.style.opacity = "0.8";
  setTimeout(step2, 0);
}

function step2() {
  tr.style.opacity = "0.8";
  setTimeout(step3, 0);
}

function step3() {
  tr.style.opacity = "";

  document.documentElement.classList.remove("reftest-wait");
}

</script>
