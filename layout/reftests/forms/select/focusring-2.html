<!DOCTYPE HTML>
<html class="reftest-wait"><head>
    <meta charset="utf-8">
    <title>Testcase #2 for bug 1253977</title>
    <style type="text/css">

* { -moz-appearance:none; }
:focus {
  border:2px solid black;
}
:-moz-focusring {
  outline: 2px dashed black;
}

    </style>
</head>
<body>

<select onfocus="continueTest1()" onblur="continueTest2()"><option>1<option>2</select>

<script>

function continueTest2(){
  var s = document.querySelector("select");
  setTimeout(function(){ s.style.display = 'inline'; document.body.offsetHeight; }, 4);
  setTimeout(function(){ document.body.offsetHeight; document.documentElement.removeAttribute("class"); }, 100);
}

function continueTest1(){
  var s = document.querySelector("select");
  setTimeout(function(){ s.style.display = 'none';   }, 2);
  setTimeout(function(){ s.blur();  document.body.offsetHeight; }, 3);
}

function runTests(){
  var s = document.querySelector("select");
  s.focus();
}

window.focus();
window.addEventListener("MozReftestInvalidate", runTests);

</script>

</body>
</html>
