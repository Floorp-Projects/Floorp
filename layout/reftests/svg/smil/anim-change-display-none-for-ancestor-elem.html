<!DOCTYPE html>
<html class="reftest-wait">
  <head>
    <title>Test animation in a subtree that dynamically becames 'display:none'</title>
  </head>
  <body style="background-color: lime;">
    <div id="target">
      <svg>
        <rect width="100%" height="100%" fill="blue">
          <animate attributeName="fill" from="brown" to="red" dur="100s"/>
        </rect>
      </svg>
    </div>
    <script>
      document.addEventListener('MozReftestInvalidate', function() {
        var target = document.getElementById("target");
        target.style.display = "none";

        requestAnimationFrame(function(time) {
          document.documentElement.removeAttribute("class");
        });
      });
    </script>
  </body>
</html>
