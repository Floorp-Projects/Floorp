<!DOCTYPE html>
<html class="reftest-wait">
  <head>
    <title>Test animation on an element that dynamically becomes 'display:none'</title>
  </head>
  <body style="background-color: lime;">
    <div>
      <svg>
        <rect width="100%" height="100%" fill="blue" id="rect">
          <animate attributeName="fill" from="brown" to="red" dur="100s"/>
        </rect>
      </svg>
    </div>
    <script>
      document.addEventListener('MozReftestInvalidate', function() {
        var rect = document.getElementById("rect");
        rect.style.display = "none";

        requestAnimationFrame(function(time) {
          document.documentElement.removeAttribute("class");
        });
      });
    </script>
  </body>
</html>
