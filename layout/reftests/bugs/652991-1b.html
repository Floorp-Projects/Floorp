<!DOCTYPE html>
<html class="reftest-wait">
  <svg width="200" height="200">
    <defs>
      <pattern id="pattern-id" x="0" y="0" patternUnits="userSpaceOnUse" height="200" width="200">
        <rect width="200" height="200" style="fill:rgb(0,0,255)" />
      </pattern>
    </defs>
    <circle id="drawPath" cx="101" cy="101" r="50" style="fill: url(&quot;#pattern-id&quot;);" stroke="#000">
    </circle>
  </svg>
  <script>
  function doTest() {
    window.history.pushState(null, "", "new-page");

    drawPath.style.display = "none";
    window.setTimeout(() => {
      drawPath.style.display = "inline";
      document.documentElement.removeAttribute('class');
    }, 0);
  }

  drawPath = document.getElementById("drawPath");
  window.addEventListener("MozReftestInvalidate", doTest);
</script>
</html>
