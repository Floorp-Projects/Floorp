<!--
     Any copyright is dedicated to the Public Domain.
     http://creativecommons.org/publicdomain/zero/1.0/
-->
<!DOCTYPE html>
<html lang="en" class="reftest-wait">
<meta charset="utf-8">
<title>When the filtered element's BBox relative to the page changes, the filtered element needs to be invalidated</title>

<style>

#spacer {
  height: 100px;
}

#filtered {
  width: 100px;
  height: 100px;
  background-color: lime;
  filter: url(#filter);
}

</style>

<svg height="0">
  <defs>
    <filter id="filter" filterUnits="userSpaceOnUse"
            x="0" y="0" width="100" height="100"
            color-interpolation-filters="sRGB">
      <feMerge><feMergeNode/></feMerge>
    </filter>
  </defs>
</svg>

<div id="spacer"></div>

<div id="filtered"></div>

<script>

window.addEventListener("MozReftestInvalidate", function () {
  document.getElementById("spacer").style.height = "50px";
  document.documentElement.removeAttribute("class");
});

</script>
