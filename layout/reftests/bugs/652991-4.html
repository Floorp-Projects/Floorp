<!DOCTYPE html>
<html class="reftest-wait">
  <svg width="200" height="200">
    <defs>
      <mask id="mask1" x="0" y="0" width="100" height="100" >
        <circle cx="100" cy="100" r="50" style="stroke:none; fill: #ffffff"/>
      </mask>
    </defs>
    <rect id="drawPath" x="50" y="50" width="100" height="100" fill="blue" stroke="blue" mask="url(#mask1)"/>
  </svg>
  <script>
  function doTest() {
    window.history.pushState(null, "", "new-page");

    drawPath.style.display = "none";
    window.setTimeout(() => {
      drawPath.style.display = "inline";
      document.documentElement.removeAttribute('class');
    }, 0);
  }

  drawPath = document.getElementById("drawPath");
  window.addEventListener("MozReftestInvalidate", doTest);
  </script>
</html>
