# This Source Code Form is subject to the terms of the Mozilla Public
# # License, v. 2.0. If a copy of the MPL was not distributed with this file,
# # You can obtain one at http://mozilla.org/MPL/2.0/.

DEPTH            = ../..
topsrcdir        = @top_srcdir@
srcdir           = @srcdir@
VPATH            = @srcdir@

include $(DEPTH)/config/autoconf.mk

MODULE           = dom
LIBRARY_NAME     = domworkers_s
LIBXUL_LIBRARY   = 1
FORCE_STATIC_LIB = 1

CPPSRCS = \
  ChromeWorkerScope.cpp \
  DOMBindingBase.cpp \
  Events.cpp \
  EventListenerManager.cpp \
  EventTarget.cpp \
  Exceptions.cpp \
  File.cpp \
  FileReaderSync.cpp \
  FileReaderSyncPrivate.cpp \
  ImageData.cpp \
  Location.cpp \
  Navigator.cpp \
  Principal.cpp \
  RuntimeService.cpp \
  ScriptLoader.cpp \
  Worker.cpp \
  WorkerPrivate.cpp \
  WorkerScope.cpp \
  XMLHttpRequestEventTarget.cpp \
  XMLHttpRequestUpload.cpp \
  XMLHttpRequest.cpp \
  $(NULL)

EXPORTS_NAMESPACES = \
  mozilla/dom/workers \
  mozilla/dom/workers/bindings \
  $(NULL)

# Public stuff.
EXPORTS_mozilla/dom/workers = Workers.h

# Stuff needed for the bindings, not really public though.
EXPORTS_mozilla/dom/workers/bindings = \
  DOMBindingBase.h \
  EventListenerManager.h \
  EventTarget.h \
  WorkerFeature.h \
  XMLHttpRequestEventTarget.h \
  XMLHttpRequestUpload.h \
  XMLHttpRequest.h \
  $(NULL)

LOCAL_INCLUDES = \
  -I$(topsrcdir)/content/base/src \
  -I$(topsrcdir)/content/events/src \
  -I$(topsrcdir)/dom/base \
  -I$(topsrcdir)/dom/system \
  -I$(topsrcdir)/xpcom/build \
  -I$(topsrcdir)/js/xpconnect/src \
  $(NULL)

TEST_DIRS += test

include $(topsrcdir)/config/rules.mk
