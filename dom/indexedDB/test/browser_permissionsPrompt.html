<!--
  Any copyright is dedicated to the Public Domain.
  http://creativecommons.org/publicdomain/zero/1.0/
-->
<html>
  <head>
    <meta charset=UTF-8>
    <title>Indexed Database Test</title>

    <script type="text/javascript">
      function* testSteps()
      {
        const name = window.location.pathname;

        let request = indexedDB.open(name, { version: 1,
                                             storage: "persistent" });
        request.onerror = grabEventAndContinueHandler;
        request.onsuccess = grabEventAndContinueHandler;
        let event = yield undefined;

        if (event.type == "success") {
          testResult = event.target.result instanceof IDBDatabase;
        }
        else {
          testResult = event.target.error.name;
        }

        event.preventDefault();

        finishTest();
        yield undefined;
      }
    </script>

    <script type="text/javascript" src="browserHelpers.js"></script>

  </head>

  <body onload="runTest();" onunload="finishTestNow();"></body>

</html>
