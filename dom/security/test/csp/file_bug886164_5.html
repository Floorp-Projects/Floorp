<!DOCTYPE HTML>
<html>
<head> <meta charset="utf-8"> </head>
<script type="text/javascript">
  function ok(result, desc) {
    window.parent.postMessage({ok: result, desc}, "*");
  }

  function doStuff() {
    ok(true, "documents sandboxed with allow-scripts should be able to run inline scripts");
  }
</script>
<script src='file_iframe_sandbox_pass.js'></script>
<body onLoad='ok(true, "documents sandboxed with allow-scripts should be able to run script from event listeners");doStuff();'>
  I am sandboxed but with only inline "allow-scripts"

 <!-- sandbox="allow-scripts" -->
 <!-- Content-Security-Policy: default-src 'none' 'unsafe-inline'-->

 <!-- these should be stopped by CSP -->
 <img src="/tests/dom/security/test/csp/file_CSP.sjs?testid=img5_bad&type=img/png" />
 <img src="http://example.org/tests/dom/security/test/csp/file_CSP.sjs?testid=img5a_bad&type=img/png"> </img>
 <script src='/tests/dom/security/test/csp/file_CSP.sjs?testid=script5_bad&type=text/javascript'></script>
 <script src='http://example.org/tests/dom/security/test/csp/file_CSP.sjs?testid=script5a_bad&type=text/javascript'></script>
</body>
</html>
