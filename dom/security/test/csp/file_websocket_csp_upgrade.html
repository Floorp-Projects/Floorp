<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <title>Bug 1729897: Allow unsecure websocket from localhost page with CSP: upgrade-insecure </title>
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
</head>
<body>
  <script type="application/javascript">
    /* load socket using ws */
    var wsSocket = new WebSocket("ws://localhost/tests/dom/security/test/csp/file_websocket_self");
    wsSocket.onopen = function(e) {
      window.parent.postMessage({result: "self-ws-loaded", url: wsSocket.url}, "*");
    };
    wsSocket.onerror = function(e) {
      window.parent.postMessage({result: "self-ws-blocked"}, "*");
    };
  </script>
</body>
</html>
