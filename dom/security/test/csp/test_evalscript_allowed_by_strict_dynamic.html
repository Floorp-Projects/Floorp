<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Security-Policy" 
        content="script-src 'nonce-foobar' 'strict-dynamic' 'unsafe-eval'">
  <title>Bug 1439330  - CSP: eval is not blocked if 'strict-dynamic' is enabled
  </title>
  <script nonce="foobar" type="application/javascript" src="/tests/SimpleTest/SimpleTest.js">
  </script>
  <link rel="stylesheet" type="text/css" href="/tests/SimpleTest/test.css"/>
</head>
<body>
<script nonce="foobar">

/* Description of the test:
 * We apply the script-src 'nonce-foobar' 'strict-dynamic' 'unsafe-eval' CSP and
 * check if the eval function is allowed correctly by the CSP.
 */

SimpleTest.waitForExplicitFinish();

// start the test
try {
  // eslint-disable-next-line no-eval
  eval("1");
  ok(true, "eval allowed by CSP");
}
catch (ex) {
  ok(false, "eval should be allowed by CSP");
}

SimpleTest.finish();

</script>
</body>
</html>
